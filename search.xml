<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>vscodeçš„ä¸€ç³»åˆ—é…ç½®</title>
    <url>/2020/06/06/vscode%E7%9A%84%E4%B8%80%E7%B3%BB%E5%88%97%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<p>å‰æ®µæ—¶é—´å¿½ç„¶å¼€å§‹ç”¨vscodeï¼Œä»Šå¤©é…ç½®å¥½äº†Cå’ŒC++ï¼Œç°åœ¨å†³å®šæ•´ç†ä¸€ä¸‹é…ç½®è¿‡ç¨‹ã€‚</p>
<a id="more"></a>

<h2 id="å®‰è£…å’Œå¤–è§‚"><a href="#å®‰è£…å’Œå¤–è§‚" class="headerlink" title="å®‰è£…å’Œå¤–è§‚"></a>å®‰è£…å’Œå¤–è§‚</h2><ol>
<li><p><a href="https://code.visualstudio.com/" target="_blank" rel="noopener">VSCodeå®˜ç½‘</a>ä¸‹è½½å’Œå®‰è£…ï¼Œè¿™éƒ¨åˆ†åº”è¯¥ä¸ä¼šæœ‰é—®é¢˜ï¼Œæ³¨æ„æœ€åæ·»åŠ åˆ°pathçš„é€‰é¡¹è¦å‹¾é€‰ï¼Œä¸ç„¶å°±è¦è‡ªå·±å»é…ç½®ç¯å¢ƒå˜é‡ï¼›</p>
</li>
<li><p>ä¸­æ–‡è®¾ç½®ï¼šæ‰“å¼€æ‰©å±•ï¼ˆå·¦è¾¹é‚£ä¸€åˆ—æŒ‰é’®æœ€ä¸‹é¢çš„ï¼Œé»˜è®¤å¿«æ·é”®æ˜¯<code>ctrl+shift+x</code>ï¼Œæ‰¾ä¸€ä¸ªå«Chinese (Simplified) Language Pack for Visual Studio Codeçš„æ‰©å±•ï¼Œå®‰è£…å®Œæˆä»¥åé‡å¯vscodeï¼Œç•Œé¢å°±å˜æˆä¸­æ–‡äº†ã€‚å¦‚æœæ²¡å˜ï¼Œå°±æŒ‰<code>ctrl+shift+p</code>ï¼Œåœ¨å‡ºç°çš„æ¡†é‡Œè¾“å…¥configure display languageï¼Œç„¶åä¸‹æ‹‰èœå•é‡Œé€‰zh-cnå°±å¯ä»¥äº†ã€‚</p>
</li>
<li><p>ä¸»é¢˜å’Œå›¾æ ‡ï¼šåœ¨æ‰©å±•é‡Œæ‰¾å–œæ¬¢çš„å°±å¯ä»¥ï¼Œæ®æ¨èvscode-iconsæ¯”è¾ƒå¥½çœ‹ï¼Œæˆ‘ä¹Ÿæ²¡ç ”ç©¶å…¶ä»–å›¾æ ‡ã€‚</p>
</li>
<li><p>èƒŒæ™¯ï¼šæ‰©å±•é‡Œæ‰¾backgroundè¿™ä¸ªæ’ä»¶ï¼ˆåå­—å°±æ˜¯è¿™ä¸ªå•è¯ï¼‰ï¼Œå®‰è£…ä»¥åéœ€è¦è®¾ç½®ä¸€ä¸‹</p>
<ol>
<li><p><code>æ–‡ä»¶â€”&gt;é¦–é€‰é¡¹â€”&gt;è®¾ç½®â€”&gt;æ‰©å±•â€”&gt;Plugin background config.backgroundæ’ä»¶é…ç½®</code></p>
</li>
<li><p>æ‰“å¼€è¿™ä¸ªç•Œé¢ä»¥åï¼Œæœ‰ä¸€è¡Œå­—<code>åœ¨settings.jsonä¸­ç¼–è¾‘</code>ï¼Œç‚¹ä¸€ä¸‹å¯ä»¥æ‰“å¼€settings.jsonï¼ˆå®é™…ä¸Šåœ¨å…¶ä»–æ‰©å±•é‡Œä¹Ÿèƒ½æ‰¾åˆ°è¿™è¡Œå­—ï¼Œæ€»ä¹‹æ‰“å¼€settings.jsonå°±è¡Œï¼‰</p>
</li>
<li><p>å¦‚æœä¹‹å‰ä»€ä¹ˆæ‰©å±•ä¹Ÿæ²¡è£…ï¼Œä¹Ÿæ²¡æåˆ«çš„é…ç½®ï¼Œé‚£è¿™ä¸ªæ–‡ä»¶æ‰“å¼€ä»¥ååº”è¯¥æ˜¯åªæœ‰ä¸¤è¡ŒèŠ±æ‹¬å·(<code>{}</code>)çš„ï¼Œå¦‚æœä¹‹å‰è£…äº†åˆ«çš„ï¼Œé‚£èŠ±æ‹¬å·ä¸­é—´å¯èƒ½ä¼šæœ‰å‡ è¡Œå†…å®¹ï¼Œæ¥ä¸‹æ¥åœ¨èŠ±æ‹¬å·é‡Œé¢è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;background.enabled&quot;: true,</span><br><span class="line">   &quot;background.useDefault&quot;: false,</span><br><span class="line">   &quot;background.customImages&quot;:[&quot;file:&#x2F;&#x2F;&#x2F;C:&#x2F;Users&#x2F;LiKun&#x2F;Pictures&#x2F;background.png&quot;],</span><br><span class="line">   &quot;background.style&quot;:&#123;</span><br><span class="line">       &quot;content&quot;:&quot;&#39;&#39;&quot;,</span><br><span class="line">       &quot;pointer-events&quot;:&quot;none&quot;,</span><br><span class="line">       &quot;position&quot;:&quot;absolute&quot;,&#x2F;&#x2F;å›¾ç‰‡ä½ç½®</span><br><span class="line">       &quot;width&quot;:&quot;99%&quot;,</span><br><span class="line">       &quot;height&quot;:&quot;99%&quot;,</span><br><span class="line">       &quot;z-index&quot;:&quot;99999&quot;,</span><br><span class="line">       &quot;background.repeat&quot;:&quot;no-repeat&quot;,</span><br><span class="line">       &quot;background-size&quot;:&quot;25%,25%&quot;,&#x2F;&#x2F;å›¾ç‰‡å¤§å°</span><br><span class="line">       &quot;opacity&quot;:0.3 &#x2F;&#x2F;é€æ˜åº¦</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼šæ¯ä¸€è¡Œæœ€åçš„é€—å·ä¸è¦å¿˜äº†ï¼ŒèƒŒæ™¯å›¾çš„è·¯å¾„æ”¹æˆè‡ªå·±çš„å›¾ï¼Œæˆ‘è¿™ä¸ªè®¾ç½®æ˜¯èƒŒæ™¯å›¾å‡ºç°åœ¨å³ä¸‹è§’çš„ä½ç½®ï¼Œå¦‚æœæœ‰å…¶ä»–éœ€æ±‚è‡ªå·±æ”¹å°±è¡Œã€‚</p>
</li>
</ol>
</li>
</ol>
<h2 id="latex"><a href="#latex" class="headerlink" title="latex"></a>latex</h2><ol>
<li><p>å®‰è£…texliveï¼Œå› ä¸ºæˆ‘ä¹‹å‰å®‰è£…è¿‡texstudioæ‰€ä»¥å°±æ²¡å†è£…äº†ï¼Œè¿™é‡Œè¦è®°å¾—ç¯å¢ƒå˜é‡çš„é—®é¢˜ï¼Œæ­£å¸¸æ¥è¯´å®‰è£…çš„æ—¶å€™ä¼šè‡ªåŠ¨æ·»åŠ ï¼Œå¦‚æœæ²¡å‹¾é€‰é‚£å°±è¦è‡ªå·±é…ç½®ï¼›</p>
</li>
<li><p>vscodeçš„æ‰©å±•é‡Œæ‰¾latex workshopå®‰è£…ï¼Œæ®è¯´å®‰è£…å¥½å°±èƒ½ç¼–è¯‘texæ–‡ä»¶å¹¶ç”Ÿæˆpdfï¼Œä¸è¿‡æˆ‘è¿˜æäº†ä¹±ä¸ƒå…«ç³Ÿçš„è®¾ç½®æ‰å¯ä»¥ï¼›</p>
</li>
<li><p>è®¾ç½®è¿‡ç¨‹è¿˜æ˜¯æ‰“å¼€setting.jsonï¼Œç›´æ¥è¾“å…¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;latex-workshop.latex.recipes&quot;: [</span><br><span class="line">     &#123;</span><br><span class="line">       &quot;name&quot;: &quot;xelatex -&gt; bibtex -&gt; xelatex*2&quot;,</span><br><span class="line">       &quot;tools&quot;: [</span><br><span class="line">         &quot;xelatex&quot;,</span><br><span class="line">         &quot;bibtex&quot;,</span><br><span class="line">         &quot;xelatex&quot;,</span><br><span class="line">         &quot;xelatex&quot;</span><br><span class="line">       ]</span><br><span class="line">     &#125;</span><br><span class="line">   ],</span><br><span class="line">   &quot;latex-workshop.latex.tools&quot;: [</span><br><span class="line">     &#123;</span><br><span class="line">       &quot;name&quot;: &quot;xelatex&quot;,</span><br><span class="line">       &quot;command&quot;: &quot;xelatex&quot;,</span><br><span class="line">       &quot;args&quot;: [</span><br><span class="line">         &quot;-synctex&#x3D;1&quot;,</span><br><span class="line">         &quot;-interaction&#x3D;nonstopmode&quot;,</span><br><span class="line">         &quot;-file-line-error&quot;,</span><br><span class="line">         &quot;%DOC%&quot;</span><br><span class="line">       ]</span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">       &quot;name&quot;: &quot;latexmk&quot;,</span><br><span class="line">       &quot;command&quot;: &quot;latexmk&quot;,</span><br><span class="line">       &quot;args&quot;: [</span><br><span class="line">         &quot;-synctex&#x3D;1&quot;,</span><br><span class="line">         &quot;-interaction&#x3D;nonstopmode&quot;,</span><br><span class="line">         &quot;-file-line-error&quot;,</span><br><span class="line">         &quot;%DOC%&quot;</span><br><span class="line">       ]</span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">       &quot;name&quot;: &quot;pdflatex&quot;,</span><br><span class="line">       &quot;command&quot;: &quot;pdflatex&quot;,</span><br><span class="line">       &quot;args&quot;: [</span><br><span class="line">         &quot;-synctex&#x3D;1&quot;,</span><br><span class="line">         &quot;-interaction&#x3D;nonstopmode&quot;,</span><br><span class="line">         &quot;-file-line-error&quot;,</span><br><span class="line">         &quot;%DOC%&quot;</span><br><span class="line">       ]</span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">       &quot;name&quot;: &quot;bibtex&quot;,</span><br><span class="line">       &quot;command&quot;: &quot;bibtex&quot;,</span><br><span class="line">       &quot;args&quot;: [</span><br><span class="line">         &quot;%DOCFILE%&quot;</span><br><span class="line">       ]</span><br><span class="line">     &#125;</span><br><span class="line">   ],</span><br><span class="line">   &quot;latex-workshop.view.pdf.viewer&quot;: &quot;tab&quot;,</span><br><span class="line">   &quot;editor.wordWrap&quot;: &quot;on&quot;,</span><br><span class="line">   &quot;latex-workshop.synctex.afterBuild.enabled&quot;: true,</span><br><span class="line">   &quot;latex-workshop.view.pdf.internal.synctex.keybinding&quot;: &quot;double-click&quot;,</span><br><span class="line">   &quot;[latex]&quot;: &#123;</span><br><span class="line">     &quot;editor.defaultFormatter&quot;: &quot;nickfode.latex-formatter&quot;</span><br><span class="line">   &#125;,</span><br><span class="line">   &quot;latex-workshop.latex.autoClean.run&quot;: &quot;onBuilt&quot;,</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼šè¿™ä¸ªæ–‡ä»¶æœ€å¤–å±‚å°±ä¸€ç»„èŠ±æ‹¬å·ï¼Œä¸ç®¡æœ‰å¤šå°‘è¦è®¾ç½®çš„ä¸œè¥¿éƒ½åœ¨é‡Œé¢åŠ ï¼›latexçš„å†…å®¹é‡Œæœ‰ä¸€äº›æ˜¯åœ¨é‚£ä¸ªè®¾ç½®é‡Œå¯ä»¥ç›´æ¥é€‰çš„ï¼Œè€Œä¸æ˜¯é€šè¿‡è¿™ç§è®©äººçœ‹ä¸æ‡‚çš„ä»£ç æ¥è®¾ç½®ï¼Œä¾‹å¦‚<code>&quot;latex-workshop.view.pdf.internal.synctex.keybinding&quot;: &quot;double-click&quot;</code>è¿™ä¸€å¥çš„ä½œç”¨æ˜¯åœ¨pdfé‡ŒåŒå‡»å¯ä»¥è·³è½¬åˆ°latexæºæ–‡ä»¶å¯¹åº”çš„ä½ç½®ï¼Œæœ¬æ¥é»˜è®¤çš„æ˜¯ctrlç‚¹å‡»ï¼Œä½†æ˜¯æˆ‘ä¹ æƒ¯åŒå‡»ï¼Œå¯ä»¥åœ¨è®¾ç½®é‡Œæœsynctex:keybindingç„¶åä¿®æ”¹ï¼Œæ”¹äº†ä¼šè‡ªåŠ¨åœ¨settings.json é‡Œå‡ºç°é‚£å¥è¯ï¼›<code>&quot;editor.wordWrap&quot;: &quot;on&quot;</code>æ˜¯å’Œlatexæœ¬èº«æ— å…³çš„è®¾ç½®ï¼Œæ˜¯è®©ç¼–è¾‘å™¨å¯ä»¥è‡ªåŠ¨æ¢è¡Œï¼›å…¶ä»–å„ç§è®¾ç½®å¯ä»¥è‡ªè¡Œç™¾åº¦ã€‚</p>
</li>
</ol>
<h2 id="python"><a href="#python" class="headerlink" title="python"></a>python</h2><ol>
<li>æ‰©å±•é‡Œæœpythonï¼Œå®‰è£…è·³å‡ºæ¥çš„ç¬¬ä¸€ä¸ªå°±è¡Œï¼›</li>
<li>å¯èƒ½å’Œæˆ‘ä¹‹å‰å·²ç»å®‰è£…è¿‡pythonã€pycharmç­‰ç­‰ä¸œè¥¿æœ‰å…³ï¼Œå®‰è£…æ’ä»¶ä¹‹åå°±èƒ½ç¼–è¯‘è¿è¡Œpythonäº†ã€‚</li>
</ol>
<h2 id="Cå’ŒC"><a href="#Cå’ŒC" class="headerlink" title="Cå’ŒC++"></a>Cå’ŒC++</h2><ol>
<li>å®‰è£…mingwï¼Œå¦‚æœä¹‹å‰è£…è¿‡å°±ä¸å¿…é‡è£…äº†ï¼Œè¿™é‡Œè¦è‡ªå·±æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œç„¶åæ£€æŸ¥æœ‰æ²¡æœ‰è£…å¥½ï¼›</li>
<li>vscodeé‡Œå®‰è£…C/C++æ‰©å±•ï¼Œå¯èƒ½è£…å¥½è¦é‡å¯ï¼›</li>
<li>æ‰“å¼€è¦å†™ä»£ç çš„é‚£ä¸ªæ–‡ä»¶å¤¹ï¼Œæ¯”å¦‚C++æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æ–°å»ºä¸€ä¸ªcppæ–‡ä»¶éšä¾¿å†™å‡ è¡Œï¼›</li>
<li><code>Ctrl+Shift+P</code>è¾“å…¥C/C++ï¼Œé€‰æ‹©â€œEdit Configurations(UI)â€è¿›å…¥é…ç½®ï¼Œè¿™é‡Œè¦é€‰ç¼–è¯‘å™¨ï¼š<code>C:/Program Files/mingw-w64/x86_64-8.1.0-posix-seh-rt_v6-rev0/mingw64/bin/g++.exe</code>ï¼Œè·¯å¾„æ”¹æˆè‡ªå·±çš„ï¼Œè¿˜è¦é€‰IntelliSense æ¨¡å¼ï¼Œè¦ç”¨gcc-x64ï¼›</li>
<li>ä¸Šä¸€æ­¥åšå¥½ä»¥åï¼Œå¯ä»¥çœ‹åˆ°C++æ–‡ä»¶å¤¹é‡Œå¤šå‡ºä¸€ä¸ª.vscodeæ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰c_cpp_properties.jsonæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹æ˜¯å†™å¥½çš„ï¼Œå¯ä»¥çœ‹çœ‹ï¼Œä¸è¿‡ä¸éœ€è¦ä¿®æ”¹ï¼›</li>
<li>å†æŒ‰<code>Ctrl+Shift+P</code>è¾“å…¥tasksï¼Œé€‰æ‹©â€œTasks:Configure Default Build Taskâ€ï¼Œå†é€‰æ‹©â€œC/C++: g++.exe build active fileâ€ï¼Œç„¶å.vscodeæ–‡ä»¶å¤¹é‡Œå°±ä¼šå‡ºç°tasks.jsonï¼Œä¹Ÿæ˜¯å†™å¥½çš„ï¼Œä¸éœ€è¦æ”¹ï¼›</li>
<li>æ¥ä¸‹æ¥ç‚¹è¿è¡Œâ€”&gt;å¯åŠ¨è°ƒè¯•ï¼Œæˆ–è€…ç›´æ¥æŒ‰F5ï¼Œé€‰æ‹©C++(GDB/LLDB)ï¼Œä¼šå‡ºç°ä¸€ä¸ªlaunch.jsonï¼Œæˆ–è€…å·¦è¾¹é‚£åˆ—æ‰©å±•æŒ‰é’®ä¸Šé¢çš„é‚£ä¸ªæŒ‰é’®é‡Œæœ‰ä¸ªåˆ›å»ºlaunch.jsonä¹Ÿå¯ä»¥ï¼›</li>
<li>ä¸Šä¸€æ­¥çš„launch.jsoné‡Œå¯ä»¥è‡ªå·±æ ¹æ®éœ€æ±‚æ·»åŠ ä¸€äº›é…ç½®ï¼Œæˆ–è€…å»ç½‘ä¸Šå¤åˆ¶åˆ«äººçš„é…ç½®ï¼Œæ€»ä¹‹æˆ‘è¿™é‡Œæ˜¯ä»€ä¹ˆä¹Ÿæ²¡æ”¹å°±èƒ½ç›´æ¥è¿è¡Œï¼›</li>
<li>ç„¶åå†æŒ‰F5ï¼Œå°±å¯ä»¥è¿è¡Œæ–‡ä»¶äº†ï¼›</li>
<li>åœ¨ç¬¬4æ­¥ä¹‹åï¼Œå°±å¯ä»¥åœ¨vscodeé‡Œæ‰¾åˆ°ç»ˆç«¯ç„¶ågccç¼–è¯‘è¿è¡Œæ–‡ä»¶ï¼›</li>
<li>é»˜è®¤è¿è¡Œè¾“å‡ºä¿¡æ¯æ˜¯åœ¨ä¸‹é¢çš„ç»ˆç«¯ï¼Œåœ¨launch.jsoné‡Œæ‰¾åˆ°â€externalConsoleâ€ç„¶åæŠŠå®ƒçš„falseæ”¹æˆtrue,å°±å¯ä»¥å‡ºç°ç‹¬ç«‹çš„å‘½ä»¤è¡Œç•Œé¢æ¥æ˜¾ç¤ºä¿¡æ¯äº†ã€‚</li>
</ol>
]]></content>
      <categories>
        <category>ç¼–è¾‘å™¨é…ç½®</category>
      </categories>
      <tags>
        <tag>æ•™ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonè¯¾ç¨‹è®°å½•-13</title>
    <url>/2020/05/26/python%E8%AF%BE%E7%A8%8B%E8%AE%B0%E5%BD%95-13/</url>
    <content><![CDATA[<p>è¿™ä¸€è¯¾è®²scipyåº“ã€‚</p>
<p><code>from scipy import some_module</code></p>
<p><code>from scipy.some_module import some_function</code></p>
<a id="more"></a>

<h2 id="linalgæ¨¡å—çš„ä½¿ç”¨"><a href="#linalgæ¨¡å—çš„ä½¿ç”¨" class="headerlink" title="linalgæ¨¡å—çš„ä½¿ç”¨"></a>linalgæ¨¡å—çš„ä½¿ç”¨</h2><ol>
<li><p>åŸºæœ¬çº¿æ€§ä»£æ•°æ“ä½œï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> linalg</span><br><span class="line">arr = np.array([[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>]])</span><br><span class="line"><span class="comment"># è®¡ç®—çŸ©é˜µçš„è¡Œåˆ—å¼</span></span><br><span class="line">linalg.det(arr)				</span><br><span class="line"><span class="comment"># output: -2.0</span></span><br><span class="line"><span class="comment"># è®¡ç®—ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡</span></span><br><span class="line">linalg.eig(arr)</span><br><span class="line"><span class="comment"># output: (array([-0.37228132+0.j,  5.37228132+0.j]), array([[-0.82456484, -0.41597356], [ 0.56576746, -0.90937671]]))</span></span><br><span class="line"><span class="comment"># çŸ©é˜µæ±‚é€†</span></span><br><span class="line">linalg.inv(arr)</span><br><span class="line"><span class="comment"># output: array([[-2. ,  1. ], [ 1.5, -0.5]])</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è§£çº¿æ€§æ–¹ç¨‹ç»„ï¼š$Ax=b$ï¼Œå…¶ä¸­Aæ˜¯æ–¹é˜µï¼š<code>solve(A, b)</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> linalg</span><br><span class="line">m = <span class="number">500</span></span><br><span class="line">A=np.random.rand(m,m)</span><br><span class="line">b=np.random.rand(m)</span><br><span class="line">x1=linalg.solve(A,b)</span><br><span class="line">x2=np.dot(linalg.inv(A),b)</span><br><span class="line">print(np.allclose(x1,x2))</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ›´ä¸€èˆ¬çš„çº¿æ€§æ–¹ç¨‹ç»„ï¼š$Ax=b$ï¼Œå…¶ä¸­Aä¸æ˜¯æ–¹é˜µï¼š<code>lstsq(A,q)</code>æ‰¾æœ€å°äºŒä¹˜è§£</p>
<p>ä¾‹å¦‚ï¼šç»™å®šå››ä¸ªç‚¹<code>(1,6) (2,5) (3,7) (4,10)</code>ï¼Œæ‰¾æ‹Ÿåˆç›´çº¿<code>y=ax+b</code> è¿™æ ·çš„é—®é¢˜å¯ä»¥è½¬åŒ–ä¸ºï¼šçŸ©é˜µ<code>A=[[1,2],[2,1],[3,1],[4,1]]</code> ï¼Œ<code>b=[6, 5, 7, 10]^T</code>ï¼Œ<code>x=[a,b]^T</code>ï¼Œæ±‚è§£<code>Ax=b</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> linalg</span><br><span class="line">A = np.array([[<span class="number">1</span>,<span class="number">1</span>],[<span class="number">2</span>,<span class="number">1</span>],[<span class="number">3</span>,<span class="number">1</span>],[<span class="number">4</span>,<span class="number">1</span>]])</span><br><span class="line">y = np.array([<span class="number">6</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">10</span>])</span><br><span class="line">c,resid,rank,sigma=linalg.lstsq(A,y)</span><br><span class="line">print(c, resid, rank, sigma)</span><br><span class="line"><span class="comment"># [1.4 3.5] 4.200000000000003 2 [5.77937881 0.77380911]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å…¶ä»–åŠŸèƒ½ï¼š</p>
<ol>
<li>èŒƒæ•°æ±‚è§£: <code>linalg.norm</code></li>
<li>å¹¿ä¹‰é€†æ±‚è§£: <code>linalg.pinv, linalg.pinv2</code></li>
<li>çŸ©é˜µåˆ†è§£ï¼š<code>linalg.sva, linalg.lu, linalg.qr</code></li>
</ol>
</li>
</ol>
<h2 id="optimizeæ¨¡å—çš„ä½¿ç”¨"><a href="#optimizeæ¨¡å—çš„ä½¿ç”¨" class="headerlink" title="optimizeæ¨¡å—çš„ä½¿ç”¨"></a>optimizeæ¨¡å—çš„ä½¿ç”¨</h2><ol>
<li><p>æ±‚è§£å¸¦çº¦æŸæ¡ä»¶çš„å‡½æ•°æœ€å°å€¼ï¼š<code>minimize(fun, x0[,args, method, jac, hess, bounds, constrains])</code></p>
<ol>
<li><p>funæ˜¯ç›®æ ‡å‡½æ•° </p>
</li>
<li><p>x0æ˜¯åˆå§‹è§£ </p>
</li>
<li><p>argsï¼šéœ€è¦ä¼ é€’ç»™fun, jac, hesså‡½æ•°çš„é¢å¤–çš„å‚æ•° </p>
</li>
<li><p>methodæ˜¯æ‰€é€‰æ–¹æ³•ï¼šNewton-CGã€CGã€SLSQPã€Nelder-Meadâ€¦â€¦ </p>
</li>
<li><p>jac: JacobiançŸ©é˜µï¼Œæœ‰äº›æ–¹æ³•éœ€è¦ç»™å‡º </p>
</li>
<li><p>hess: HessiançŸ©é˜µï¼Œæœ‰äº›æ–¹æ³•éœ€è¦ç»™å‡º </p>
</li>
<li><p>boundsæ˜¯è§£çš„çº¦æŸèŒƒå›´ï¼Œ L-BFGS-B,TNC,SLSQP,trust-constræ”¯æŒ </p>
</li>
<li><p>constrainsæ˜¯çº¦æŸæ¡ä»¶ï¼ŒCOBYLA, SLSQP, trust-constræ”¯æŒ</p>
<p>ä¾‹å¦‚ï¼š$min x1+x2+x3$</p>
<p>$s.t. x_1x_2x_3&gt;25$</p>
<p>â€‹      $x_1^2+x_2^2+x_3^2=40$</p>
<p>â€‹     $1&lt;=x_1, x_2&lt;=5$     $x_3&gt;=4$</p>
<p>$x_0=(3,3,4)$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> minimize</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">objective</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> np.sum(x)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">constr1</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x[<span class="number">0</span>]*x[<span class="number">1</span>]*x[<span class="number">2</span>]<span class="number">-25</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">constr2</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> np.sum(x**<span class="number">2</span>)<span class="number">-40</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">jac</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> np.array([<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">bnds=((<span class="number">1</span>,<span class="number">5</span>),(<span class="number">1</span>,<span class="number">5</span>),(<span class="number">4</span>,<span class="literal">None</span>))</span><br><span class="line">cons1=&#123;<span class="string">'type'</span>:<span class="string">'ineq'</span>,<span class="string">'fun'</span>:constr1&#125;</span><br><span class="line">cons2=&#123;<span class="string">'type'</span>:<span class="string">'eq'</span>,<span class="string">'fun'</span>:constr2&#125;</span><br><span class="line">cons=[cons1, cons2]</span><br><span class="line">result=minimize(objective,[<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>],method=<span class="string">'SLSQP'</span>,jac=jac,bounds=bnds,constraints=cons)</span><br><span class="line">print(result)</span><br><span class="line"></span><br><span class="line"><span class="comment">#     fun: 9.807034491627501</span></span><br><span class="line"><span class="comment">#     jac: array([1., 1., 1.])</span></span><br><span class="line"><span class="comment"># message: 'Optimization terminated successfully.'</span></span><br><span class="line"><span class="comment">#    nfev: 7</span></span><br><span class="line"><span class="comment">#     nit: 7</span></span><br><span class="line"><span class="comment">#    njev: 7</span></span><br><span class="line"><span class="comment">#  status: 0</span></span><br><span class="line"><span class="comment"># success: True</span></span><br><span class="line"><span class="comment">#       x: array([2.11859914, 2.11859914, 5.5698362 ])</span></span><br><span class="line"><span class="comment"># result.funå¯è¾“å‡ºæœ€å°å€¼ï¼Œresult.xå¯è¾“å‡ºå¯¹åº”çš„xè§£</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>minimizeæ˜¯å±€éƒ¨æœ€ä¼˜ï¼Œbasinhoppingã€shgoç­‰å¯ä»¥æ±‚è§£å…¨å±€æœ€ä¼˜</p>
</li>
<li><p>æ±‚è§£éçº¿æ€§æ–¹ç¨‹ï¼š<code>root(fun, x0[, args, method, jac])</code></p>
<ol>
<li><p>funæ˜¯è¦æ±‚æ ¹çš„æ–¹ç¨‹ï¼ˆç»„ï¼‰ </p>
</li>
<li><p>x0æ˜¯åˆå§‹çŒœæµ‹è§£ </p>
</li>
<li><p>argsæ˜¯funä»¥åŠjacä¸­é¢å¤–çš„å‚æ•° </p>
</li>
<li><p>methodæ˜¯æ‰€é€‰æ–¹æ³•ï¼š hybr, lm, broyden1/2, anderson, linearmixing, krylov, df-sane ç­‰ </p>
</li>
<li><p>jac: JacobiançŸ©é˜µ</p>
<p>ä¾‹å¦‚ï¼šæ±‚è§£ $f(x)=2x^2+3x-10$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> root</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>*x**<span class="number">2</span>+<span class="number">3</span>*x<span class="number">-10</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">jac</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">4</span>*x+<span class="number">3</span></span><br><span class="line"></span><br><span class="line">x=np.linspace(<span class="number">-5</span>,<span class="number">3</span>)</span><br><span class="line">plt.plot(x,func(x))</span><br><span class="line">plt.plot(x,np.zeros(len(x)))</span><br><span class="line"></span><br><span class="line">result1=root(func,<span class="number">-3</span>,method=<span class="string">'hybr'</span>,jac=jac)</span><br><span class="line">result2=root(func,<span class="number">1</span>,method=<span class="string">'lm'</span>,jac=jac)</span><br><span class="line"></span><br><span class="line">print(result1.fun,result2.fun)</span><br><span class="line">print(result1.x, result2.x)</span><br><span class="line"><span class="comment"># [-1.77635684e-15] [0.]</span></span><br><span class="line"><span class="comment"># [-3.10849528] [1.60849528]</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>æ±‚è§£éçº¿æ€§æ–¹ç¨‹ç»„ï¼šå’Œå‰é¢ä¸€æ ·ï¼ŒæŠŠç»™å®šçš„ç›®æ ‡å‡½æ•°å’Œé›…å¯æ¯”çŸ©é˜µå†™æˆå‡½æ•°ç„¶åè¿ç®—ã€‚</p>
</li>
</ol>
<h2 id="integrateæ¨¡å—çš„ä½¿ç”¨"><a href="#integrateæ¨¡å—çš„ä½¿ç”¨" class="headerlink" title="integrateæ¨¡å—çš„ä½¿ç”¨"></a>integrateæ¨¡å—çš„ä½¿ç”¨</h2><ol>
<li><p>æ ¹æ®å‡½æ•°æ±‚è§£ç§¯åˆ†ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> integrate</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">half_circle</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="number">1</span>-x**<span class="number">2</span>)**<span class="number">0.5</span></span><br><span class="line">result = integrate.quad(half_circle, <span class="number">-1</span>, <span class="number">1</span>)	<span class="comment">#ç§¯åˆ†å‡½æ•°å’Œç§¯åˆ†ä¸Šä¸‹é™</span></span><br><span class="line">print(result)</span><br><span class="line"><span class="comment"># quadæ˜¯ä¸€é‡ç§¯åˆ†ï¼Œdblquad()å’Œtplquad()åˆ†åˆ«æ˜¯äºŒé‡å’Œä¸‰é‡ç§¯åˆ†</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ ¹æ®æ ·æœ¬æ±‚è§£ç§¯åˆ†ï¼šåˆ†å¸ƒå‡åŒ€ç”¨<code>romb</code>ï¼Œä¸å‡åŒ€ç”¨<code>trapz(order 1), simple(order 2)</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> scipy.integrate <span class="keyword">import</span> simps</span><br><span class="line">x=np.array([<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line">y=np.array([<span class="number">1</span>,<span class="number">9</span>,<span class="number">16</span>])</span><br><span class="line">result=simps(y1,x)</span><br><span class="line">print(result)	<span class="comment"># 21.0</span></span><br><span class="line"><span class="comment"># ç›¸å½“äºè®¡ç®—xçš„2æ¬¡æ–¹åœ¨1åˆ°4çš„å®šç§¯åˆ†</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ±‚è§£å¸¸å¾®åˆ†æ–¹ç¨‹ï¼š<code>odeint(func, y0, t, args=())</code></p>
<ol>
<li><p>func: è®¡ç®—å¾®åˆ†æ–¹ç¨‹ç»„ä¸­æ¯ä¸ªæœªçŸ¥å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°å€¼</p>
</li>
<li><p>y0ï¼šå¾®åˆ†æ–¹ç¨‹ç»„ä¸­æ¯ä¸ªæœªçŸ¥å‡½æ•°çš„åˆå§‹å€¼</p>
</li>
<li><p>tï¼šéœ€è¦è¿›è¡Œæ•°å€¼æ±‚è§£çš„æ—¶é—´ç‚¹ ï¼ˆæ•°å€¼è§£ï¼‰</p>
</li>
<li><p>argsï¼šè®¡ç®—å¯¼æ•°æ—¶çš„å…¶ä»–å‚æ•°</p>
<p>æ±‚è§£æ–¹ç¨‹ä»¥åè¿˜å¯ä»¥ç”»å¥½çœ‹çš„å‡½æ•°å›¾åƒã€‚</p>
<p>è¿™ä¸ªæ¶‰åŠçš„æ•°å­¦çŸ¥è¯†ç•¥å¤šï¼Œæš‚æ—¶ä¹Ÿä¸ç”¨ï¼Œå°±å…ˆä¸çœ‹ä¾‹å­äº†</p>
</li>
</ol>
</li>
</ol>
<h2 id="interpolateæ¨¡å—çš„ä½¿ç”¨"><a href="#interpolateæ¨¡å—çš„ä½¿ç”¨" class="headerlink" title="interpolateæ¨¡å—çš„ä½¿ç”¨"></a>interpolateæ¨¡å—çš„ä½¿ç”¨</h2><ol>
<li><p>æ’å€¼ï¼š</p>
<ol>
<li>ä¸€/äºŒç»´æ’å€¼ï¼šinterp1d/interp2d </li>
<li>å¤šç»´æ’å€¼ï¼šgriddata </li>
<li>å…¶ä»–å¸¸ç”¨æ’å€¼ï¼šSplineæ ·æ¡æ’å€¼(splï¼ˆæ›²çº¿ï¼‰, bisplï¼ˆæ›²é¢ï¼‰ç­‰)ã€Rbfæ’å€¼</li>
</ol>
</li>
<li><p><code>interp1d(x, y, kind=&#39;linearâ€˜,â€¦â€¦)</code></p>
<ol>
<li>x,yï¼šè¦æ’å€¼çš„æ•°æ®ç‚¹ï¼Œæ³¨æ„xæ˜¯ä¸€ä¸ªé€’å¢åºåˆ— </li>
<li>kindï¼šæ’å€¼çš„æ–¹æ³•ï¼šâ€˜linearâ€™, â€˜nearestâ€™, â€˜zeroâ€™, â€˜slinearâ€™, â€˜quadraticâ€™, â€˜cubicâ€™, â€˜previousâ€™,  â€˜nextâ€™ç­‰</li>
<li>è¿”å›å€¼ï¼šä¸€ä¸ªç”¨äºæ’å€¼çš„å‡½æ•°ï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ä»¥æ–°çš„xä¸ºå‚æ•° ï¼Œä¼šå¾—åˆ°å¯¹åº”çš„yå€¼ã€‚</li>
</ol>
</li>
<li><p>ä¸€ç»´Bæ ·æ¡æ’å€¼ï¼š</p>
<ol>
<li>splrep(x,y,k=3,s,â€¦â€¦)ï¼šè·å¾—ä¸€ç»´æ›²çº¿çš„Bæ ·æ¡è¡¨ç¤º </li>
<li>splev(x, tck, der=0,â€¦â€¦)ï¼šæ ¹æ®Bæ ·æ¡è¡¨ç¤ºå¾—åˆ°å¯¹åº”æ•°å€¼ </li>
</ol>
<p>å‘œå‘œå‘œæˆ‘ä¸æƒ³çœ‹Bæ ·æ¡äº†å°±è¿™æ ·æŠŠ</p>
</li>
</ol>
<h2 id="æ‹Ÿåˆ"><a href="#æ‹Ÿåˆ" class="headerlink" title="æ‹Ÿåˆ"></a>æ‹Ÿåˆ</h2><ol>
<li><p>æœ€å°äºŒä¹˜æ‹Ÿåˆï¼š least_squares(fun, x0, bounds=(-inf, inf), method=â€˜trfâ€™, args,â€¦â€¦) </p>
<ol>
<li><p>funï¼šè®¡ç®—æ®‹å·®å‘é‡(residuals)çš„å‡½æ•° </p>
</li>
<li><p>x0ï¼šçŒœæµ‹çš„å‚æ•°å€¼ğ‘0 </p>
</li>
<li><p>boundsï¼šå‚æ•°ğ‘çš„çº¦æŸèŒƒå›´ï¼Œ2-tupleï¼š((ğ‘içš„ä¸‹é™),(ğ‘içš„ä¸Šé™)) </p>
</li>
<li><p>methodï¼š â€˜trfâ€™, â€˜dogboxâ€™, â€˜lmâ€™ï¼Œå…¶ä¸­â€˜lmâ€™ä¸æ”¯æŒbounds </p>
</li>
<li><p>argsï¼šè®¡ç®—funéœ€è¦çš„å…¶ä»–å‚æ•°ï¼Œä¾‹å¦‚æ ·æœ¬æ•°æ®xï¼Œy</p>
<p>è¿”å›å€¼ï¼š </p>
</li>
<li><p>xï¼šæ±‚è§£å‡ºæ¥ä½¿å¾—Sæœ€å°çš„å‚æ•°ğ‘ </p>
</li>
<li><p>funï¼šå¯¹åº”çš„æ®‹å·®å‘é‡</p>
</li>
</ol>
<p>ä¸€ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(x,p)</span>:</span></span><br><span class="line">    A,k,theta = p</span><br><span class="line">    <span class="keyword">return</span> A*np.sin(<span class="number">2</span>*np.pi*k*x+theta)</span><br><span class="line">x=np.linspace(<span class="number">0</span>,<span class="number">2</span>*np.pi,<span class="number">100</span>)</span><br><span class="line">A,k,theta=<span class="number">10</span>,<span class="number">0.34</span>,np.pi/<span class="number">6</span>	<span class="comment"># çœŸå®æ•°æ®çš„å‡½æ•°å‚æ•°</span></span><br><span class="line">y0=func(x,[A,k,theta])		<span class="comment"># çœŸå®æ•°æ®</span></span><br><span class="line">np.random.seed(<span class="number">0</span>)			<span class="comment"># å™ªå£°ç§å­</span></span><br><span class="line">y=y0+<span class="number">2</span>*np.random.randn(len(x))	<span class="comment"># æ·»åŠ å™ªå£°åçš„æ•°æ®</span></span><br><span class="line"></span><br><span class="line">plt.plot(x,y,<span class="string">"o"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">residuals</span><span class="params">(p,y,x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> y-func(x,p)</span><br><span class="line">p0=[<span class="number">7</span>,<span class="number">0.4</span>,<span class="number">0</span>]</span><br><span class="line">plsq=optimize.least_squares(residuals,p0,args=(y,x))</span><br><span class="line">print(<span class="string">"çœŸå®å‚æ•°ï¼š"</span>,[A,k,theta])</span><br><span class="line">print(<span class="string">"æ‹Ÿåˆå‚æ•°ï¼š"</span>,plsq.x)</span><br><span class="line">plt.plot(x,func(x,plsq.x))</span><br><span class="line"><span class="comment"># çœŸå®å‚æ•°ï¼š [10, 0.34, 0.5235987755982988]</span></span><br><span class="line"><span class="comment"># æ‹Ÿåˆå‚æ•°ï¼š [10.25218748  0.3423992   0.50817423]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>scipy.optimize.curve_fit</code>ï¼šå®è´¨å’Œæœ€å°äºŒä¹˜ä¸€æ ·</p>
<p>ç”¨æ³•ä¸Šå’Œleast_squaresç¨æœ‰ç‚¹ä¸åŒï¼šä¸ç”¨å®šä¹‰è¯¯å·®å‡½æ•°ï¼Œç›´æ¥ ä½¿ç”¨ç›®æ ‡å‡½æ•°ï¼Œä¸”ç›®æ ‡å‡½æ•°çš„å„ä¸ªå¾…ä¼˜åŒ–å‚æ•°ğ‘ç›´æ¥ä½œä¸ºå‡½æ•°çš„å‚ æ•°ä¼ å…¥ã€‚</p>
</li>
<li><p>å¤šé¡¹å¼æ‹Ÿåˆpolyfitï¼š</p>
<ol>
<li><p>numpy/scipy.polyfit(x, y, deg,â€¦â€¦)ï¼š </p>
<ol>
<li>x,yï¼šå¾…æ‹Ÿåˆçš„æ•°æ® </li>
<li>degï¼šå¤šé¡¹å¼çš„æ¬¡æ•°<br>è¿”å›å€¼ï¼š<br>pï¼šæ‹Ÿåˆåçš„å¤šé¡¹å¼çš„ç³»æ•°ï¼Œä»<strong>é«˜</strong>ä½åˆ°<strong>ä½</strong>ä½</li>
</ol>
</li>
<li><p>numpy/scipy.polyval(p, x)ï¼šè®¡ç®—å¤šé¡¹å¼påœ¨xå¤„çš„å€¼</p>
</li>
</ol>
<p>ä¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p = np.polyfit(x,y,<span class="number">10</span>)</span><br><span class="line">plt.plot(x,np.polyval(p,x),<span class="string">'k-'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>polynomialæ¨¡å—ï¼š</p>
<ol>
<li>æ‹Ÿåˆï¼šå’Œä¸Šé¢çš„åŒºåˆ«åœ¨äºï¼Œè¿”å›çš„å¤šé¡¹å¼ç³»æ•°æ˜¯ä»<strong>ä½</strong>åˆ°<strong>é«˜</strong>çš„</li>
</ol>
<p>ä¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> numpy.polynomial <span class="keyword">import</span> polymial <span class="keyword">as</span> P</span><br><span class="line">p2=P.polyfit(x,y,<span class="number">10</span>)</span><br><span class="line">plt.plot(x,P.polyfit(x,p2),<span class="string">'m-'</span>)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>å››åˆ™è¿ç®—ï¼š<code>P.polyadd(), P.polysub(), P.polymul(), P.polydiv()</code></p>
</li>
<li><p>å¾®åˆ†ï¼š<code>P.polyder()</code>ç”¨æ¥æ±‚å¾®åˆ†ä»¥åçš„å¤šé¡¹å¼å‚æ•°ï¼Œé»˜è®¤æ˜¯ä¸€é˜¶å¯¼ï¼ŒåŠ å‚æ•°å°±æ˜¯å‚æ•°å¯¹åº”çš„å¯¼æ•°</p>
<p>ä¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)	<span class="comment"># 1+2x+3x**2+4x**3</span></span><br><span class="line">P.polyder(a)	<span class="comment"># (d/dx)(c)=2+6x+12x**2	</span></span><br><span class="line"><span class="comment"># array([ 2., 6., 12.])</span></span><br><span class="line">P.polyder(a,<span class="number">3</span>)	<span class="comment"># (d**3/dx**3)(c)=24</span></span><br><span class="line"><span class="comment"># array([ 24.])</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ç§¯åˆ†ï¼š<code>P.polyint(c)</code>  å’Œå¾®åˆ†ç±»ä¼¼çš„ç”¨æ³•</p>
</li>
<li><p>æ±‚æ ¹ï¼š<code>P.polyroots(a)</code> å’Œå¾®åˆ†ç±»ä¼¼ï¼Œå¯¹å¤šé¡¹å¼æ±‚æ ¹ï¼Œè¿”å›è¿ç®—ä¹‹åçš„å‚æ•°</p>
</li>
</ol>
<h2 id="éšå ‚ç»ƒä¹ "><a href="#éšå ‚ç»ƒä¹ " class="headerlink" title="éšå ‚ç»ƒä¹ "></a>éšå ‚ç»ƒä¹ </h2><p>IBM.csvä¸­ä¿å­˜äº†2014å¹´ä»¥æ¥çš„IBMè‚¡ç¥¨ä¿¡æ¯ï¼Œè¯·è¯»å…¥IBMçš„æ”¶ç›˜ä»·ï¼Œç„¶åé€‰å–å…¶ä¸­2019å¹´çš„æ•°æ®ï¼Œä¹‹åï¼š ï¼ˆ1ï¼‰å‡è®¾æ¯å¤©çš„æ”¶ç›˜ä»·å¯ä»¥ç”¨ä¹‹å‰5å¤©çš„æ”¶ç›˜ä»·çš„çº¿æ€§ç»„åˆè¡¨ç¤ºå‡ºæ¥ï¼Œç”±æ­¤å»ºç«‹ä¸€ä¸ªçº¿æ€§æ¨¡å‹è¿›è¡Œæ”¶ç›˜ä»·çš„é¢„æµ‹ï¼Œæ±‚è§£æœ€ä½³çš„çº¿æ€§ç»„åˆç³»æ•°ï¼Œå¹¶ç»˜åˆ¶æ”¶ç›˜ä»·ä»¥åŠé¢„æµ‹çš„æ”¶ç›˜ä»·çš„æ›²çº¿å›¾ã€‚ </p>
<p>ï¼ˆ2ï¼‰é‡‡ç”¨å¤šé¡¹å¼å¯¹æ”¶ç›˜ä»·è¿›è¡Œæ‹Ÿåˆï¼Œå°è¯•ä¸åŒçš„å¤šé¡¹å¼æ¬¡æ•°ï¼Œ é€‰å–å…¶ä¸­è¾ƒä¼˜çš„ç»“æœï¼Œæ‰“å°è¯¥å¤šé¡¹å¼çš„å„é¡¹ç³»æ•°ï¼Œå¹¶ç»˜åˆ¶å¤šé¡¹å¼æ›²çº¿ä»¥åŠæ”¶ç›˜ä»·æ•£ç‚¹å›¾ã€‚è¿›ä¸€æ­¥ï¼Œæ±‚è§£è¯¥å¤šé¡¹å¼çš„è½¬æŠ˜ç‚¹ï¼Œ å³ä¸€é˜¶å¯¼æ•°ä¸º0çš„ç‚¹ï¼ˆåªè¦å®æ•°è§£ï¼‰ï¼Œå¹¶åœ¨å¤šé¡¹å¼æ›²çº¿ä¸Šä»¥ä¸Šä¸‰è§’çš„æ ‡è®°ç»˜åˆ¶å‡ºæ¥ã€‚</p>
<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><ol>
<li>é¦–å…ˆæ˜¯è¯»å–csvæ–‡ä»¶å¹¶æå–2019å¹´æ”¶ç›˜ä»·ï¼š</li>
<li>æ¥ä¸‹æ¥ï¼Œç¬¬ä¸€é—®å¯ä»¥çœ‹ä½œæ˜¯æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„çš„ç³»æ•°ï¼Œ<code>y=a*x1+b*x2+c*x3+d*x4+e*x5+f</code>ï¼Œå…¶ä¸­<code>abcdef</code>æ˜¯å¾…æ±‚è§£å‚æ•°ï¼Œ<code>x1,x2,x3,x4,x5</code>åˆ†åˆ«æ˜¯è¿ç»­5å¤©çš„æ”¶ç›˜ä»·ï¼Œè€Œ<code>y</code>æ˜¯ç¬¬å…­å¤©æ”¶ç›˜ä»·ã€‚<ol>
<li>å»ºç«‹å­˜æ”¾<code>x</code>çš„åˆ—è¡¨ï¼›</li>
<li>éå†æ”¶ç›˜ä»·åˆ—è¡¨ï¼ŒæŠŠæ¯ä¸€ç»„æ”¶ç›˜ä»·ï¼ˆè¿ç»­5ä¸ªï¼‰ä½œä¸ºä¸€ä¸ªåˆ—è¡¨åŠ åˆ°xä¸­ï¼Œæ³¨æ„è¿™é‡Œéå†çš„ç»ˆç‚¹æ˜¯å€’æ•°ç¬¬5ä¸ªï¼Œå› ä¸ºå†å¾€åå°±æ— æ³•å‡‘æˆè¿ç»­5ä¸ªäº†ï¼›</li>
<li>æ¯ä¸€è¡Œ<code>x</code>å¯¹åº”çš„<code>y</code>éƒ½æ˜¯è¿ç»­5ä¸ªæ”¶ç›˜ä»·çš„ä¸‹ä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯ç¬¬6ä¸ªæ”¶ç›˜ä»·å¼€å§‹ï¼Œå³<code>ibm_2019[5:]</code></li>
<li><code>x</code>å’Œ<code>y</code>éƒ½è¦è½¬ä¸º<code>np.array</code>ï¼Œç„¶åç”¨<code>lstsq</code>æ±‚è§£ç³»æ•°å¹¶ç»˜åˆ¶å›¾åƒå³å¯ï¼›</li>
</ol>
</li>
<li>ç¬¬äºŒé—®åˆ™æ˜¯å¤šé¡¹å¼æ‹Ÿåˆï¼Œè¿™é‡Œæˆ‘æŠŠè‡ªå˜é‡<code>x</code>è®¾ç½®ä¸º<code>1,2,3,...</code>ï¼Œå› å˜é‡<code>y</code>å°±æ˜¯æ‰€æœ‰æ”¶ç›˜ä»·ï¼Œç„¶åä½¿ç”¨<code>polyfit</code>æ±‚è§£å¹¶è¾“å‡ºå’Œç»˜å›¾å³å¯ã€‚ç»è¿‡å°è¯•å’Œæ¯”è¾ƒï¼Œé€‰æ‹©äº†<code>deg=17</code>ã€‚</li>
<li>æ±‚è§£ä¸€é˜¶å¯¼æ•°ä¸º0çš„ç‚¹ï¼Œä¹Ÿå°±æ˜¯å…ˆå¯¹ä¹‹å‰çš„å¤šé¡¹å¼æ±‚å¯¼å¾—åˆ°æ–°å¤šé¡¹å¼ï¼Œå†æ±‚è§£æ–°å¤šé¡¹å¼çš„æ ¹ï¼Œæœ€ååœ¨å›¾åƒä¸­æ ‡æ³¨å³å¯ã€‚</li>
</ol>
<p>æ•´ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> linalg</span><br><span class="line"><span class="keyword">from</span> numpy.polynomial <span class="keyword">import</span> polynomial <span class="keyword">as</span> P</span><br><span class="line">ibm = pd.read_csv(<span class="string">'IBM.csv'</span>, header=<span class="number">0</span>, index_col=<span class="number">0</span>, parse_dates=<span class="literal">True</span>)</span><br><span class="line">ibm_group = ibm.groupby(ibm.index.year)</span><br><span class="line">ibm_2019 = ibm_group.get_group(<span class="number">2019</span>)[<span class="string">'Close'</span>]</span><br><span class="line">x = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(ibm_2019)<span class="number">-5</span>):</span><br><span class="line">    tmp=[ibm_2019[i],ibm_2019[i+<span class="number">1</span>],ibm_2019[i+<span class="number">2</span>],ibm_2019[i+<span class="number">3</span>],ibm_2019[i+<span class="number">4</span>],<span class="number">1</span>]</span><br><span class="line">    x.append(tmp)</span><br><span class="line">x = np.array(x)</span><br><span class="line">y = np.array(ibm_2019[<span class="number">5</span>:])</span><br><span class="line">c,resid,rank,sigma=linalg.lstsq(x,y)</span><br><span class="line">x_1=np.linspace(<span class="number">1</span>,y.size,y.size)</span><br><span class="line">plt.figure()</span><br><span class="line">plt.plot(x_1,y,<span class="string">'x'</span>, x_1,x.dot(c))</span><br><span class="line">x_2=np.linspace(<span class="number">1</span>,len(ibm_2019),len(ibm_2019))</span><br><span class="line">p=P.polyfit(x_2,ibm_2019,<span class="number">17</span>)</span><br><span class="line">print(<span class="string">"å¤šé¡¹å¼ç³»æ•°ä¸ºï¼š"</span>,p)</span><br><span class="line">plt.figure()</span><br><span class="line">plt.plot(x_2,ibm_2019,<span class="string">'x'</span>,x_2,P.polyval(x_2,p),<span class="string">'k-'</span>)</span><br><span class="line">p2=P.polyder(p)</span><br><span class="line">root=P.polyroots(p2)</span><br><span class="line">plt.plot(root, P.polyval(root,p),<span class="string">'r^'</span>)</span><br></pre></td></tr></table></figure>



</li>
</ol>
]]></content>
      <categories>
        <category>è¯¾ç¨‹ç¬”è®°</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>è®ºæ–‡è®°å½•-FractalNetçš„ODEå»ºæ¨¡</title>
    <url>/2020/05/23/%E8%AE%BA%E6%96%87%E8%AE%B0%E5%BD%95-BEYOND%20FINITE%20LAYER%20NEURAL%20NETWORKS%20BRIDGING%20DEEP%20ARCHITECTURES%20AND%20NUMERICAL%20DIFFERENTIAL%20EQUATIONS/</url>
    <content><![CDATA[<h1 id="FractalNetçš„ODEå»ºæ¨¡"><a href="#FractalNetçš„ODEå»ºæ¨¡" class="headerlink" title="FractalNetçš„ODEå»ºæ¨¡"></a>FractalNetçš„ODEå»ºæ¨¡</h1><p>è®ºæ–‡1ï¼šBEYOND FINITE LAYER NEURAL NETWORKS: BRIDGING DEEP ARCHITECTURES AND NUMERICAL DIFFERENTIAL EQUATIONS</p>
<p>è®ºæ–‡2ï¼šFRACTALNET: ULTRA-DEEP NEURAL NETWORKS WITHOUT RESIDUALS</p>
<a id="more"></a>

]]></content>
      <categories>
        <category>è®ºæ–‡</category>
      </categories>
      <tags>
        <tag>deep learning</tag>
        <tag>OED</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonè¯¾ç¨‹è®°å½•-12</title>
    <url>/2020/05/19/python%E8%AF%BE%E7%A8%8B%E8%AE%B0%E5%BD%95-12/</url>
    <content><![CDATA[<p>è¿™ä¸€è¯¾è®²Pandasåº“ã€‚</p>
<p><code>import pandas as pd</code></p>
<a id="more"></a>

<h2 id="Pandasåˆæ¢"><a href="#Pandasåˆæ¢" class="headerlink" title="Pandasåˆæ¢"></a>Pandasåˆæ¢</h2><ol>
<li>è¯»å–æ–‡ä»¶ï¼š<code>data = pd.read_excel(filename, index_col=0)</code></li>
<li>å–å‡ºæ•°æ®ä¸­çš„ä¸€åˆ—æˆ–ä¸€è¡Œï¼š<code>data[&#39;å­¦å·&#39;], data.loc[1]</code></li>
</ol>
<h2 id="Pandasæ•°æ®ç±»å‹"><a href="#Pandasæ•°æ®ç±»å‹" class="headerlink" title="Pandasæ•°æ®ç±»å‹"></a>Pandasæ•°æ®ç±»å‹</h2><h3 id="Series-ä¸€ç»´åºåˆ—"><a href="#Series-ä¸€ç»´åºåˆ—" class="headerlink" title="Series(ä¸€ç»´åºåˆ—)"></a>Series(ä¸€ç»´åºåˆ—)</h3><ol>
<li><p>ç”±index+valueç»„æˆ</p>
</li>
<li><p>é€šè¿‡åˆ—è¡¨åˆ›å»ºSeriesï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = pd.Series([<span class="string">'apple'</span>,<span class="string">'peach'</span>])</span><br><span class="line"><span class="comment"># 0	apple</span></span><br><span class="line"><span class="comment"># 1	peach</span></span><br><span class="line">a.index</span><br><span class="line"><span class="comment"># RangeIndex(start=0,stop=2,step=1)</span></span><br><span class="line">a.values</span><br><span class="line"><span class="comment"># array(['apple','peach'],dtype=object)</span></span><br><span class="line">a[<span class="number">1</span>]</span><br><span class="line"><span class="comment"># 'peach'</span></span><br><span class="line">a[<span class="number">1</span>]=<span class="number">100</span></span><br><span class="line"><span class="comment"># åŸæ¥æ˜¯peachçš„åœ°æ–¹æ”¹æˆäº†100</span></span><br><span class="line">a[<span class="number">0</span>:]</span><br><span class="line"><span class="comment"># æ•´ä¸ªè¾“å‡º</span></span><br><span class="line">a[[<span class="number">0</span>,<span class="number">1</span>]]</span><br><span class="line"><span class="comment"># è¾“å‡º0å’Œ1</span></span><br><span class="line">a = pd.Series([<span class="string">'apple'</span>,<span class="string">'peach'</span>],index=[<span class="string">'a'</span>,<span class="string">'p'</span>])</span><br><span class="line"><span class="comment"># a    apple</span></span><br><span class="line"><span class="comment"># p    peach</span></span><br><span class="line">a[<span class="string">'a'</span>]</span><br><span class="line"><span class="comment"># è¾“å‡ºç´¢å¼•aå¯¹åº”çš„value</span></span><br><span class="line">a[<span class="string">'a'</span>]=<span class="string">'lemon'</span></span><br><span class="line"><span class="comment"># åŸæ¥çš„appleæ”¹æˆlemon</span></span><br><span class="line">a[<span class="string">'a'</span>:]</span><br><span class="line"><span class="comment"># æ•´ä¸ªè¾“å‡º</span></span><br><span class="line">a[[<span class="string">'a'</span>,<span class="string">'p'</span>]]</span><br><span class="line"><span class="comment"># è¾“å‡ºaå’Œpå¯¹åº”çš„value</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>é€šè¿‡å­—å…¸åˆ›å»ºSeriesï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">d = &#123;<span class="string">'Japan'</span>:<span class="string">'Tokyo'</span>,<span class="string">'S.Korea'</span>:<span class="string">'Seoul'</span>,<span class="string">'China'</span>:<span class="string">'Beijing'</span>&#125;</span><br><span class="line">a = pd.Series(d)</span><br><span class="line"><span class="comment"># Japan        Tokyo</span></span><br><span class="line"><span class="comment"># S.Korea      Seoul</span></span><br><span class="line"><span class="comment"># China      Beijing</span></span><br><span class="line"></span><br><span class="line">indexL=[<span class="string">'China'</span>,<span class="string">'Japan'</span>,<span class="string">'ingapore'</span>,<span class="string">'S.Korea'</span>]</span><br><span class="line">a = pd.Series(d, index=indexL)</span><br><span class="line"><span class="comment"># China       Beijing</span></span><br><span class="line"><span class="comment"># Japan         Tokyo</span></span><br><span class="line"><span class="comment"># ingapore        NaN</span></span><br><span class="line"><span class="comment"># S.Korea       Seoul</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>é€šè¿‡æ ‡é‡åˆ›å»ºSeriesï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = pd.Series(<span class="string">'æ— '</span>)</span><br><span class="line"><span class="comment"># 0    æ— </span></span><br><span class="line">a = pd.Series(<span class="string">'æ— '</span>,index=np.arange(<span class="number">1</span>,<span class="number">6</span>))</span><br><span class="line"><span class="comment"># 1    æ— </span></span><br><span class="line"><span class="comment"># 2    æ— </span></span><br><span class="line"><span class="comment"># 3    æ— </span></span><br><span class="line"><span class="comment"># 4    æ— </span></span><br><span class="line"><span class="comment"># 5    æ— </span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Seriesçš„åŸºæœ¬è¿ç®—ï¼š</p>
<ol>
<li>å’Œnumpyä¸€æ ·ï¼Œè¿‡æ»¤ã€å¹¿æ’­ã€ufuncç­‰</li>
<li>å¯¹é½ï¼šå¯¹åº”ç´¢å¼•è¿›è¡Œè¿ç®—</li>
<li>é¢‘æ•°ç»Ÿè®¡ï¼švalue_counts()</li>
</ol>
</li>
</ol>
<h3 id="DataFrame-äºŒç»´è¡¨"><a href="#DataFrame-äºŒç»´è¡¨" class="headerlink" title="DataFrame(äºŒç»´è¡¨)"></a>DataFrame(äºŒç»´è¡¨)</h3><ol>
<li><p>å…±ç”¨indexçš„Seriesçš„æœ‰åºé›†åˆ</p>
</li>
<li><p>ä»äºŒç»´æ•°ç»„åˆ›å»ºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = np.array([(<span class="string">'Japan'</span>,<span class="string">'Tokyo'</span>,<span class="number">4000</span>),(<span class="string">'S.Korea'</span>,<span class="string">'Seoul'</span>,<span class="number">1300</span>),(<span class="string">'China'</span>,<span class="string">'Beijing'</span>,<span class="number">9100</span>)])</span><br><span class="line">DF1 = pd.DataFrame(data, columns=[<span class="string">'nation'</span>,<span class="string">'capital'</span>,<span class="string">'GDP'</span>],index=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>])</span><br></pre></td></tr></table></figure>
</li>
<li><p>æŸ¥çœ‹ç´¢å¼•å’Œæ•°æ®</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">DF1.index</span><br><span class="line">DF1.columns</span><br><span class="line">DF1.values</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä»å­—å…¸åˆ›å»ºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">dct = &#123;<span class="string">'nation'</span>:[<span class="string">'Japan'</span>,<span class="string">'S.Korea'</span>,<span class="string">'Japan'</span>],<span class="string">'capital'</span>:pd.Series([<span class="string">'Tokyo'</span>,<span class="string">'Seoul'</span>,<span class="string">'Beijing'</span>],index=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>]),<span class="string">'GDP'</span>:np.array([<span class="number">4900.1300</span><span class="number">.9100</span>],dtype=int)&#125;</span><br><span class="line">DF2=pd.DataFrame(dct)</span><br></pre></td></tr></table></figure>
</li>
<li><p>æŠŠæŸåˆ—æ•°æ®ä½œä¸ºindexï¼š<code>DF2.set_index(&#39;nation&#39;)</code></p>
</li>
<li><p>ä¿®æ”¹index/columnsï¼š<code>DF2.reindex(index=[&#39;c&#39;,&#39;a&#39;,&#39;b&#39;,&#39;d&#39;])</code></p>
</li>
<li><p>æ•°æ®é€‰æ‹©ï¼š</p>
<ol>
<li>å–å¤´å°¾è‹¥å¹²è¡Œï¼š<code>df.head(è¡Œæ•°), df.tail(è¡Œæ•°)</code></li>
<li>é€‰æ‹©ä¸€åˆ—ï¼š<code>DF2.nation, DF2[&#39;GDP&#39;]</code></li>
<li>é€‰æ‹©ä¸€è¡Œæˆ–å¤šè¡Œï¼š<code>DF2[0:2], DF2[&#39;a&#39;:&#39;c&#39;]</code>    åºå·åªèƒ½æ˜¯åˆ‡ç‰‡ï¼Œä¸èƒ½æ˜¯ä¸‹æ ‡</li>
<li><code>loc[index, columns]</code>æ ¹æ®ç´¢å¼•å¯¹å¤šä¸ªè½´è¿›è¡Œé€‰å–</li>
<li>å–å•ä¸ªæ•°æ®ï¼š<code>DF2.loc[&#39;c&#39;,&#39;GDP&#39;]</code>æˆ–<code>DF2.at[&#39;c&#39;,&#39;GDP&#39;]</code></li>
<li>å¸ƒå°”ç´¢å¼•ï¼š<ol>
<li>ç”¨æŸåˆ—çš„å€¼æ¥é€‰å–æ•°æ®ï¼š<code>DF2[DF2.GDP&gt;3000]</code></li>
<li><code>isin()</code>æ–¹æ³•è¿‡æ»¤æ•°æ®ï¼š<code>DF2[DF2.nation.isin([&#39;China&#39;,&#39;S.Korea&#39;])]</code></li>
</ol>
</li>
</ol>
</li>
<li><p>å¢åŠ ä¸€åˆ—ï¼š<code>DF2[&#39;population&#39;]=[130,55,1600]</code></p>
</li>
<li><p>å¢åŠ è¡Œï¼š<code>append(è¦æ·»åŠ çš„è¡Œ)</code>ï¼Œåºå·æ˜¯æ·»åŠ è¡Œçš„nameï¼Œå¦‚æœåŠ å…¥å‚æ•°ignore_index=Trueï¼Œåˆ™åºå·å°±æ˜¯æ•°å­—</p>
</li>
<li><p>åˆ é™¤è¡Œåˆ—ï¼š<code>drop(åºå·)</code>ï¼Œæ ¹æ®ç´¢å¼•åˆ é™¤è¡Œåˆ—ï¼Œé»˜è®¤åˆ è¡Œï¼Œaxis=1æ˜¯åˆ åˆ—</p>
</li>
<li><p>å¤šä¸ªDataFrameå¯¹è±¡æ•°æ®æ‹¼æ¥ï¼š</p>
<ol>
<li><code>pd.concat([p1,p2])</code>ï¼Œåºå·æ˜¯p1å’Œp2å„è‡ªçš„åºå·ç›´æ¥æ‹¼èµ·æ¥ï¼Œæ˜¯å‰å‡ è¡Œp1ï¼Œåå‡ è¡Œp2ï¼›å¢åŠ å‚æ•°ignore_index=Trueï¼Œåˆ™åºå·æ˜¯0ã€1ã€2ã€3è¿™æ ·ï¼›å¢åŠ å‚æ•°axis=1ï¼Œåˆ™æ˜¯å‰å‡ åˆ—p1ï¼Œåå‡ åˆ—p2ã€‚</li>
<li><code>pd.merge(p1,p3,on=&#39;name&#39;)</code>ï¼ŒæŠŠp1å’Œp3ä¸­nameåˆ—ç›¸åŒçš„éƒ¨åˆ†èåˆèµ·æ¥ï¼Œå¦‚æœæ˜¯è¦æŠŠæ‰€æœ‰nameéƒ½ç•™ä¸‹ï¼Œä½†æ˜¯åªè¦ä¸€åˆ—nameï¼Œåˆ™å¢åŠ å‚æ•°<code>how=&#39;outer&#39;</code></li>
</ol>
</li>
<li><p>ç¼ºå¤±å€¼å¤„ç†ï¼š</p>
<ol>
<li><code>isnull()</code>å’Œ<code>notnull()</code>ï¼šæ˜¯å¦ç¼ºå¤±</li>
<li><code>fillna()</code>ï¼šè¡¥å……ç¼ºå¤±å€¼</li>
<li><code>dropna()</code>ï¼šåˆ é™¤åŒ…å«ç¼ºå¤±å€¼çš„è¡Œæˆ–åˆ—</li>
</ol>
</li>
<li><p>åŸºæœ¬è¿ç®—ï¼š<code>sub,add,mul,div,sum,min,max,mean,std,describe</code>ï¼Œé»˜è®¤æ˜¯ç«–ç€è¿ç®—ï¼ŒåŠ axis=1å˜æˆæ¨ªç€è¿ç®—</p>
</li>
<li><p>åˆ†ç»„ï¼š<code>groupby()</code>ã€<code>get_group(åˆ—å)</code>ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œä¸Šä¸€æ¡çš„åŸºæœ¬è¿ç®—</p>
</li>
<li><p>æ’åºï¼š<code>sort_value(by=&#39;&#39;, ascending=False)</code> æ ¹æ®byçš„å–å€¼æ’åºï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²<code>by=&#39;æˆç»©&#39;</code>ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªå­—ç¬¦ä¸²çš„åˆ—è¡¨ï¼Œ<code>by=[&#39;æˆç»©&#39;,&#39;å¹´çº§&#39;]</code></p>
</li>
</ol>
<h2 id="æ–‡ä»¶è¯»å†™"><a href="#æ–‡ä»¶è¯»å†™" class="headerlink" title="æ–‡ä»¶è¯»å†™"></a>æ–‡ä»¶è¯»å†™</h2><h3 id="csv"><a href="#csv" class="headerlink" title="csv"></a>csv</h3><ol>
<li><code>read_csv()/to_csv()</code>è¯»å†™csvå’Œtxt</li>
<li>åŠ å…¥å‚æ•°index_col=0å¯ä»¥æ²¡æœ‰åºå·</li>
</ol>
<h3 id="excel"><a href="#excel" class="headerlink" title="excel"></a>excel</h3><ol>
<li><p><code>read_excel()/to_excel()</code>è¯»å†™excel</p>
</li>
<li><p>æŠŠå‡ ä¸ªdataframeå†™åˆ°ä¸€ä¸ªexcelæ–‡ä»¶é‡Œçš„ä¸åŒsheetä¸­ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">writer=pd.ExcelWriter(<span class="string">'atest.xlsx'</span>)</span><br><span class="line">a.to_excel(writer, sheet_name=<span class="string">'Sheet1'</span>)</span><br><span class="line">b.to_excel(writer, sheet_name=<span class="string">'Sheet2'</span>)</span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line"><span class="keyword">with</span> pd.ExcelWriter(<span class="string">'atest.xlsx'</span>) <span class="keyword">as</span> writer:</span><br><span class="line">    a.to_excel(writer, sheet_name=<span class="string">'Sheet1'</span>)</span><br><span class="line">	b.to_excel(writer, sheet_name=<span class="string">'Sheet2'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>è¯»å–ä¸€ä¸ªexceé‡Œçš„å¤šä¸ªsheet</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">reader = pd.ExcelWriter(<span class="string">'atest.xlsx'</span>)</span><br><span class="line">df1 = pd.read_excel(reader, <span class="string">'Sheet1'</span>)</span><br><span class="line">df2 = pd.read_excel(reader, <span class="string">'Sheet2'</span>)</span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line"><span class="keyword">with</span> pd.ExcelWriter(<span class="string">'atest.xlsx'</span>) <span class="keyword">as</span> reader:</span><br><span class="line">    df1 = pd.read_excel(reader, <span class="string">'Sheet1'</span>)</span><br><span class="line">	df2 = pd.read_excel(reader, <span class="string">'Sheet2'</span>)</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="ç»˜å›¾"><a href="#ç»˜å›¾" class="headerlink" title="ç»˜å›¾"></a>ç»˜å›¾</h2><ol>
<li>matplotlibä¸­çš„pyplotæ¨¡å—ï¼š<code>b.plot()</code>ï¼Œè¡¨æ ¼ä¸­çš„ä¸€åˆ—ä»£è¡¨ä¸€æ¡çº¿çš„æ•°æ®ï¼Œè¡Œåæ˜¯æ¨ªåæ ‡ï¼Œè¡¨æ ¼å†…å®¹å€¼æ˜¯çºµåæ ‡ï¼Œé»˜è®¤æ˜¯æŠ˜çº¿å›¾</li>
<li>æŸ±çŠ¶å›¾ï¼š<code>b.plot(kind=&#39;bar&#39;)      b.plot.bar()</code></li>
</ol>
<h2 id="éšå ‚ç»ƒä¹ "><a href="#éšå ‚ç»ƒä¹ " class="headerlink" title="éšå ‚ç»ƒä¹ "></a>éšå ‚ç»ƒä¹ </h2><p> è¯»å…¥ç¬¬ä¸‰æ¬¡ä½œä¸šç¬¬ä¸€éƒ¨åˆ†çˆ¬è™«å¾—åˆ°çš„ csvæ–‡ä»¶ï¼Œä¹‹åï¼š</p>
<ol>
<li>ç»˜åˆ¶æµè§ˆæ¬¡æ•°æ›²çº¿å›¾ï¼›</li>
<li>æ ¹æ®æµè§ˆæ¬¡æ•°è¿›è¡Œé™åºæ’åºï¼Œå¹¶æ‰“å°å‰10ç¯‡æŠ¥é“çš„æ—¥æœŸã€æ ‡é¢˜ï¼› </li>
<li>æ±‚æµè§ˆæ¬¡æ•°ä¸º1çš„æŠ¥é“çš„é“¾æ¥å¹¶æ‰“å°ç»“æœï¼›</li>
<li>ç»Ÿè®¡æ¯ä¸€å¹´çš„æŠ¥é“æ•°é‡ï¼Œä»¥åŠæ¯ä¸€å¹´çš„æ€»çš„æµè§ˆæ¬¡æ•°ï¼Œå¹¶åˆ†åˆ«ä»¥ æŸ±çŠ¶å›¾çš„å½¢å¼ç»˜åˆ¶å‡ºæ¥ï¼›</li>
<li>ç»Ÿè®¡2019å¹´æ¯ä¸ªæœˆçš„æŠ¥é“æ•°é‡å¹¶ä»¥é¥¼å›¾çš„å½¢å¼ç»˜åˆ¶å‡ºæ¥ã€‚</li>
</ol>
<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><ol>
<li><p>é¦–å…ˆåŠ è½½åº“æ–‡ä»¶ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ¥ä¸‹æ¥è¯»å–csvæ–‡ä»¶ï¼Œè€ƒè™‘åˆ°åé¢çš„å‡ é¡¹è¦æ±‚ï¼ŒæŠŠæ—¥æœŸä½œä¸ºDatetimeIndexçš„ç´¢å¼•æ¯”è¾ƒå¥½ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">reports = pd.read_csv(<span class="string">'reportsInfo.csv'</span>, header=<span class="number">0</span>, index_col=<span class="number">0</span>, parse_dates=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¬¬ä¸€ä¸ªè¦æ±‚æ˜¯ç»˜åˆ¶æµè§ˆæ¬¡æ•°çš„æŠ˜çº¿å›¾ï¼Œå› ä¸ºåŸæœ¬çš„csvæ–‡ä»¶æ—¶é—´æ˜¯å…ˆ2020å¹´å†2019å¹´ç„¶å2018å¹´è¿™æ ·å€’ç€æ¥çš„ï¼Œæ‰€ä»¥å…ˆé‡æ–°æ’åºï¼Œå†å–æµè§ˆæ¬¡æ•°é‚£ä¸€åˆ—çš„æ•°å€¼æ¥ç”»å›¾ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">reports.sort_index()[<span class="string">'æµè§ˆæ¬¡æ•°'</span>].plot(linestyle=<span class="string">'-'</span>, linewidth=<span class="number">2</span>, color=<span class="string">'steelblue'</span>)</span><br><span class="line">plt.title(<span class="string">'æµè§ˆæ¬¡æ•°æŠ˜çº¿å›¾'</span>, fontproperties=<span class="string">'Kaiti'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'æ—¥æœŸ'</span>, fontproperties=<span class="string">'Kaiti'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'æµè§ˆæ¬¡æ•°'</span>, fontproperties=<span class="string">'Kaiti'</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.savefig(<span class="string">'reports_linechart'</span>, dpi=<span class="number">300</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ ¹æ®æµè§ˆæ¬¡æ•°é™åºæ’åºçš„æ“ä½œå’Œä¸Šä¸€æ­¥ç´¢å¼•æ’åºå·®ä¸å¤šï¼Œç„¶ååˆ‡ç‰‡å–å‰10ï¼Œç”¨locå®šä½åˆ°æ ‡é¢˜é‚£ä¸€åˆ—ï¼Œè¾“å‡ºå³å¯ï¼š</p>
<p><code>print(reports.sort_values(by=&#39;æµè§ˆæ¬¡æ•°&#39;, ascending=False)[0:10].loc[:, [&#39;æ ‡é¢˜&#39;]])</code></p>
</li>
<li><p>ç­›é€‰æµè§ˆæ¬¡æ•°ä¸º1çš„é“¾æ¥ï¼Œç”¨ä¸‹æ ‡çš„æ–¹å¼æ‰¾å³å¯ï¼š</p>
<p><code>print(reports[reports.æµè§ˆæ¬¡æ•° == 1].é“¾æ¥)</code></p>
</li>
<li><p>ç»Ÿè®¡æ¯å¹´çš„æŠ¥é“æ•°é‡ï¼Œéœ€è¦å…ˆæŒ‰å¹´æ¥åˆ†ç»„ï¼Œç„¶åå¾—åˆ°åˆ†ç»„çš„sizeï¼Œå¯¹sizeç”»å›¾å³å¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">reports_group = reports.groupby(reports.index.year)</span><br><span class="line">reports_group.size().plot.bar()</span><br><span class="line">plt.title(<span class="string">'å¹´æŠ¥é“æ•°é‡æŸ±çŠ¶å›¾'</span>, fontproperties=<span class="string">'Kaiti'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'å¹´ä»½'</span>, fontproperties=<span class="string">'Kaiti'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'æŠ¥é“æ•°é‡'</span>, fontproperties=<span class="string">'Kaiti'</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.xticks(rotation=<span class="number">0</span>)</span><br><span class="line">plt.savefig(<span class="string">'reports_bar_1'</span>, dpi=<span class="number">300</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç»Ÿè®¡æ¯å¹´çš„æ€»æµè§ˆæ¬¡æ•°ï¼Œåœ¨ä¸Šä¸€æ¡åˆ†ç»„çš„åŸºç¡€ä¸Šå¯¹æµè§ˆæ¬¡æ•°é‚£ä¸€åˆ—æ±‚å’Œï¼Œç„¶åç”»å›¾å³å¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">reports_group[<span class="string">'æµè§ˆæ¬¡æ•°'</span>].sum().plot.bar()</span><br><span class="line">plt.title(<span class="string">'å¹´æµè§ˆæ¬¡æ•°æŸ±çŠ¶å›¾'</span>, fontproperties=<span class="string">'Kaiti'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'å¹´ä»½'</span>, fontproperties=<span class="string">'Kaiti'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'æµè§ˆæ¬¡æ•°'</span>, fontproperties=<span class="string">'Kaiti'</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.xticks(rotation=<span class="number">0</span>)</span><br><span class="line">plt.savefig(<span class="string">'reports_bar_2'</span>, dpi=<span class="number">300</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç»Ÿè®¡2019å¹´æ¯æœˆçš„æŠ¥é“æ•°é‡ï¼Œåœ¨ä¹‹å‰çš„åˆ†ç»„ä¸­å¯ä»¥å¾—åˆ°2019çš„åˆ†ç»„ï¼Œç„¶åå¯¹2019éƒ¨åˆ†å†æŒ‰æœˆæ¥åˆ†ç»„ï¼Œå¾—åˆ°sizeï¼Œå¯¹sizeç”»å›¾å³å¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">reports_2019 = reports_group.get_group(<span class="number">2019</span>)</span><br><span class="line">reports_2019_month = reports_2019.groupby(reports_2019.index.month).size()</span><br><span class="line">reports_2019_month.name = <span class="string">''</span></span><br><span class="line">reports_2019_month.plot.pie(startangle=<span class="number">90</span>)</span><br><span class="line">plt.title(<span class="string">'2019å¹´æ¯æœˆæŠ¥é“æ•°é‡é¥¼çŠ¶å›¾'</span>, fontproperties=<span class="string">'Kaiti'</span>)</span><br><span class="line">plt.savefig(<span class="string">'reports_pie'</span>, dpi=<span class="number">300</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>è¯¾ç¨‹ç¬”è®°</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>è®ºæ–‡è®°å½•-Dynamic Task Pricing in Multi-Requester Mobile Crowd Sensing with Markov Correlated Equilibrium</title>
    <url>/2020/05/14/%E8%AE%BA%E6%96%87%E8%AE%B0%E5%BD%95-Dynamic-Task-Pricing-in-Multi-Requester-Mobile-Crowd-Sensing-with-Markov-Correlated-Equilibrium/</url>
    <content><![CDATA[<h1 id="åŸºäºé©¬å°”å¯å¤«ç›¸å…³å‡è¡¡çš„å¤šå‘åŒ…æ–¹ç§»åŠ¨ç¾¤ä½“æ„ŸçŸ¥ä¸­çš„åŠ¨æ€ä»»åŠ¡å®šä»·"><a href="#åŸºäºé©¬å°”å¯å¤«ç›¸å…³å‡è¡¡çš„å¤šå‘åŒ…æ–¹ç§»åŠ¨ç¾¤ä½“æ„ŸçŸ¥ä¸­çš„åŠ¨æ€ä»»åŠ¡å®šä»·" class="headerlink" title="åŸºäºé©¬å°”å¯å¤«ç›¸å…³å‡è¡¡çš„å¤šå‘åŒ…æ–¹ç§»åŠ¨ç¾¤ä½“æ„ŸçŸ¥ä¸­çš„åŠ¨æ€ä»»åŠ¡å®šä»·"></a>åŸºäºé©¬å°”å¯å¤«ç›¸å…³å‡è¡¡çš„å¤šå‘åŒ…æ–¹ç§»åŠ¨ç¾¤ä½“æ„ŸçŸ¥ä¸­çš„åŠ¨æ€ä»»åŠ¡å®šä»·</h1><a id="more"></a>

<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><ol>
<li>åœºæ™¯ï¼šç§»åŠ¨ç¾¤æ™ºæ„ŸçŸ¥ï¼Œå¤šä¸ªå‘åŒ…æ–¹å…¬å¼€æ”¶é›†ç¾¤ä½“æ„ŸçŸ¥æ•°æ®ï¼Œå…¬å¼€å®šä»·æ¥å¸å¼•workers</li>
<li>é—®é¢˜ï¼š<ol>
<li>requestorä¹‹é—´æ˜¯ä¸å®Œæ•´ä¿¡æ¯åšå¼ˆ</li>
<li>åŠ¨æ€ç³»ç»Ÿä¸­æœªæ¥çš„ä¸ç¡®å®šæ€§ï¼šæœªæ¥ä¼šæœ‰å¤šå°‘workers</li>
</ol>
</li>
<li>è§£å†³æ–¹æ¡ˆï¼šåŠ¨æ€å®šä»·â€”&gt;Markovåšå¼ˆï¼Œé•¿æœŸç´¯ç§¯æ•ˆç”¨æœ€å¤§åŒ–ï¼Œè¿‘ä¼¼æœ€å°ç¤¾ä¼šæˆæœ¬</li>
</ol>
<h2 id="Preliminaries"><a href="#Preliminaries" class="headerlink" title="Preliminaries"></a>Preliminaries</h2><ol>
<li>Kä¸ªrequestorsï¼Œæ¯ä¸ªç”¨$r_i$è¡¨ç¤ºï¼Œé›†åˆæ˜¯R</li>
<li>$r_i$å‘å¸ƒ$N_i$ä¸ªä»»åŠ¡ï¼Œæ€»å…±æœ‰Wç§ç±»å‹ï¼Œæ¯ç§ç±»å‹çš„ä»»åŠ¡åªèƒ½ç”±å¯¹åº”ç±»å‹çš„workeræ¥å®Œæˆ</li>
<li>$N_{i,w}$è¡¨ç¤ºç¬¬iä¸ªrequestorå‘å¸ƒçš„wç±»å‹çš„ä»»åŠ¡æ•°é‡</li>
<li>$R_w$è¡¨ç¤ºå‘å¸ƒäº†wç±»å‹ä»»åŠ¡çš„requestors</li>
<li>$N_i$è¡¨ç¤ºæ‰€æœ‰åŒä¸€ä¸ªiçš„$N_{i,w}$ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªrequestorå‘å¸ƒçš„æ‰€æœ‰ä»»åŠ¡æ•°é‡</li>
<li>ä¸¤ç§åœºæ™¯ï¼š<ol>
<li>æ‰€æœ‰workersåŒæ—¶åˆ°è¾¾</li>
<li>workersåŠ¨æ€åˆ°è¾¾</li>
</ol>
</li>
</ol>
<p>è¿™ç¯‡æš‚æ—¶å…ˆä¸å¾€åçœ‹äº†ï¼Œå¸ˆå¼Ÿç»„ä¼šè®²è¿‡äº†</p>
]]></content>
      <categories>
        <category>è®ºæ–‡</category>
      </categories>
      <tags>
        <tag>game theory</tag>
        <tag>crowd sensing</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonè¯¾ç¨‹è®°å½•-11</title>
    <url>/2020/05/12/python%E8%AF%BE%E7%A8%8B%E8%AE%B0%E5%BD%95-11/</url>
    <content><![CDATA[<p>è¿™ä¸€è¯¾æ˜¯matplotlibç”»å›¾çš„ä»‹ç»ã€‚</p>
<p><code>import matplotlib.pyplot as plt</code></p>
<a id="more"></a>

<h2 id="åŸºç¡€ç»˜å›¾"><a href="#åŸºç¡€ç»˜å›¾" class="headerlink" title="åŸºç¡€ç»˜å›¾"></a>åŸºç¡€ç»˜å›¾</h2><ol>
<li><p><code>plt.plot([xåæ ‡],[yåæ ‡])</code>è®¾ç½®å›¾åƒåæ ‡</p>
<p>xåæ ‡å¦‚æœæ˜¯<code>[1,2,3,4]</code>è¿™æ ·è¿è´¯çš„ï¼Œå¯ä»¥çœç•¥ã€‚</p>
</li>
<li><p><code>plt.show()</code>æ˜¾ç¤ºå›¾åƒï¼Œ<code>plt.sacefig(&#39;æ–‡ä»¶å&#39;, dpi=300)</code>ä¿å­˜å›¾åƒä¸ºpngæ–‡ä»¶ã€‚</p>
</li>
<li><p>å¤šæ¡æ›²çº¿ï¼š<code>plt.plot(a,a,a,a*2,a,a**2)</code>ï¼Œ<code>a</code>æ˜¯numpyæ•°ç»„ã€‚</p>
</li>
</ol>
<h2 id="è®¾ç½®å›¾åƒå±æ€§"><a href="#è®¾ç½®å›¾åƒå±æ€§" class="headerlink" title="è®¾ç½®å›¾åƒå±æ€§"></a>è®¾ç½®å›¾åƒå±æ€§</h2><ol>
<li>é¢œè‰²å’Œçº¿å®½ï¼š<code>plt.plot(x, y, format_string, **kwargs)</code>ï¼Œå…¶ä¸­<code>format_string</code>è®¾å®šé¢œè‰²ã€é£æ ¼å’Œæ ‡è®°ã€‚</li>
<li>åæ ‡è½´èŒƒå›´ï¼š<ol>
<li>è·å–åæ ‡èŒƒå›´ï¼š<code>xlim(),ylim(),axis()</code></li>
<li>è®¾ç½®åæ ‡èŒƒå›´ï¼š<code>xlim(xmin,xmax), ylim(ymin,ymax), axis([xmin,xmax,ymin,ymax])</code></li>
</ol>
</li>
<li>è®¾ç½®åæ ‡è½´åˆ»åº¦ï¼š<code>plt.xticks(),plt.yticks(0</code>)</li>
<li>è®¾ç½®åæ ‡è½´æ ‡ç­¾å’Œå›¾çš„é¢˜ç›®ï¼š<code>xlabel(), ylabel(),title()</code></li>
<li>æ·»åŠ å›¾ä¾‹ï¼š<code>legend()</code></li>
<li>æ·»åŠ æ–‡å­—æ³¨é‡Šï¼š<code>text()</code></li>
<li>æ ‡æ³¨ï¼š<code>ax.annotate()</code></li>
<li>ç½‘æ ¼ï¼š<code>plt.grid(True)</code>ï¼Œå¯ä»¥è®¾ç½®é¢œè‰²ã€çº¿å‹ç­‰ç­‰</li>
</ol>
<h2 id="ä¸­æ–‡æ˜¾ç¤ºé—®é¢˜"><a href="#ä¸­æ–‡æ˜¾ç¤ºé—®é¢˜" class="headerlink" title="ä¸­æ–‡æ˜¾ç¤ºé—®é¢˜"></a>ä¸­æ–‡æ˜¾ç¤ºé—®é¢˜</h2><ol>
<li><code>rc_params()</code>æŒ‡å®šå­—ä½“ï¼š<code>matplotlib.rcParams[&#39;font.family&#39;]=&#39;STSong&#39;</code></li>
<li>åœ¨ç”¨åˆ°çš„åœ°æ–¹æŒ‡å®šå­—ä½“ï¼š<code>fontproperties=&#39;Kaiti&#39;</code></li>
</ol>
<h2 id="ç»˜åˆ¶å­å›¾"><a href="#ç»˜åˆ¶å­å›¾" class="headerlink" title="ç»˜åˆ¶å­å›¾"></a>ç»˜åˆ¶å­å›¾</h2><ol>
<li><code>subplot(numRows, numCols, plotNum)</code></li>
<li><code>subplot2grid(shape, loc, rowspan=1, colspan=1)</code></li>
<li><code>gridspec.GridSpec()</code>å’Œ<code>subplot()</code>ç»“åˆ</li>
</ol>
<h2 id="ç»˜åˆ¶å¤šä¸ªå›¾"><a href="#ç»˜åˆ¶å¤šä¸ªå›¾" class="headerlink" title="ç»˜åˆ¶å¤šä¸ªå›¾"></a>ç»˜åˆ¶å¤šä¸ªå›¾</h2><p><code>figure()</code></p>
<h2 id="å¸¸ç”¨å›¾æ ‡å‡½æ•°"><a href="#å¸¸ç”¨å›¾æ ‡å‡½æ•°" class="headerlink" title="å¸¸ç”¨å›¾æ ‡å‡½æ•°"></a>å¸¸ç”¨å›¾æ ‡å‡½æ•°</h2><ol>
<li>æ•£ç‚¹å›¾ï¼š<code>plt.scatter()</code></li>
<li>æŸ±çŠ¶å›¾ï¼š<code>plt.bar()</code></li>
<li>ç›´æ–¹å›¾ï¼š<code>plt.hist()</code></li>
<li>é¥¼å›¾ï¼š<code>plt.pie()</code></li>
<li>ç­‰å€¼çº¿å›¾ï¼š<code>plt.contour()</code></li>
<li>æåæ ‡å›¾ï¼š<code>plt.plot()</code></li>
<li>çŸ¢é‡åœºæµçº¿å›¾ï¼š<code>plt.streamplot()</code></li>
<li>ä¸‰ç»´ç»˜å›¾ï¼š<code>Axes3D(fig)</code>æˆ–è€…<code>fig.add_subplot()</code></li>
</ol>
<h2 id="è¯¾åä½œä¸š"><a href="#è¯¾åä½œä¸š" class="headerlink" title="è¯¾åä½œä¸š"></a>è¯¾åä½œä¸š</h2><p> IBM.csvå’ŒBABA.csvåˆ†åˆ«ä¿å­˜äº†IBMå’Œé˜¿é‡Œå·´å·´è‚¡ç¥¨ä¿¡æ¯ï¼Œè¯·è¯»å…¥å®ƒä»¬çš„æ—¥æœŸå’Œæ”¶ç›˜ä»·ï¼Œç»˜åˆ¶æ”¶ç›˜ä»·æ›²çº¿å›¾ï¼Œè¦æ±‚ï¼š</p>
<ol>
<li>è®¾ç½®æ¨ªåæ ‡å’Œçºµåæ ‡è½´æ ‡ç­¾ã€å›¾çš„é¢˜ç›®ï¼Œå¦å¤–æ¨ªåæ ‡è½´åˆ»åº¦æ ‡ç­¾ä¸ºæ—¥æœŸï¼›</li>
<li>å¯¹æ¯ä¸€æ”¯è‚¡ç¥¨æ±‚æœ€é«˜æ”¶ç›˜ä»·å’Œæœ€ä½æ”¶ç›˜ä»·ï¼Œå¹¶åœ¨æ›²çº¿ä¸Šå¯¹è¿™ä¸¤ä¸ªç‚¹è¿›è¡Œæ ‡æ³¨ã€‚</li>
</ol>
<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><ol>
<li><p>å¯¼å…¥æ‰€éœ€åº“æ–‡ä»¶ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib.ticker <span class="keyword">as</span> ticker</span><br></pre></td></tr></table></figure>
</li>
<li><p>é¦–å…ˆæ˜¯è¯»å…¥csvæ–‡ä»¶ï¼Œå› ä¸ºæ—¥æœŸæ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¿™é‡Œå…ˆç»Ÿä¸€ç”¨å­—ç¬¦ä¸²çš„æ ¼å¼è¯»å…¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ibm = np.loadtxt(<span class="string">"IBM.csv"</span>, dtype=np.str, delimiter=<span class="string">','</span>)</span><br><span class="line">baba = np.loadtxt(<span class="string">"BABA.csv"</span>, dtype=np.str, delimiter=<span class="string">','</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ¥ä¸‹æ¥æå–æ‰€éœ€æ•°æ®ï¼šæ—¥æœŸã€æ”¶ç›˜ä»·ã€æœ€é«˜å’Œæœ€ä½æ”¶ç›˜ä»·ï¼Œè¿™é‡Œä½¿ç”¨<code>astype()</code>æŠŠæ”¶ç›˜ä»·ä»numpyå­—ç¬¦ä¸²è½¬ä¸ºnumpyæµ®ç‚¹æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># IBM</span></span><br><span class="line">date_ibm = ibm[<span class="number">1</span>:, <span class="number">0</span>]</span><br><span class="line">close_ibm = ibm[<span class="number">1</span>:, <span class="number">4</span>].astype(np.float)</span><br><span class="line">close_ibm_u = close_ibm.max()</span><br><span class="line">date_ibm_u = date_ibm[np.where(close_ibm == close_ibm_u)]</span><br><span class="line">close_ibm_l = close_ibm.min()</span><br><span class="line">date_ibm_l = date_ibm[np.where(close_ibm == close_ibm_l)]</span><br><span class="line"><span class="comment"># BABA</span></span><br><span class="line">date_baba = baba[<span class="number">1</span>:, <span class="number">0</span>]</span><br><span class="line">close_baba = baba[<span class="number">1</span>:, <span class="number">4</span>].astype(np.float)</span><br><span class="line">close_baba_u = close_baba.max()</span><br><span class="line">date_baba_u = date_baba[np.where(close_baba == close_baba_u)]</span><br><span class="line">close_baba_l = close_baba.min()</span><br><span class="line">date_baba_l = date_baba[np.where(close_baba == close_baba_l)]</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¾—åˆ°æ•°æ®ä»¥åå°±å¼€å§‹ç”»å›¾ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç”»æ›²çº¿</span></span><br><span class="line">plt.plot(date_ibm, close_ibm, color=<span class="string">"green"</span>, linewidth=<span class="number">0.5</span>, label=<span class="string">'IBM'</span>)</span><br><span class="line">plt.plot(date_baba, close_baba, color=<span class="string">"blue"</span>, linewidth=<span class="number">0.5</span>, label=<span class="string">'BABA'</span>)</span><br><span class="line"><span class="comment"># è®¾ç½®xè½´å¯†åº¦å’Œåˆ»åº¦å¤§å°æ–¹å‘</span></span><br><span class="line">plt.gca().xaxis.set_major_locator(ticker.MultipleLocator(<span class="number">80</span>))</span><br><span class="line">plt.xticks(rotation=<span class="number">45</span>, size=<span class="number">6</span>)</span><br><span class="line"><span class="comment"># è®¾ç½®æ ‡é¢˜å’Œè½´æ ‡ç­¾å†…å®¹åŠå­—ä½“</span></span><br><span class="line">plt.title(<span class="string">'2014å¹´ä»¥æ¥IBMå’ŒBABAè‚¡ç¥¨æ”¶ç›˜ä»·éšæ—¥æœŸçš„å˜æ¢'</span>, fontproperties=<span class="string">'Kaiti'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'æ—¥æœŸ'</span>, fontproperties=<span class="string">'Kaiti'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'æ”¶ç›˜ä»·'</span>, fontproperties=<span class="string">'Kaiti'</span>)</span><br><span class="line"><span class="comment"># è®¾ç½®å›¾ä¾‹ä½ç½®</span></span><br><span class="line">plt.legend(loc=<span class="string">'upper center'</span>)</span><br><span class="line"><span class="comment"># åœ¨å››ä¸ªæœ€é«˜æœ€ä½ç‚¹åŠ åœ†åœˆæ ‡è®°</span></span><br><span class="line">plt.plot(date_ibm_u,close_ibm_u,<span class="string">'ro'</span>,markersize=<span class="number">3</span>)</span><br><span class="line">plt.plot(date_ibm_l,close_ibm_l,<span class="string">'ro'</span>,markersize=<span class="number">3</span>)</span><br><span class="line">plt.plot(date_baba_u,close_baba_u,<span class="string">'ro'</span>,markersize=<span class="number">3</span>)</span><br><span class="line">plt.plot(date_baba_l,close_baba_l,<span class="string">'ro'</span>,markersize=<span class="number">3</span>)</span><br><span class="line"><span class="comment"># ç»™å››ä¸ªæœ€é«˜æœ€ä½ç‚¹åŠ æ–‡å­—è¯´æ˜</span></span><br><span class="line">plt.annotate(<span class="string">r'æœ€é«˜'</span>+str(close_ibm_u),color=<span class="string">'r'</span>,xy=(date_ibm_u,close_ibm_u),xytext=(<span class="number">-17</span>,<span class="number">15</span>),textcoords=<span class="string">'offset points'</span>,fontproperties=<span class="string">'Kaiti'</span>,fontsize=<span class="number">5</span>,arrowprops=&#123;<span class="string">'arrowstyle'</span>:<span class="string">'-&gt;'</span>,<span class="string">'color'</span>:<span class="string">'r'</span>&#125;)</span><br><span class="line">plt.annotate(<span class="string">r'æœ€ä½'</span>+str(close_ibm_l),color=<span class="string">'r'</span>,xy=(date_ibm_l,close_ibm_l),xytext=(<span class="number">-17</span>,<span class="number">-15</span>),textcoords=<span class="string">'offset points'</span>,fontproperties=<span class="string">'Kaiti'</span>,fontsize=<span class="number">5</span>,arrowprops=&#123;<span class="string">'arrowstyle'</span>:<span class="string">'-&gt;'</span>,<span class="string">'color'</span>:<span class="string">'r'</span>&#125;)</span><br><span class="line">plt.annotate(<span class="string">r'æœ€é«˜'</span>+str(close_baba_u),color=<span class="string">'r'</span>,xy=(date_baba_u,close_baba_u),xytext=(<span class="number">-50</span>,<span class="number">6</span>),textcoords=<span class="string">'offset points'</span>,fontproperties=<span class="string">'Kaiti'</span>,fontsize=<span class="number">5</span>,arrowprops=&#123;<span class="string">'arrowstyle'</span>:<span class="string">'-&gt;'</span>,<span class="string">'color'</span>:<span class="string">'r'</span>&#125;)</span><br><span class="line">plt.annotate(<span class="string">r'æœ€ä½'</span>+str(close_baba_l),color=<span class="string">'r'</span>,xy=(date_baba_l,close_baba_l),xytext=(<span class="number">-50</span>,<span class="number">-6</span>),textcoords=<span class="string">'offset points'</span>,fontproperties=<span class="string">'Kaiti'</span>,fontsize=<span class="number">5</span>,arrowprops=&#123;<span class="string">'arrowstyle'</span>:<span class="string">'-&gt;'</span>,<span class="string">'color'</span>:<span class="string">'r'</span>&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>æœ€åæ˜¾ç¤ºå’Œä¿å­˜å›¾åƒï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.tight_layout()</span><br><span class="line">plt.savefig(<span class="string">'homework'</span>, dpi=<span class="number">300</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼šåœ¨ä¸€å¼€å§‹çš„æ—¶å€™å¯ä»¥è®¾ç½®å›¾åƒå°ºå¯¸ï¼š<code>plt.figure(figsize=(1080/100,520/100),dpi=100)</code></p>
</li>
</ol>
]]></content>
      <categories>
        <category>è¯¾ç¨‹ç¬”è®°</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonè¯¾ç¨‹è®°å½•-10</title>
    <url>/2020/04/29/python%E8%AF%BE%E7%A8%8B%E8%AE%B0%E5%BD%95-10/</url>
    <content><![CDATA[<p>è¿™ä¸€è¯¾æ˜¯numpyåº“ã€‚</p>
<p><code>import numpy as py</code></p>
<a id="more"></a>

<h2 id="åˆ›å»ºæ•°ç»„åŸºæœ¬æ–¹æ³•ï¼š"><a href="#åˆ›å»ºæ•°ç»„åŸºæœ¬æ–¹æ³•ï¼š" class="headerlink" title="åˆ›å»ºæ•°ç»„åŸºæœ¬æ–¹æ³•ï¼š"></a>åˆ›å»ºæ•°ç»„åŸºæœ¬æ–¹æ³•ï¼š</h2><ol>
<li><p><code>array()</code></p>
<p>pythonå¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„</p>
</li>
<li><p><code>empty()</code></p>
<p>åˆ†é…æŒ‡å®šå¤§å°æ•°ç»„ï¼Œä¸åˆå§‹åŒ–</p>
</li>
<li><p><code>zeros()</code>,<code>ones()</code></p>
<p>å»ºç«‹å…¨ä¸º0æˆ–1çš„æ•°ç»„</p>
</li>
<li><p><code>eye()</code>,<code>diag()</code></p>
<p>å»ºç«‹å¯¹è§’çŸ©é˜µ</p>
</li>
<li><p><code>arange()</code></p>
<p>åˆå€¼ã€ç»ˆå€¼ã€æ­¥é•¿å»ºç«‹ä¸€ç»´æ•°ç»„</p>
</li>
<li><p><code>linspace()</code></p>
<p>åˆå€¼ã€ç»ˆå€¼ã€å…ƒç´ ä¸ªæ•°å»ºç«‹ä¸€ç»´æ•°ç»„</p>
</li>
<li><p><code>logspace</code></p>
<p>åˆå€¼ã€ç»ˆå€¼ã€å…ƒç´ ä¸ªæ•°å»ºç«‹ç­‰æ¯”æ•°åˆ—</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a &#x3D; np.array((1,2,3,4))</span><br><span class="line">array([1, 2, 3, 4])</span><br><span class="line">b &#x3D; np.array([[1,2,3,4],[4,5,6,7],[7,8,9,10]])</span><br><span class="line">array([[ 1,  2,  3,  4],</span><br><span class="line">       [ 4,  5,  6,  7],</span><br><span class="line">       [ 7,  8,  9, 10]])		</span><br><span class="line">c &#x3D; a.tolist()</span><br><span class="line">[1,2,3,4]</span><br><span class="line">d &#x3D; np.empty((2,2))	#è¿™é‡Œæ•°ç»„ç»´æ•°å¿…é¡»æ˜¯æ˜¯å…ƒç»„</span><br><span class="line">array([[9.90263869e+067, 9.38159477e-312],</span><br><span class="line">       [0.00000000e+000, 9.38983138e-312]])       </span><br><span class="line">e &#x3D; np.ones((2,2))</span><br><span class="line">array([[1., 1.],</span><br><span class="line">       [1., 1.]])       </span><br><span class="line">f &#x3D; np.diag((2,3,4))</span><br><span class="line">array([[2, 0, 0],</span><br><span class="line">       [0, 3, 0],</span><br><span class="line">       [0, 0, 4]])       </span><br><span class="line">g &#x3D; np.eye(3)</span><br><span class="line">array([[1., 0., 0.],</span><br><span class="line">       [0., 1., 0.],</span><br><span class="line">       [0., 0., 1.]])       </span><br><span class="line">h &#x3D; np.eye(2,3)</span><br><span class="line">array([[1., 0., 0.],</span><br><span class="line">       [0., 1., 0.]])</span><br><span class="line">i &#x3D; np.arange(5,10,1)</span><br><span class="line">array([5, 6, 7, 8, 9])</span><br><span class="line">j &#x3D; np.linspace(5,10,4)</span><br><span class="line">array([ 5.        ,  6.66666667,  8.33333333, 10.        ])</span><br><span class="line">k &#x3D; np.logspace(0,1,5)</span><br><span class="line">array([ 1.        ,  1.77827941,  3.16227766,  5.62341325, 10.        ])</span><br></pre></td></tr></table></figure>

<h2 id="æ•°ç»„çš„åŸºæœ¬å±æ€§"><a href="#æ•°ç»„çš„åŸºæœ¬å±æ€§" class="headerlink" title="æ•°ç»„çš„åŸºæœ¬å±æ€§"></a>æ•°ç»„çš„åŸºæœ¬å±æ€§</h2><ol>
<li><code>ndim</code>ï¼šæ•°ç»„çš„ç»´åº¦ï¼Œä¹Ÿå°±æ˜¯æœ‰å‡ è¡Œ</li>
<li><code>shape</code>ï¼šæ•°ç»„æ¯ç»´å¤§å°ï¼Œå…ƒç»„å½¢å¼</li>
<li><code>size</code>ï¼šæ•°ç»„é‡Œä¸€å…±å¤šå°‘ä¸ªå…ƒç´ </li>
<li><code>dtype</code>ï¼šæ•°ç»„æ•°æ®ç±»å‹</li>
<li><code>itemsize</code>ï¼šå…ƒç´ å­—èŠ‚æ•°</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">d1 = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>])</span><br><span class="line">d2 = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]])</span><br><span class="line">d3 = np.array([[[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]],[[<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>],[<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>]]])</span><br><span class="line">print(d1.ndim, d2.ndim, d3.ndim)		<span class="comment"># 1 2 3</span></span><br><span class="line">print(d1.shape, d2.shape, d3.shape)		<span class="comment"># (6,) (2, 3) (2, 2, 3)</span></span><br></pre></td></tr></table></figure>

<h2 id="æ•°ç»„æ“ä½œ"><a href="#æ•°ç»„æ“ä½œ" class="headerlink" title="æ•°ç»„æ“ä½œ"></a>æ•°ç»„æ“ä½œ</h2><ol>
<li>æ”¹å˜æ•°æ®ç±»å‹ï¼šastype</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = np.array([<span class="number">1.7</span>, <span class="number">1.2</span>, <span class="number">1.6</span>])</span><br><span class="line">b = a.astype(int)		<span class="comment"># b = array([1, 1, 1])</span></span><br></pre></td></tr></table></figure>

<h3 id="å½¢çŠ¶æ“ä½œ"><a href="#å½¢çŠ¶æ“ä½œ" class="headerlink" title="å½¢çŠ¶æ“ä½œ"></a>å½¢çŠ¶æ“ä½œ</h3><ol>
<li><p>reshape</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">a = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>])</span><br><span class="line">b = a.reshape((<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line"><span class="comment"># b = array([[1, 2, 3],</span></span><br><span class="line"><span class="comment">#            [4, 5, 6]])</span></span><br><span class="line">a[<span class="number">0</span>]=<span class="number">10</span></span><br><span class="line"><span class="comment"># a = array([10,  2,  3,  4,  5,  6])</span></span><br><span class="line"><span class="comment"># b = array([[10, 2, 3],</span></span><br><span class="line"><span class="comment">#            [4, 5, 6]])</span></span><br><span class="line">b[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">5</span></span><br><span class="line"><span class="comment"># a = array([5,  2,  3,  4,  5,  6])</span></span><br><span class="line"><span class="comment"># b = array([[5, 2, 3],</span></span><br><span class="line"><span class="comment">#            [4, 5, 6]])</span></span><br><span class="line">c = b.reshape((<span class="number">-1</span>,<span class="number">2</span>))</span><br><span class="line"><span class="comment"># array([[5, 2],</span></span><br><span class="line"><span class="comment">#       [3, 4],</span></span><br><span class="line"><span class="comment">#       [5, 6]])</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>shapeï¼šå’Œreshapeå·®ä¸å¤šçš„ç”¨æ³•ï¼Œ<code>a.reshape((-1,2))</code>å’Œ<code>a.shape=(-1,2)</code>æ•ˆæœæ˜¯ä¸€æ ·çš„</p>
</li>
<li><p>resizeï¼šåŒä¸Šï¼Œ<code>a.resize((-1,2))</code>ï¼Œæ³¨æ„reshapeå’Œresizeçš„å‚æ•°æ˜¯å…ƒç»„ï¼Œè€Œshapeçš„å‚æ•°åˆ™ä¸æ˜¯å…ƒç»„ã€‚æ­¤å¤–ï¼Œä¸€èˆ¬æ¥è¯´reshapeæœ‰è¿”å›å€¼ï¼Œä¸å¯¹åŸå§‹å¤šç»´æ•°ç»„è¿›è¡Œä¿®æ”¹ï¼›resizeæ— è¿”å›å€¼ï¼Œä¼šå¯¹åŸå§‹å¤šç»´æ•°ç»„è¿›è¡Œä¿®æ”¹ã€‚ä½†å…¶å®resizeå’Œreshapeéƒ½å¯ä»¥æœ‰è¿”å›å€¼ï¼Œä¹Ÿéƒ½å¯ä»¥æ²¡æœ‰è¿”å›å€¼ï¼ŒåŒºåˆ«åœ¨äºï¼Œreshapeæ˜¯æ”¹å˜å½¢çŠ¶è€Œä¸æ”¹å˜æ•°æ®é‡ï¼Œæˆ–è€…è¯´æ”¹å˜æ•°ç»„ç»´åº¦ï¼Œå¦‚æœreshapeä¹‹åçš„å…ƒç´ æ•°é‡å’Œä¹‹å‰çš„ä¸ä¸€è‡´å°±ä¼šæŠ¥é”™ï¼Œä½†æ˜¯resizeä¸ä¼šï¼Œå…ƒç´ å¤šäº†å°±å»æ‰ï¼Œå°‘äº†å°±è¡¥é›¶ã€‚</p>
</li>
<li><p>ravelï¼šæ‰å¹³åŒ–ï¼Œå¤šç»´å˜æˆä¸€ç»´æ•°ç»„ï¼Œä½†æ˜¯ä¿®æ”¹ravelä¹‹åçš„å…ƒç´ ï¼Œ<strong>ä¼š</strong>å¯¼è‡´åŸå§‹æ•°ç»„çš„å…ƒç´ è·Ÿç€å˜ã€‚</p>
</li>
<li><p>flattenï¼šæ‰å¹³åŒ–ï¼Œå¤šç»´å˜æˆä¸€ç»´æ•°ç»„ï¼Œä¿®æ”¹flattenä¹‹åçš„å…ƒç´ ï¼Œ<strong>ä¸ä¼š</strong>å¯¼è‡´åŸå§‹æ•°ç»„çš„å…ƒç´ è·Ÿç€å˜ã€‚</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">a = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]])</span><br><span class="line">b = a.ravel()	<span class="comment"># b = ([1,2,3,4,5,6])</span></span><br><span class="line">b[<span class="number">0</span>]=<span class="number">99</span></span><br><span class="line"><span class="comment">#a = array([[99,  2,  3],</span></span><br><span class="line"><span class="comment">#           [ 4,  5,  6]])</span></span><br><span class="line">c = a.flatten()  <span class="comment"># c = ([99,  2,  3,  4,  5,  6])</span></span><br><span class="line">c[<span class="number">1</span>]=<span class="number">98</span></span><br><span class="line"><span class="comment">#a = array([[99,  2,  3],</span></span><br><span class="line"><span class="comment">#           [ 4,  5,  6]])</span></span><br></pre></td></tr></table></figure>

<ol start="6">
<li>è½¬ç½®ï¼š<code>æ•°ç»„.T</code></li>
</ol>
<h3 id="æ•°ç»„ç»„åˆ"><a href="#æ•°ç»„ç»„åˆ" class="headerlink" title="æ•°ç»„ç»„åˆ"></a>æ•°ç»„ç»„åˆ</h3><ol>
<li><p>hstackï¼šæ°´å¹³</p>
</li>
<li><p>vstackï¼šå‚ç›´</p>
</li>
<li><p>concatenate</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">a = np.array([[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]])</span><br><span class="line">b = np.array([[<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>],[<span class="number">6</span>,<span class="number">8</span>,<span class="number">10</span>]])</span><br><span class="line">c = np.hstack((a,b))</span><br><span class="line"><span class="comment"># [[ 0  1  2  0  2  4]</span></span><br><span class="line"><span class="comment">#  [ 3  4  5  6  8 10]]</span></span><br><span class="line">d = np.vstack((a,b))</span><br><span class="line"><span class="comment"># [[ 0  1  2]</span></span><br><span class="line"><span class="comment">#  [ 3  4  5]</span></span><br><span class="line"><span class="comment">#  [ 0  2  4]</span></span><br><span class="line"><span class="comment">#  [ 6  8 10]]</span></span><br><span class="line">e = np.concatenate((a,b),axis=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># [[ 0  1  2  0  2  4]</span></span><br><span class="line"><span class="comment">#  [ 3  4  5  6  8 10]]</span></span><br><span class="line">f = np.concatenate((a,b),axis=<span class="number">0</span>)</span><br><span class="line"><span class="comment"># [[ 0  1  2]</span></span><br><span class="line"><span class="comment">#  [ 3  4  5]</span></span><br><span class="line"><span class="comment">#  [ 0  2  4]</span></span><br><span class="line"><span class="comment">#  [ 6  8 10]]</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="æ•°ç»„åˆ†å‰²"><a href="#æ•°ç»„åˆ†å‰²" class="headerlink" title="æ•°ç»„åˆ†å‰²"></a>æ•°ç»„åˆ†å‰²</h3><ol>
<li>hsplitï¼šæ°´å¹³</li>
<li>vsplitï¼šå‚ç›´</li>
<li>split</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">a = np.array([[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]])</span><br><span class="line">a1, a2, a3 = np.hsplit(a,<span class="number">3</span>)</span><br><span class="line">b1, b2 = np.vsplit(a,<span class="number">2</span>)</span><br><span class="line">c1, c2 = np.split(a, <span class="number">2</span>, axis=<span class="number">0</span>)</span><br><span class="line"><span class="comment"># a1 = [[0]</span></span><br><span class="line"><span class="comment">#       [3]]</span></span><br><span class="line"><span class="comment"># a2 = [[1]</span></span><br><span class="line"><span class="comment">#       [4]]</span></span><br><span class="line"><span class="comment"># a3 = [[2]</span></span><br><span class="line"><span class="comment">#       [5]]</span></span><br><span class="line"><span class="comment"># b1 = [[0 1 2]]</span></span><br><span class="line"><span class="comment"># b2 = [[3 4 5]]</span></span><br><span class="line"><span class="comment"># c1 = [[0 1 2]]</span></span><br><span class="line"><span class="comment"># c2 = [[3 4 5]]</span></span><br></pre></td></tr></table></figure>

<h3 id="è®¿é—®æ•°ç»„å…ƒç´ "><a href="#è®¿é—®æ•°ç»„å…ƒç´ " class="headerlink" title="è®¿é—®æ•°ç»„å…ƒç´ "></a>è®¿é—®æ•°ç»„å…ƒç´ </h3><ol>
<li><p>åˆ‡ç‰‡ä¸‹æ ‡ï¼šå’Œåˆ—è¡¨åˆ‡ç‰‡ä¸€æ ·ï¼Œä¿®æ”¹åˆ‡ç‰‡åçš„å…ƒç´ ä¼šå¯¼è‡´åŸå§‹æ•°ç»„æ”¹å˜</p>
</li>
<li><p>é«˜çº§ä¸‹æ ‡ï¼š</p>
<ol>
<li><p>æ•´æ•°åˆ—è¡¨/å…ƒç»„ä½œä¸ºä¸‹æ ‡</p>
</li>
<li><p>æ•´æ•°æ•°ç»„ä½œä¸ºä¸‹æ ‡</p>
</li>
<li><p>å¸ƒå°”æ•°ç»„ä½œä¸ºä¸‹æ ‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">array([<span class="number">10</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>])</span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line">b = a[[<span class="number">0</span>,<span class="number">-1</span>,<span class="number">5</span>,<span class="number">7</span>]]	<span class="comment">#array([10,2,5,3])</span></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line">c = a[np.array([<span class="number">3</span>,<span class="number">3</span>,<span class="number">-3</span>,<span class="number">8</span>])]	<span class="comment">#array([7,7,4,2])</span></span><br><span class="line">d = a[np.array([[<span class="number">3</span>,<span class="number">3</span>,<span class="number">-3</span>,<span class="number">8</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]])]	<span class="comment">#array([[7,7,4,2],[9,8,7,6]])</span></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line">array([<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>])</span><br><span class="line">b = a[np.array([<span class="literal">True</span>,<span class="literal">False</span>,<span class="literal">True</span>,<span class="literal">False</span>,<span class="literal">False</span>])]	<span class="comment">#array([5,3])</span></span><br><span class="line">a[np.array([<span class="literal">True</span>,<span class="literal">False</span>,<span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">False</span>])] = <span class="number">-1</span>, <span class="number">-2</span>, <span class="number">-3</span> </span><br><span class="line"><span class="comment">#array([-1, 4, -2, -3, 1])</span></span><br><span class="line">x = np.random.rand(<span class="number">4</span>)	</span><br><span class="line"><span class="comment"># [0.75217218 0.49197318 0.0754037  0.8145583 ]</span></span><br><span class="line">x &gt; <span class="number">0.5</span></span><br><span class="line"><span class="comment"># [ True False False  True]</span></span><br><span class="line">x[x&gt;<span class="number">0.5</span>]</span><br><span class="line"><span class="comment"># [0.75217218 0.8145583 ]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å¤šç»´æ•°ç»„ï¼šæ•°ç»„ä¸åŒç»´æ•°çš„åæ ‡ç”¨<code>,</code>éš”å¼€ï¼Œä¾‹å¦‚äºŒç»´æ•°ç»„<code>a</code>ï¼Œ<code>a[0,1]</code>ä¸­ï¼Œ0æ˜¯ç¬¬ä¸€ç»´ï¼ˆè¡Œï¼‰ï¼Œ1æ˜¯ç¬¬äºŒç»´ï¼ˆåˆ—ï¼‰ï¼Œæ¯ä¸ªç»´åº¦å†…å¯ä»¥ç”¨åˆ‡ç‰‡çš„æ–¹å¼è®¿é—®ï¼Œä¾‹å¦‚<code>a[0,3:5]</code>å’Œ<code>a[:,2]</code>ç­‰ï¼Œä¹Ÿå¯ä»¥ç”¨åˆ—è¡¨æˆ–å…ƒç»„ä¸‹æ ‡çš„æ–¹å¼è®¿é—®ã€‚</p>
<p>ä¸‹æ ‡é•¿åº¦å°äºæ•°ç»„ç»´æ•°æ—¶ï¼Œå‰©ä½™çš„è½´å¯¹åº”çš„ä¸‹æ ‡æ˜¯<code>:</code> ã€‚</p>
<p> æ‰€æœ‰è½´çš„ä¸‹æ ‡å½¢çŠ¶ç›¸åŒæ—¶ï¼Œå¾—åˆ°çš„æ•°ç»„å’Œä¸‹æ ‡å½¢çŠ¶ç›¸åŒã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ•°ç»„</span></span><br><span class="line"><span class="comment"># 0, 1, 2, 3, 4, 5</span></span><br><span class="line"><span class="comment"># 10,11,12,13,14,15</span></span><br><span class="line"><span class="comment"># 20,21,22,23,24,25</span></span><br><span class="line"><span class="comment"># 30,31,32,33,34,35</span></span><br><span class="line"><span class="comment"># 40,41,42,43,44,45</span></span><br><span class="line"><span class="comment"># 50,51,52,53,54,55</span></span><br><span class="line">a[<span class="number">0</span>, <span class="number">3</span>:<span class="number">5</span>]	<span class="comment"># ç¬¬0è¡Œç¬¬3åˆ—å’Œç¬¬4åˆ—</span></span><br><span class="line"><span class="comment"># array([3,4])</span></span><br><span class="line">a[<span class="number">4</span>:,<span class="number">4</span>:]	<span class="comment"># ç¬¬4ã€5è¡Œå’Œç¬¬4ã€5åˆ—</span></span><br><span class="line"><span class="comment"># array([[44,45],[54,55]])</span></span><br><span class="line">a[:,<span class="number">2</span>]		<span class="comment"># ç¬¬2åˆ—</span></span><br><span class="line"><span class="comment"># array([ 2, 12, 22, 32, 42, 52])</span></span><br><span class="line">a[<span class="number">2</span>,:]		<span class="comment"># ç¬¬2è¡Œ</span></span><br><span class="line"><span class="comment"># array([20, 21, 22, 23, 24, 25])</span></span><br><span class="line">a[<span class="number">2</span>::<span class="number">2</span>, ::<span class="number">2</span>]	<span class="comment">#ç¬¬2è¡Œåˆ°æœ€åä¸€è¡Œï¼Œæ­¥é•¿2ï¼›æ‰€æœ‰åˆ—ï¼Œæ­¥é•¿2</span></span><br><span class="line"><span class="comment"># array([[20, 22, 24], [40, 42, 44]])</span></span><br><span class="line">a[(<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>),(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)] <span class="comment">#åæ ‡ä¸º(0,1)(1,2)(2,3)(3,4)(4,5)çš„å…ƒç´ </span></span><br><span class="line"><span class="comment"># array([1,12,23,34,45])</span></span><br><span class="line">a[<span class="number">3</span>:,[<span class="number">0</span>,<span class="number">2</span>,<span class="number">5</span>]]	<span class="comment">#ç¬¬3è¡Œåˆ°æœ€åä¸€è¡Œï¼Œç¬¬0ã€2ã€5åˆ—</span></span><br><span class="line"><span class="comment"># array([[30, 32, 35], [40, 42, 45], [50, 52, 55]]) </span></span><br><span class="line">mask=np.array([<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>], dtype=bool)</span><br><span class="line">a[mask,<span class="number">2</span>]</span><br><span class="line"><span class="comment"># array([2,22,52])</span></span><br><span class="line">a[[<span class="number">1</span>,<span class="number">2</span>]] 	<span class="comment">#ç›¸å½“äºa[[1,2],:] </span></span><br><span class="line"><span class="comment"># array([[10, 11, 12, 13, 14, 15], [20, 21, 22, 23, 24, 25]])</span></span><br><span class="line">x=np.array([[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>]])</span><br><span class="line">y=np.array([[<span class="number">1</span>,<span class="number">1</span>],[<span class="number">2</span>,<span class="number">2</span>]]) </span><br><span class="line">a[x]	<span class="comment">#ä»2ç»´æ•°ç»„å˜æˆ3ç»´æ•°ç»„</span></span><br><span class="line"><span class="comment"># [[[10 11 12 13 14 15]</span></span><br><span class="line"><span class="comment">#   [20 21 22 23 24 25]]</span></span><br><span class="line"><span class="comment">#  [[30 31 32 33 34 35]</span></span><br><span class="line"><span class="comment">#   [40 41 42 43 44 45]]]</span></span><br><span class="line">a[x,y] 		<span class="comment"># xå’Œyçš„å…ƒç´ åˆ†åˆ«ä½œä¸ºä¸¤ä¸ªç»´åº¦çš„åæ ‡</span></span><br><span class="line"><span class="comment"># x = 1 2</span></span><br><span class="line"><span class="comment">#     3 4</span></span><br><span class="line"><span class="comment"># y = 1 1</span></span><br><span class="line"><span class="comment">#     2 2</span></span><br><span class="line"><span class="comment">#a[x,y]=[a[1][1] a[2][1]</span></span><br><span class="line"><span class="comment">#        a[3][2] a[4][2]]</span></span><br><span class="line"><span class="comment"># = [[11 21]</span></span><br><span class="line"><span class="comment">#    [32 42]]</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
</li>
</ol>
<h2 id="ufunc"><a href="#ufunc" class="headerlink" title="ufunc"></a>ufunc</h2><pre><code>1. å¯¹æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ è¿›è¡Œæ“ä½œçš„å‡½æ•°ï¼Œä¸éœ€è¦å†™forå¾ªç¯
   2. å¸¸ç”¨æ“ä½œï¼šåŠ å‡ä¹˜é™¤å–ä½™ä¹˜æ–¹ã€æ¯”è¾ƒè¿ç®—ã€å¸ƒå°”è¿ç®—ç­‰ç­‰
   3. è‡ªå®šä¹‰ufuncï¼š frompyfunc(func, nin, nout)</code></pre><h3 id="å…¶ä»–å‡½æ•°æ“ä½œ"><a href="#å…¶ä»–å‡½æ•°æ“ä½œ" class="headerlink" title="å…¶ä»–å‡½æ•°æ“ä½œ"></a>å…¶ä»–å‡½æ•°æ“ä½œ</h3><ol>
<li>æ±‚å’Œsum</li>
<li>å¹³å‡å€¼mean/average</li>
<li>æ–¹å·®var</li>
<li>æ ‡å‡†å·®std</li>
<li>ä¸­ä½æ•°median</li>
<li>æœ€å€¼minã€maxã€ptpã€argminã€argmax</li>
<li>æ’åºsortã€argsort</li>
<li>æŸ¥æ‰¾nonzero(a)ã€where(condition[,x,y])</li>
</ol>
<h3 id="å¹¿æ’­ï¼ˆè¿™éƒ¨åˆ†çŸ­æœŸå†…åº”è¯¥ç”¨ä¸åˆ°ï¼Œå°±ä¸å†™äº†ï¼‰"><a href="#å¹¿æ’­ï¼ˆè¿™éƒ¨åˆ†çŸ­æœŸå†…åº”è¯¥ç”¨ä¸åˆ°ï¼Œå°±ä¸å†™äº†ï¼‰" class="headerlink" title="å¹¿æ’­ï¼ˆè¿™éƒ¨åˆ†çŸ­æœŸå†…åº”è¯¥ç”¨ä¸åˆ°ï¼Œå°±ä¸å†™äº†ï¼‰"></a>å¹¿æ’­ï¼ˆè¿™éƒ¨åˆ†çŸ­æœŸå†…åº”è¯¥ç”¨ä¸åˆ°ï¼Œå°±ä¸å†™äº†ï¼‰</h3><ol>
<li>è®©æ•°ç»„shapeç›¸åŒçš„æ“ä½œ</li>
<li>orridå¯¹è±¡</li>
<li>mgridå’Œmeshgridå‡½æ•°</li>
</ol>
<h2 id="æ–‡ä»¶å­˜å–"><a href="#æ–‡ä»¶å­˜å–" class="headerlink" title="æ–‡ä»¶å­˜å–"></a>æ–‡ä»¶å­˜å–</h2><ol>
<li>è¿™éƒ¨åˆ†çŸ­æœŸå†…åº”è¯¥ä¹Ÿå°±è¯»ä¸ªå›¾åƒï¼Œä¸çœ‹äº†</li>
</ol>
<h2 id="è¯¾åä½œä¸š"><a href="#è¯¾åä½œä¸š" class="headerlink" title="è¯¾åä½œä¸š"></a>è¯¾åä½œä¸š</h2><p>è¯»å…¥å›¾åƒæ–‡ä»¶Cat.jpgï¼Œå¹¶é€šè¿‡numpyçš„æ•°ç»„æ“ä½œå¯¹å›¾åƒè¿›è¡Œä¿®æ”¹ï¼Œå¾—åˆ°ä¸‹é¢ä¸€ç³»åˆ—å›¾åƒï¼š </p>
<ol>
<li>åè‰²å›¾åƒï¼šrã€gã€bä¸ºåŸå§‹åƒç´ é¢œè‰²ï¼Œåˆ™åè‰²åçš„é¢œè‰²ä¸º255-rã€255-gã€ 255-b </li>
<li>ç°åº¦å›¾åƒï¼š rã€gã€bä¸ºåŸå§‹åƒç´ é¢œè‰²ï¼Œå˜æˆç°åº¦çš„å…¬å¼ä¸ºï¼š Gray = r<em>0.299 + g</em>0.587 + b*0.114</li>
<li>æ°´å¹³é•œåƒå›¾åƒï¼šå·¦å³äº¤æ¢</li>
<li>å‚ç›´é•œåƒå›¾åƒï¼šä¸Šä¸‹äº¤æ¢</li>
<li>è¡Œå’Œåˆ—è½¬ç½®åçš„å›¾åƒ </li>
<li>é€†æ—¶é’ˆæ—‹è½¬90Â°åçš„å›¾åƒ </li>
<li>çº¢è‰²/ç»¿è‰²/è“è‰²é€šé“å›¾åƒï¼šå…¶ä½™ä¸¤é€šé“é¢œè‰²ä¸º0, 0</li>
<li>çº¢è‰²é€šé“çš„é¢œè‰²æ›¿æ¢æˆçº¢è‰²é€šé“çš„æœ€å¤§å€¼ </li>
<li>çº¢è‰²/ç»¿è‰²/è“è‰²é€šé“é‡æ–°ç»„åˆï¼Œçº¢è‰²å˜æˆè“è‰²ï¼Œç»¿è‰²å˜æˆçº¢è‰²ï¼Œè“è‰²å˜æˆç»¿è‰² </li>
</ol>
<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>é¦–å…ˆè¯»å…¥å›¾åƒï¼š<code>im = np.array(Image.open(&quot;cat.jpg&quot;))</code></p>
<p>å…¶æ¬¡è€ƒè™‘ä¿å­˜å›¾åƒï¼Œè¿™é‡Œå†™äº†ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠæ•°ç»„è½¬ä¸ºå›¾åƒå¹¶æŒ‰æŒ‡å®šåç§°ä¿å­˜ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">saveimg</span><span class="params">(img, index)</span>:</span></span><br><span class="line">    img = Image.fromarray(img.astype(<span class="string">'uint8'</span>))</span><br><span class="line">    img.show()</span><br><span class="line">    img.save(<span class="string">'Cat'</span> + index + <span class="string">'.jpg'</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥å°±æ˜¯å›¾åƒå¤„ç†éƒ¨åˆ†äº†ï¼Œè€ƒè™‘åˆ°æœ‰é€šé“åˆ†ç¦»çš„è¦æ±‚ï¼Œæ‰€ä»¥å…ˆæŠŠ3ä¸ªé€šé“çš„æ•°æ®æå–å‡ºæ¥ï¼Œå½©è‰²å›¾åƒå˜æˆæ•°ç»„æ—¶ï¼Œæ˜¯ç”¨ä¸‰ç»´æ•°ç»„å­˜å‚¨çš„ï¼Œå‰ä¸¤ä¸ªç»´åº¦è¡¨ç¤ºè¡Œåˆ—å¯¹åº”ä½ç½®çš„åƒç´ å€¼ï¼Œç¬¬ä¸‰ä¸ªç»´åº¦è¡¨ç¤ºé¢œè‰²é€šé“ï¼Œè¿™é‡Œçš„é€šé“é¡ºåºæ˜¯rgbï¼ˆè€Œå¦‚æœç”¨opencvåº“çš„è¯ï¼Œå°±æ˜¯gbrï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>im[0,0,0]ã€im[0,0,1]ã€im[0,0,1]</code>å°±åˆ†åˆ«è¡¨ç¤ºå·¦ä¸Šè§’é‚£ä¸ªåƒç´ çš„çº¢è‰²ã€ç»¿è‰²å’Œè“è‰²å€¼ï¼Œè¿™ä¸‰ä¸ªå€¼å åŠ ä»¥åçš„ç»“æœå°±æ˜¯å½©è‰²å›¾åƒçœ‹ä¸Šå»çš„é¢œè‰²ï¼Œå› æ­¤åˆ†ç¦»é€šé“åï¼Œå¾—åˆ°çš„æ˜¯3ä¸ªäºŒç»´æ•°ç»„ï¼Œå¦‚ä¸‹ï¼š</p>
<p><code>r, g, b = im[:, :, 0], im[:, :, 1], im[:, :, 2]</code></p>
<ol>
<li><p>åè‰²ï¼šè¿™é‡Œæ„é€ ä¸€ä¸ªå’Œ<code>im</code>å°ºå¯¸ä¸€è‡´ä¸”å…ƒç´ éƒ½æ˜¯255çš„æ–°æ•°ç»„ï¼Œç”¨è¿™ä¸ªæ–°æ•°ç»„å‡å»<code>im</code>å³å¯ã€‚</p>
<p><code>im2 = np.ones_like(im) * 255 - im</code></p>
</li>
<li><p>ç°åº¦ï¼šæŒ‰ç…§å…¬å¼å¯¹åˆ†ç¦»å‡ºæ¥çš„rã€gã€bä¸‰ä¸ªé€šé“è¿›è¡Œè¿ç®—å³å¯ã€‚</p>
<p><code>im3 = r * 0.299 + g * 0.587 + b * 0.114</code></p>
</li>
<li><p>æ°´å¹³é•œåƒï¼šæ¯ä¸€è¡Œçš„å…ƒç´ é€†åº</p>
<p>è¿™é‡Œæ˜¯äºŒç»´æ•°ç»„ï¼Œä¹Ÿå°±æ˜¯è¯´è¦é€†åºçš„æ˜¯åˆ—åæ ‡ï¼Œæ‰€ä»¥æ˜¯ç¬¬äºŒç»´é€†åº</p>
<p><code>im4 = im[:, ::-1]</code></p>
</li>
<li><p>å‚ç›´é•œåƒï¼šæ¯ä¸€åˆ—çš„å…ƒç´ é€†åº</p>
<p>åŒä¸Šï¼Œç¬¬ä¸€ç»´é€†åº</p>
<p><code>im5 = im[::-1]</code></p>
</li>
<li><p>è½¬ç½®ï¼šè¿™é‡Œçš„å›¾åƒæ˜¯ä¸‰ç»´æ•°ç»„ï¼Œæ‰€ä»¥ä½¿ç”¨transposeå‡½æ•°æ¥åšï¼Œç®€å•æ¥è¯´å°±æ˜¯åŸæœ¬çš„ç¬¬ä¸€ã€äºŒç»´äº¤æ¢é¡ºåºï¼Œä¹Ÿå°±æ˜¯<code>transpose(0,1,2)â€”&gt;transpose(1,0,2)</code></p>
<p><code>im6 = im.transpose(1, 0, 2)</code></p>
</li>
<li><p>é€†æ—¶é’ˆ90åº¦ï¼šçŸ©é˜µé€†æ—¶é’ˆ90åº¦çš„æ“ä½œæ˜¯å·¦ä¹˜ä¸€ä¸ªè´Ÿå¯¹è§’çº¿ä¸Šå‡æ˜¯1ã€å…¶ä½™éƒ½æ˜¯0çš„æ–¹é˜µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè½¬ç½®çŸ©é˜µé€†åºå³å¯</p>
<p><code>im7 = im.transpose(1, 0, 2)[::-1]</code></p>
</li>
<li><p>ä¸‰é€šé“å›¾åƒï¼šæŠŠå…¶ä»–é€šé“éƒ½å˜æˆ0å³å¯ï¼Œæœ€åæŠŠ3ä¸ªå›¾æ‹¼èµ·æ¥</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">B_im = im.copy()</span><br><span class="line">B_im[:, :, [<span class="number">0</span>, <span class="number">1</span>]] = <span class="number">0</span></span><br><span class="line">G_im = im.copy()</span><br><span class="line">G_im[:, :, [<span class="number">0</span>, <span class="number">2</span>]] = <span class="number">0</span></span><br><span class="line">R_im = im.copy()</span><br><span class="line">R_im[:, :, [<span class="number">2</span>, <span class="number">1</span>]] = <span class="number">0</span></span><br><span class="line">im8 = np.concatenate((R_im, G_im, B_im), axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>çº¢è‰²æ‹‰æ»¡ï¼šæŠŠçº¢è‰²é€šé“å˜æˆ255å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">im9 = im.copy()</span><br><span class="line">im9[:, :, <span class="number">0</span>] = <span class="number">255</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>é€šé“é‡ç»„ï¼šè¿™é‡Œè¦æƒ³æ˜ç™½é€šé“æ€ä¹ˆç»„åˆï¼Œå‰©ä¸‹çš„å°±å¾ˆå¥½åšäº†ã€‚çº¢è‰²å˜æˆè“è‰²ï¼Œç»¿è‰²å˜æˆçº¢è‰²ï¼Œè“è‰²å˜æˆç»¿è‰²ï¼Œä¹Ÿå°±æ˜¯åŸæœ¬æ˜¯çº¢è‰²çš„æ•°å€¼è¦å˜æˆè“è‰²é€šé“ï¼Œç»¿è‰²æ•°å€¼å˜æˆçº¢è‰²é€šé“ï¼Œè“è‰²æ•°å€¼å˜æˆç»¿è‰²é€šé“ï¼Œå› æ­¤é€šé“åŸæœ¬çš„<code>(0,1,2)</code>å˜æˆç°åœ¨çš„<code>(1,2,0)</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">im10 = im.copy()</span><br><span class="line">im10 = im10[:, :, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>]]</span><br></pre></td></tr></table></figure>



</li>
</ol>
]]></content>
      <categories>
        <category>è¯¾ç¨‹ç¬”è®°</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonè¯¾ç¨‹è®°å½•-9</title>
    <url>/2020/04/22/python%E8%AF%BE%E7%A8%8B%E8%AE%B0%E5%BD%95-9/</url>
    <content><![CDATA[<p>è¿™ä¸€è¯¾æ˜¯çˆ¬è™«ã€‚</p>
<a id="more"></a>

<ol>
<li>ä½¿ç”¨ä¸¤ä¸ªåº“ï¼š<ol>
<li>Requestsï¼šè·å–ç½‘ç»œæ•°æ®</li>
<li>BeautifulSoupï¼šåˆ†æç½‘ç»œæ•°æ®</li>
</ol>
</li>
</ol>
<h3 id="Requests"><a href="#Requests" class="headerlink" title="Requests"></a>Requests</h3><ol>
<li><p>è·å–æŸç½‘å€ä¿¡æ¯ï¼š<code>requests.get(url, params=None, **kwargs)</code></p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">html= requests.get(<span class="string">"html://www.bnu.edu.cn"</span>)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'bnu.html'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(html.content)		<span class="comment"># ä¿å­˜htmlçš„å†…å®¹</span></span><br><span class="line">type(html)		<span class="comment"># requests.models.Response</span></span><br><span class="line">html.url		<span class="comment"># 'https://www.bnu.edu.cn/'</span></span><br><span class="line">html.content	<span class="comment"># äºŒè¿›åˆ¶å†…å®¹</span></span><br><span class="line">html.text		<span class="comment"># å­—ç¬¦ä¸²ï¼ˆå¯èƒ½ä¹±ç ï¼‰</span></span><br><span class="line">html.encoding	<span class="comment"># 'ISO-8859-1'</span></span><br><span class="line">html.encoding=<span class="string">'utf-8'</span>  <span class="comment">#ä¿®æ”¹ç¼–ç </span></span><br><span class="line">html.request.headers	<span class="comment"># è®¿é—®æ–¹å¼ï¼š &#123;'User-Agent': 'python-requests/2.22.0', 'Accept-Encoding': 'gzip, deflate', 'Accept': '*/*', 'Connection': 'keep-alive'&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æŠŠè®¿é—®æ–¹å¼ä¼ªè£…æˆæ­£å¸¸æµè§ˆå™¨ï¼š</p>
<ol>
<li><p>è·å–æµè§ˆå™¨çš„è®¿é—®æ–¹å¼ï¼š</p>
<ol>
<li><p>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€é“¾æ¥ï¼›</p>
</li>
<li><p>æŒ‰F12ï¼Œæ‰¾åˆ°Networkï¼›</p>
</li>
<li><p>éšä¾¿é€‰ä¸€ä¸ªèµ„æºç‚¹ä¸€ä¸‹ï¼ˆå¦‚æœä¸€ä¸ªéƒ½æ²¡æœ‰ï¼Œå°±åˆ·æ–°ä¸€ä¸‹ç½‘é¡µï¼‰ï¼›</p>
</li>
<li><p>åœ¨Request Headersé‡Œæ‰¾åˆ°User-Agentå¹¶æŠŠæ•´ä¸ªå†…å®¹å¤åˆ¶å‡ºæ¥ã€‚</p>
<p><img src="https://github.com/kun-bin/image/blob/master/0422.png?raw=true" alt="ç¤ºæ„å›¾"></p>
</li>
</ol>
</li>
<li><p>åœ¨ä»£ç ä¸­åšä¼ªè£…ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">head = &#123;<span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36'</span>&#125;</span><br><span class="line">html = requests.get(<span class="string">"http://www.bnu.edu.cn"</span>, headers=head)</span><br><span class="line">html.request.headers	<span class="comment"># è®¿é—®æ–¹å¼å˜æˆUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
</li>
</ol>
<h3 id="BeautifulSoup"><a href="#BeautifulSoup" class="headerlink" title="BeautifulSoup"></a>BeautifulSoup</h3><ol>
<li><p>åˆ†æé¡µé¢ä¿¡æ¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">bsObj = BeautifulSoup(html.content, <span class="string">'lxml'</span>)  <span class="comment">#lxml HTML è§£æå™¨ï¼šé€Ÿåº¦å¿«ï¼Œæ–‡æ¡£å®¹é”™èƒ½åŠ›å¼º</span></span><br><span class="line">type(bsObj)		<span class="comment"># bs4.BeautifulSoup</span></span><br><span class="line">bsObj.title     <span class="comment">#è·å¾—htmlä¸­çš„titleæ ‡ç­¾: &lt;title&gt;åŒ—äº¬å¸ˆèŒƒå¤§å­¦&lt;/title&gt;</span></span><br><span class="line">type(bsObj.title )	<span class="comment"># bs4.element.Tag</span></span><br><span class="line">bsObj.img   <span class="comment">#è·å¾—htmlä¸­çš„ç¬¬ä¸€ä¸ªimgæ ‡ç­¾: &lt;img alt="" src="images/logo1.png"/&gt;</span></span><br><span class="line">bsObj.a    <span class="comment">#è·å¾—htmlä¸­çš„ç¬¬ä¸€ä¸ªaæ ‡ç­¾: &lt;a href="https://one.bnu.edu.cn" target="_blank"&gt;ä¿¡æ¯é—¨æˆ·&lt;/a&gt;</span></span><br><span class="line">print(type(bsObj.img), type(bsObj.a ))	<span class="comment"># &lt;class 'bs4.element.Tag'&gt; &lt;class 'bs4.element.Tag'&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è·å–æ ‡ç­¾ä¿¡æ¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">bsObj.a.get_text()	<span class="comment"># 'ä¿¡æ¯é—¨æˆ·'</span></span><br><span class="line">bsObj.a.text		<span class="comment"># 'ä¿¡æ¯é—¨æˆ·'</span></span><br><span class="line">bsObj.a.attrs		<span class="comment"># &#123;'href': 'https://one.bnu.edu.cn', 'target': '_blank'&#125;</span></span><br><span class="line">bsObj.a[<span class="string">'href'</span>]		<span class="comment"># è·å–aæ ‡ç­¾çš„hrefå±æ€§å€¼ï¼š'https://one.bnu.edu.cn'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ‰¾åˆ°ç‰¹å®šæ ‡ç­¾ï¼š<code>find( name , attrs , recursive , text , **kwargs )</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">alink=bsObj.find(<span class="string">'a'</span>)   <span class="comment"># æ²¡æœ‰å±æ€§é™å®šï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªaæ ‡ç­¾</span></span><br><span class="line">print(alink)			<span class="comment"># &lt;a href="https://one.bnu.edu.cn" target="_blank"&gt;ä¿¡æ¯é—¨æˆ·&lt;/a&gt;</span></span><br><span class="line">blink=bsObj.find(<span class="string">'a'</span>,text=<span class="string">'å­¦éƒ¨é™¢ç³»'</span>)	<span class="comment"># é™å®šäº†å±æ€§ textçš„å€¼</span></span><br><span class="line">print(blink)			<span class="comment"># &lt;a href="xbyx/index.htm"&gt;å­¦éƒ¨é™¢ç³»&lt;/a&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°æ‰€æœ‰æŒ‡å®šæ ‡ç­¾ï¼š<code>find_all( name , attrs , recursive , text , limit, **kwargs )</code>è¿”å›åˆ—è¡¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">alink=bsObj.find_all(<span class="string">'a'</span>)</span><br><span class="line">print(alink)	<span class="comment"># æ‰€æœ‰aæ ‡ç­¾çš„åˆ—è¡¨</span></span><br><span class="line">blink=bsObj.find_all(<span class="string">"a"</span>, limit=<span class="number">2</span>)	<span class="comment"># åªæ‰¾å‰ä¸¤ä¸ªaæ ‡ç­¾</span></span><br><span class="line">print(blink)				<span class="comment"># [&lt;a href="https://one.bnu.edu.cn" target="_blank"&gt;ä¿¡æ¯é—¨æˆ·&lt;/a&gt;, &lt;a href="http://xxgk.bnu.edu.cn/" target="_blank"&gt;ä¿¡æ¯å…¬å¼€&lt;/a&gt;]</span></span><br><span class="line">clink=bsObj.find_all(<span class="string">'span'</span>, class_=<span class="string">"more01"</span>)	<span class="comment"># classå€¼ç¬¦åˆè¦æ±‚çš„spanæ ‡ç­¾</span></span><br><span class="line">print(clink)		<span class="comment"># [&lt;span class="more01"&gt;&lt;img alt="" src="images/more3.png"/&gt;&lt;/span&gt;, &lt;span class="more01"&gt;&lt;img alt="" src="images/more3.png"/&gt;&lt;/span&gt;, &lt;span class="more01"&gt;&lt;img alt="" src="images/more3.png"/&gt;&lt;/span&gt;, &lt;span class="more01"&gt;&lt;img alt="" src="images/more3.png"/&gt;&lt;/span&gt;]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">imglist = bsObj.find_all(<span class="string">'img'</span>, &#123;<span class="string">"src"</span>:re.compile(<span class="string">".+\.jpg"</span>)&#125;)	<span class="comment"># ç¬¦åˆæ­£åˆ™è¡¨è¾¾çš„æ ‡ç­¾</span></span><br><span class="line">print(imglist)</span><br><span class="line"></span><br><span class="line">dlink=bsObj.find(<span class="string">'div'</span>, class_=<span class="string">"nav"</span>).find_all(<span class="string">'a'</span>)	<span class="comment"># findå’Œfindallç»“åˆä½¿ç”¨</span></span><br><span class="line">print(dlink)</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç›¸å¯¹urlè½¬ç»å¯¹urlï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> requests.compat <span class="keyword">import</span> urljoin</span><br><span class="line"></span><br><span class="line">url=<span class="string">'https://www.bnu.edu.cn/'</span></span><br><span class="line">blink = urljoin(url, blink[<span class="string">'href'</span>])</span><br><span class="line">print(blink)	<span class="comment"># https://www.bnu.edu.cn/xbyx/index.htm</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å›¾åƒç›¸å…³ï¼ˆimgæ ‡ç­¾ï¼‰ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">clink=bsObj.find(<span class="string">'img'</span>)</span><br><span class="line">print(clink)			<span class="comment"># &lt;img alt="" src="images/logo1.png"/&gt;</span></span><br><span class="line">print(clink[<span class="string">'src'</span>])		<span class="comment"># images/logo1.png</span></span><br><span class="line">logo= requests.get(urljoin(url, clink[<span class="string">'src'</span>]), headers=head) <span class="comment">#è·å¾—å›¾åƒ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå›¾åƒ</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line">im=Image.open(BytesIO(logo.content))</span><br><span class="line">im.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜å›¾åƒ</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">r'D:\2020Python\Ch8\BNU-logo.png'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f: </span><br><span class="line">    f.write(logo.content)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">r'D:\2020Python\Ch8\BNU-logo.'</span>+clink[<span class="string">'src'</span>][<span class="number">-3</span>:], <span class="string">'wb'</span>) <span class="keyword">as</span> f: </span><br><span class="line">    f.write(logo.content)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>class</code>æ ‡ç­¾çš„è®¿é—®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">dlink=bsObj.find('span', class="col-md-10")  #class æ˜¯å…³é”®è¯ï¼Œä¸èƒ½è¿™æ ·ä½¿ç”¨</span><br><span class="line"><span class="comment"># è§£å†³æ–¹æ¡ˆ1</span></span><br><span class="line">dlink=bsObj.find(<span class="string">'div'</span>, class_=<span class="string">"item-txt01"</span>)</span><br><span class="line">print(dlink)</span><br><span class="line"><span class="comment"># è§£å†³æ–¹æ¡ˆ2</span></span><br><span class="line">dlink=bsObj.find(<span class="string">'div'</span>, &#123;<span class="string">'class'</span>:<span class="string">'item-txt01'</span>&#125;)</span><br><span class="line">print(dlink.text)</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç½‘é¡µæºç æ ‘çŠ¶ç»“æ„ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">clink=bsObj.find(<span class="string">'li'</span>)</span><br><span class="line">clink.parent  <span class="comment">#çˆ¶èŠ‚ç‚¹</span></span><br><span class="line">clink.children  <span class="comment">#å­©å­èŠ‚ç‚¹</span></span><br><span class="line"><span class="keyword">for</span> child <span class="keyword">in</span> clink.children:</span><br><span class="line">    print(child)	<span class="comment"># è¾“å‡ºå­èŠ‚ç‚¹</span></span><br><span class="line"><span class="keyword">for</span> child <span class="keyword">in</span> clink.descendants:    <span class="comment">#å­å­™èŠ‚ç‚¹ï¼Œåä»£èŠ‚ç‚¹</span></span><br><span class="line">    print(child)</span><br><span class="line"><span class="keyword">for</span> sibling <span class="keyword">in</span> clink.next_siblings:  <span class="comment">#å…„å¼ŸèŠ‚ç‚¹</span></span><br><span class="line">    print(sibling)</span><br><span class="line">clink.find_parent(<span class="string">'div'</span>, class_=<span class="string">'nav'</span>)  <span class="comment">#æ»¡è¶³classä¸ºâ€˜navâ€™çš„çˆ¶èŠ‚ç‚¹</span></span><br><span class="line"><span class="keyword">for</span> child <span class="keyword">in</span> clink.findChildren(<span class="string">'a'</span>):  <span class="comment">#æ‰¾åˆ° aæ ‡ç­¾ å­©å­</span></span><br><span class="line">    print(child)</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="çˆ¬å–ç½‘é¡µæ‰€æœ‰å›¾ç‰‡çš„ç¤ºä¾‹"><a href="#çˆ¬å–ç½‘é¡µæ‰€æœ‰å›¾ç‰‡çš„ç¤ºä¾‹" class="headerlink" title="çˆ¬å–ç½‘é¡µæ‰€æœ‰å›¾ç‰‡çš„ç¤ºä¾‹"></a>çˆ¬å–ç½‘é¡µæ‰€æœ‰å›¾ç‰‡çš„ç¤ºä¾‹</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#åªçˆ¬å–urlç½‘é¡µä¸Šçš„å›¾ç‰‡ï¼Œä¸çˆ¬nextç½‘é¡µä¸Šçš„å›¾ç‰‡</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> requests.compat <span class="keyword">import</span> urljoin</span><br><span class="line">url = <span class="string">'http://news.bnu.edu.cn/sj/gysd/index.htm'</span></span><br><span class="line">head = &#123;<span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36'</span>&#125;</span><br><span class="line">html = requests.get(url, headers = head)</span><br><span class="line">bsObj= BeautifulSoup(html.content, <span class="string">'lxml'</span>)</span><br><span class="line">allLinks = bsObj.find_all(<span class="string">'div'</span>, class_=<span class="string">"grid"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> allLinks:</span><br><span class="line">    imglink = i.find(<span class="string">'img'</span>)[<span class="string">'src'</span>]	</span><br><span class="line">    imglink = urljoin(url, imglink)	<span class="comment"># å›¾ç‰‡é“¾æ¥</span></span><br><span class="line">    name = i.find(<span class="string">'h3'</span>).text		<span class="comment"># å›¾ç‰‡æ ‡é¢˜</span></span><br><span class="line">    print(imglink, name)</span><br><span class="line">    img  = requests.get(imglink, headers = head)</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">r'D:\2020Python\Ch8\å›¾ç‰‡/'</span>+name+imglink[<span class="number">-4</span>:], <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(img.content)		<span class="comment"># ä¿å­˜å›¾ç‰‡</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#çˆ¬å–æœ¬ç½‘é¡µä»¥åŠä¸‹ä¸€é¡µçš„å›¾ç‰‡</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> requests.compat <span class="keyword">import</span> urljoin</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">url=<span class="string">'http://news.bnu.edu.cn/sj/gysd/index.htm'</span></span><br><span class="line">head = &#123;<span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36'</span>&#125;</span><br><span class="line">path=<span class="string">'D:/2020Python/Ch8/å…‰å½±å¸ˆå¤§/'</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path):</span><br><span class="line">    os.mkdir(path)</span><br><span class="line">nexturl=url</span><br><span class="line"><span class="keyword">while</span> nexturl:</span><br><span class="line">    html = requests.get(nexturl, headers=head)</span><br><span class="line">    bsObj=BeautifulSoup(html.content, <span class="string">'lxml'</span>)</span><br><span class="line">    imgslink=bsObj.find_all(<span class="string">'div'</span>, class_=<span class="string">"grid"</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> imgslink:</span><br><span class="line">        imglink=i.find(<span class="string">'img'</span>)[<span class="string">'src'</span>]</span><br><span class="line">        imglink=urljoin(nexturl,imglink)</span><br><span class="line">        name=i.find(<span class="string">'h3'</span>).text</span><br><span class="line">        name=<span class="string">''</span>.join([i <span class="keyword">for</span> i <span class="keyword">in</span> name <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">'\\'</span>,<span class="string">'/'</span>,<span class="string">':'</span>,<span class="string">'*'</span>,<span class="string">'?'</span>,<span class="string">'"'</span>,<span class="string">'&lt;'</span>,<span class="string">'&gt;'</span>,<span class="string">'|'</span>]])</span><br><span class="line">        print(imglink, name)        </span><br><span class="line">        img=requests.get(urljoin(nexturl,imglink), headers=head)</span><br><span class="line">        <span class="keyword">with</span> open(path+name+imglink[<span class="number">-4</span>:], <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(img.content)        </span><br><span class="line">    temp=bsObj.find(<span class="string">'a'</span>,class_=<span class="string">"next"</span>)	<span class="comment"># è·å–nextæ ‡ç­¾ï¼ˆä¸‹ä¸€é¡µï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> temp:</span><br><span class="line">        nexturl=urljoin(nexturl,temp[<span class="string">'href'</span>])	<span class="comment"># è·å–ä¸‹ä¸€é¡µçš„url</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        nexturl=<span class="literal">None</span></span><br></pre></td></tr></table></figure>

<h3 id="è¯¾åä½œä¸š"><a href="#è¯¾åä½œä¸š" class="headerlink" title="è¯¾åä½œä¸š"></a>è¯¾åä½œä¸š</h3><p>æŠ“å–åŒ—äº¬å¸ˆèŒƒå¤§å­¦ä¸­å¤´æ¡å…³æ³¨ç½‘ç«™ï¼š <a href="http://news.bnu.edu.cn/zx/ttgz/index.htm" target="_blank" rel="noopener">http://news.bnu.edu.cn/zx/ttgz/index.htm</a> ä¸Šè¿„ä»Šä¸ºæ­¢æ‰€ æœ‰å¤´æ¡å…³æ³¨æŠ¥é“çš„å‘è¡¨æ—¥æœŸã€æ ‡é¢˜ã€é“¾æ¥ä»¥åŠæµè§ˆæ¬¡æ•°ï¼Œä¿å­˜ä¸º ä¸€ä¸ªcsvæ–‡ä»¶ï¼Œè¦æ±‚ä½¿ç”¨å‡½æ•°å°è£…ã€‚</p>
<p>æ€è·¯ï¼š</p>
<ol>
<li><p>å¯¼å…¥æ‰€éœ€åº“</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> requests.compat <span class="keyword">import</span> urljoin</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ†æè¿™ä¸ªç½‘ç«™ï¼Œå‘ç°äº†å¾ˆç¥å¥‡çš„ä¸€ç‚¹ï¼Œè¯¥ç½‘ç«™ä¸€å…±68é¡µï¼Œåº”è¯¥åªæœ‰ç¬¬68é¡µæ²¡æœ‰<code>next</code>æ ‡ç­¾ï¼Œä½†å®é™…ä¸Šå®ƒç¬¬67é¡µå°±æ²¡äº†ã€‚å¦‚æœç”¨ä¿å­˜å›¾åƒé‚£ä¸ªä¾‹å­é‡Œçš„æ–¹å¼è®¿é—®ï¼Œåˆ™æ— æ³•è®¿é—®åˆ°ç¬¬68é¡µï¼Œæ‰€ä»¥è€ƒè™‘å†™ä¸ªå‡½æ•°æ¥è·å–ç½‘ç«™ä¸€å…±å¤šå°‘é¡µï¼Œç„¶å<code>for</code>å¾ªç¯è¯»ç½‘é¡µå†…å®¹ã€‚</p>
<p>ç»è¿‡ä»”ç»†è§‚å¯Ÿï¼Œå¯ä»¥å‘ç°ç½‘é¡µä¸‹é¢æœ‰ä¸€ä¸ªå…ƒç´ ç”¨æ¥æ˜¾ç¤ºâ€œç°åœ¨æ˜¯ç¬¬å‡ é¡µ/æ€»å…±å¤šå°‘é¡µâ€ï¼Œæºä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"pages "</span>&gt;</span></span><br><span class="line">		   			            é¡µæ•°ï¼š<span class="tag">&lt;<span class="name">span</span>&gt;</span>1/68<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          æ€»æ•°ï¼š<span class="tag">&lt;<span class="name">span</span>&gt;</span>680<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">						</span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"index.htm"</span> <span class="attr">class</span>=<span class="string">"on_pages"</span>&gt;</span>1<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"index1.htm"</span>&gt;</span>2<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"index2.htm"</span>&gt;</span>3<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"index3.htm"</span>&gt;</span>4<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"index4.htm"</span>&gt;</span>5<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"index5.htm"</span>&gt;</span>6<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"index6.htm"</span>&gt;</span>7<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"index7.htm"</span>&gt;</span>8<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"index8.htm"</span>&gt;</span>9<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"index9.htm"</span>&gt;</span>10<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"index1.htm"</span> <span class="attr">class</span>=<span class="string">"next"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"../../images/pages04.jpg"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"index10.htm"</span> <span class="attr">class</span>=<span class="string">"end"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"../../images/pages05.jpg"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å› æ­¤å¯ä»¥æ‰¾åˆ°<code>class = pages</code> çš„<code>div</code>æ ‡ç­¾ï¼Œç„¶åè·å–å…¶ä¸­<code>span</code>æ ‡ç­¾çš„å†…å®¹ï¼Œå¹¶æˆªå–<code>/</code>ç¬¦å·åé¢çš„å†…å®¹è½¬ä¸ºæ•°å­—ï¼Œå³å¯å¾—åˆ°ç½‘ç«™é¡µæ•°ï¼Œå†™æˆå‡½æ•°çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">page</span><span class="params">(url, head)</span>:</span></span><br><span class="line">    html = requests.get(url, headers=head)</span><br><span class="line">    bsObj = BeautifulSoup(html.content, <span class="string">'lxml'</span>)</span><br><span class="line">    <span class="keyword">return</span> int(bsObj.find(class_=<span class="string">"pages"</span>).find(<span class="string">'span'</span>).text.split(<span class="string">'/'</span>)[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ¥ä¸‹æ¥å¯ä»¥é€šè¿‡<code>for</code>å¾ªç¯è®¿é—®æ¯ä¸€é¡µï¼Œç¬¬ä¸€é¡µæ˜¯<code>index.htm</code>ï¼Œæ¥ä¸‹æ¥æ˜¯<code>index1.htm</code>ç­‰ç­‰ï¼Œç›´åˆ°æœ€åæ˜¯<code>index67.htm</code>ã€‚</p>
<ol>
<li><p>åˆ†æç½‘é¡µæºç å¯çŸ¥ï¼Œåœ¨æ¯ä¸€é¡µä¸­ï¼Œæˆ‘ä»¬éœ€è¦æå–çš„å†…å®¹ä¸€å®šåœ¨<code>class = item-info01</code>çš„æ ‡ç­¾ä¸­ï¼Œå› æ­¤ä½¿ç”¨<code>findall</code>ç„¶åéå†å¾—åˆ°çš„æ ‡ç­¾åˆ—è¡¨ã€‚</p>
</li>
<li><p>åˆ†ææ¯ä¸ªæ ‡ç­¾æºç å¯çŸ¥ï¼Œæ–‡ç« æ ‡é¢˜å‡ºç°åœ¨<code>h3</code>ä¸­ï¼Œå³<code>title = i.find(&#39;h3&#39;).text</code>ã€‚</p>
</li>
<li><p>æ–‡ç« é“¾æ¥æ˜¯<code>a</code>æ ‡ç­¾çš„<code>href</code>å±æ€§ï¼Œæ˜¯ç›¸å¯¹é“¾æ¥ï¼Œè¦è½¬æ¢ä¸ºç»å¯¹é“¾æ¥ï¼Œä¸è¿‡è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œæœ‰ä¸€äº›æ–‡ç« ç”¨äº†å¾®ä¿¡é“¾æ¥ç­‰ç«™å¤–ç½‘é¡µä½œä¸ºå†…å®¹ï¼Œå› æ­¤è¿™äº›é“¾æ¥æ˜¯ç»å¯¹é“¾æ¥ï¼Œä¸éœ€è¦è½¬æ¢ã€‚æ‰€ä»¥è¦åˆ¤æ–­ä¸€ä¸‹é¦–å­—æ¯æ˜¯å¦ä¸º<code>h</code>ã€‚æ­¤å¤–ï¼Œåœ¨æˆ‘ä»¬ä¿å­˜çš„æ—¶å€™ï¼Œé“¾æ¥åé¢è¦åŠ æµè§ˆæ¬¡æ•°ï¼Œç›´æ¥ç”¨é€—å·åˆ†éš”ä¼šå¯¼è‡´æ‰“å¼€csvæ—¶é“¾æ¥å’Œæµè§ˆæ¬¡æ•°è¿åœ¨ä¸€èµ·ï¼Œæ‰€ä»¥é“¾æ¥æœ¬èº«ä¿å­˜æ—¶åœ¨æœ«å°¾åŠ ä¸ªç©ºæ ¼ã€‚</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">link = i.find(<span class="string">'a'</span>)[<span class="string">'href'</span>]</span><br><span class="line"><span class="keyword">if</span> link[<span class="number">0</span>] != <span class="string">'h'</span>:</span><br><span class="line">	link = urljoin(url, link)</span><br><span class="line">link += <span class="string">' '</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li><p>æ–‡ç« æ—¶é—´æ˜¯<code>class = time</code>çš„<code>span</code>æ ‡ç­¾å¯¹åº”çš„å†…å®¹ï¼Œå³<code>time = i.find(&#39;span&#39;, class_=&quot;time&quot;).text</code>ã€‚</p>
</li>
<li><p>æœ€åæ˜¯æ–‡ç« æµè§ˆæ¬¡æ•°ï¼Œè¿™ä¸ªç½‘ç«™æµè§ˆæ¬¡æ•°æ˜¯ç”¨scriptåšçš„ï¼Œæ‰€ä»¥è¦è·³è½¬åˆ°å¯¹åº”é“¾æ¥ï¼Œç„¶åä»æ–°ç½‘é¡µé‡Œè·å–æµè§ˆæ¬¡æ•°ã€‚å¯¹åº”çš„ç›¸å¯¹é“¾æ¥æ˜¯<code>script</code>æ ‡ç­¾ä¸­çš„<code>src</code>å±æ€§ï¼Œå› æ­¤è¦è·³è½¬çš„æ–°ç½‘é¡µæ˜¯<code>urljoin(url, i.find(&#39;script&#39;)[&#39;src&#39;])</code>ï¼Œè¿™ä¸ªç½‘é¡µçš„å†…å®¹åªæœ‰<code>document.write(&#39;31&#39;)</code>è¿™æ ·çš„å­—ç¬¦ï¼Œæ‰€ä»¥è·å–ç½‘é¡µå†…å®¹åæå–å®ƒ17ä½å¼€å§‹ã€å€’æ•°ç¬¬3ä½ç»“æŸçš„å†…å®¹å³å¯å¾—åˆ°æµè§ˆæ¬¡æ•°ï¼ˆç±»å‹ä¸ºå­—ç¬¦ä¸²ï¼‰ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">viewlink = urljoin(url, i.find(<span class="string">'script'</span>)[<span class="string">'src'</span>])</span><br><span class="line">view = BeautifulSoup(requests.get(viewlink).text, <span class="string">'lxml'</span>).text[<span class="number">16</span>:<span class="number">-3</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>æœ€åæŠŠä¸Šè¿°å†…å®¹æŒ‰é¡ºåºåŠ åˆ°åˆ—è¡¨ä¸­ï¼Œç„¶ååœ¨æ•´ä¸ªå¾ªç¯ç»“æŸåè¿”å›åˆ—è¡¨å³å¯ã€‚å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">analy</span><span class="params">(page, url, head)</span>:</span></span><br><span class="line">    lists = []</span><br><span class="line">    nexturl = url</span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> range(page):</span><br><span class="line">        html = requests.get(nexturl, headers=head)</span><br><span class="line">        bsObj = BeautifulSoup(html.content, <span class="string">'lxml'</span>)</span><br><span class="line">        allLink = bsObj.find_all(class_=<span class="string">"item-info01"</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> allLink:</span><br><span class="line">            title = i.find(<span class="string">'h3'</span>).text</span><br><span class="line">            link = i.find(<span class="string">'a'</span>)[<span class="string">'href'</span>]</span><br><span class="line">            <span class="keyword">if</span> link[<span class="number">0</span>] != <span class="string">'h'</span>:</span><br><span class="line">                link = urljoin(url, link)</span><br><span class="line">            link += <span class="string">' '</span></span><br><span class="line">            time = i.find(<span class="string">'span'</span>, class_=<span class="string">"time"</span>).text</span><br><span class="line">            viewlink = urljoin(url, i.find(<span class="string">'script'</span>)[<span class="string">'src'</span>])</span><br><span class="line">            view = BeautifulSoup(requests.get(viewlink).text, <span class="string">'lxml'</span>).text[<span class="number">16</span>:<span class="number">-3</span>]</span><br><span class="line">            lists.append([time, title, link, view])</span><br><span class="line">        nexturl = urljoin(nexturl, <span class="string">'index'</span> + str(index + <span class="number">1</span>) + <span class="string">'.htm'</span>)</span><br><span class="line">    <span class="keyword">return</span> lists</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>åœ¨å¾—åˆ°åˆ—è¡¨åï¼Œæ ¹æ®è¦æ±‚è¾“å‡ºcsvæ–‡ä»¶ï¼Œè¿™éƒ¨åˆ†å†…å®¹æ˜¯ä¸Šä¸€è¯¾è®²è¿‡çš„ï¼ŒåŸºæœ¬æ²¡æœ‰å˜åŒ–ï¼Œæ³¨æ„ç¼–ç è¦ç”¨<code>utf-8-sig</code>ï¼Œå¦‚æœç”¨å…¶ä»–ç¼–ç ï¼Œä¿å­˜çš„ä¸­æ–‡ä¼šä¹±ç ï¼›å¦‚æœåªæ˜¯<code>utf-8</code>æ²¡<code>sig</code>ï¼Œåˆ™excelæ‰“å¼€æ—¶ä¸­æ–‡ä¼šä¹±ç ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">writecsv</span><span class="params">(lists)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">"reportsInfo.csv"</span>, <span class="string">'w'</span>, newline=<span class="string">''</span>, encoding=<span class="string">'utf-8-sig'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f_csv = csv.writer(f)</span><br><span class="line">        headers = [<span class="string">'æ—¥æœŸ'</span>, <span class="string">'æ ‡é¢˜'</span>, <span class="string">'é“¾æ¥'</span>, <span class="string">'æµè§ˆæ¬¡æ•°'</span>]</span><br><span class="line">        f_csv.writerow(headers)</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> lists:</span><br><span class="line">            f_csv.writerow(row)</span><br></pre></td></tr></table></figure>
</li>
<li><p>æœ€åæ˜¯ä¸»å‡½æ•°éƒ¨åˆ†ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">head = &#123;</span><br><span class="line">    <span class="string">'user-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36'</span>&#125;</span><br><span class="line">url = <span class="string">'http://news.bnu.edu.cn/zx/ttgz/index.htm'</span></span><br><span class="line">page = page(url, head)</span><br><span class="line">lists = analy(page, url, head)</span><br><span class="line">writecsv(lists)</span><br><span class="line">print(<span class="string">"FIN"</span>)</span><br></pre></td></tr></table></figure>
</li>
</ol>
]]></content>
      <categories>
        <category>è¯¾ç¨‹ç¬”è®°</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonè¯¾ç¨‹è®°å½•-8</title>
    <url>/2020/04/17/python%E8%AF%BE%E7%A8%8B%E8%AE%B0%E5%BD%95-8/</url>
    <content><![CDATA[<p>è¿™ä¸€è¯¾è®²æ–‡ä»¶è¯»å†™ã€‚</p>
<a id="more"></a>

<h2 id="æ–‡ä»¶"><a href="#æ–‡ä»¶" class="headerlink" title="æ–‡ä»¶"></a>æ–‡ä»¶</h2><ol>
<li><p>æ–‡ä»¶ç±»å‹ï¼šæ–‡æœ¬æ–‡ä»¶ï¼ˆçº¯æ–‡æœ¬ã€æºä»£ç ã€ç½‘é¡µï¼‰ã€äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå›¾ç‰‡ã€wordã€excelã€pptï¼‰</p>
</li>
<li><p>è¯»æ–‡æœ¬æ–‡ä»¶ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">r'/path/to/file'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    s = f.read()</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ç”¨<code>with open as</code>å¯ä»¥ä¸ç”¨å†™<code>close</code></p>
</li>
<li><p>openå‡½æ•°ï¼š<code>open(file, mode=&#39;r&#39;, buffering=-1, encoding=None, errors=None, newline=None, closefd=True, opener=None)</code> è¿”å›ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ï¼Œæ˜¯å¯è¿­ä»£å¯¹è±¡</p>
</li>
<li><p>tellå‡½æ•°ï¼š<code>f.tell()</code>è¿”å›æ–‡ä»¶æŒ‡é’ˆå½“å‰åœ¨çš„ä½ç½®</p>
</li>
<li><p>æ–‡æœ¬æ–‡ä»¶æ“ä½œï¼š</p>
<p>ä»¥ä¸‹éƒ½æ˜¯å†™åœ¨<code>with open</code>çš„ä»£ç å—é‡Œé¢</p>
<ol>
<li>è¯»æ–‡æœ¬æ–‡ä»¶ï¼š<ol>
<li><code>f.readline()</code>ï¼šè¯»ä¸€è¡Œï¼Œåˆ°æ¢è¡Œç¬¦ç»“æŸï¼Œè¿”å›å­—ç¬¦ä¸²</li>
<li><code>f.read(2)</code>ï¼šæ¥ç€è¯»2ä¸ªå­—ç¬¦ï¼Œè¿”å›å­—ç¬¦ä¸²</li>
<li><code>f.readlines()</code>ï¼šæŠŠå‰©ä¸‹çš„éƒ½è¯»å®Œï¼Œè¿”å›åˆ—è¡¨ï¼Œæ¯ä¸€è¡Œä½œä¸ºåˆ—è¡¨ä¸­çš„ä¸€ä¸ªå…ƒç´ </li>
</ol>
</li>
<li>å†™æ–‡æœ¬æ–‡ä»¶ï¼š<ol>
<li><code>f.write</code>ï¼šå†™å…¥å­—ç¬¦ä¸²ï¼Œä¸æ¢è¡Œï¼Œå¯ä»¥åœ¨å­—ç¬¦ä¸²æœ«å°¾åŠ <code>\n</code>æ¥å®ç°æ¢è¡Œ</li>
<li><code>f.writelines</code>ï¼šå†™å…¥åˆ—è¡¨å…ƒç´ ï¼Œä¸æ¢è¡Œï¼Œå¯ä»¥åœ¨è¦æ¢è¡Œçš„å…ƒç´ æœ«å°¾åŠ <code>\n</code></li>
</ol>
</li>
<li>æ–‡ä»¶æ¨¡å¼ç›¸å…³ï¼š<ol>
<li>ç”¨æ–°å»ºæ–‡ä»¶çš„æ¨¡å¼ï¼ˆ<code>x</code>ï¼‰æ¥openæ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨åŒåæ–‡ä»¶ï¼Œåˆ™ä¼šæŠ¥é”™</li>
<li>ç”¨<code>w</code>æ–¹å¼å†™æ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨åŒåæ–‡ä»¶ï¼Œä¼šæ¸…ç©ºåŸæœ‰å†…å®¹å†å†™å…¥</li>
<li>ç”¨<code>a</code>æ–¹å¼å†™æ–‡ä»¶ï¼Œå­˜åœ¨åŒåæ–‡ä»¶çš„æ—¶å€™ï¼Œä¸ä¼šæ¸…ç©ºå†…å®¹ï¼Œè€Œæ˜¯åœ¨æ–‡ä»¶æœ«å°¾å†™å…¥æ–°å†…å®¹</li>
<li>ç”¨<code>r+</code>çš„æ–¹å¼è¯»å†™æ–‡ä»¶ï¼Œé»˜è®¤ä½ç½®ä¸ºæ–‡ä»¶å¼€å¤´ï¼Œè¯»å®Œä»¥åç§»åˆ°ç»“å°¾</li>
<li>ç”¨<code>w+</code>çš„æ–¹å¼è¯»å†™æ–‡ä»¶ï¼Œæ¸…ç©ºæ–‡ä»¶å†…å®¹ä»¥åè¯»å†™</li>
<li>ç”¨<code>a+</code>çš„æ–¹å¼è¯»å†™æ–‡ä»¶ï¼Œé»˜è®¤ä½ç½®æ˜¯æ–‡ä»¶æœ«å°¾</li>
<li>å¸¦+çš„éƒ½æ˜¯å¯è¯»å¯å†™ï¼Œä¸å¸¦+çš„åˆ™åªæœ‰è¯»æˆ–è€…å†™</li>
</ol>
</li>
<li>æ”¹å˜æ–‡ä»¶è¯»å†™ä½ç½®ï¼š<code>seek(offset, whence=0)</code>ï¼Œä»whence(0èµ·å§‹ï¼Œ1å½“å‰ï¼Œ2æœ«å°¾)åç§»offsetä¸ªå­—èŠ‚ã€‚ä¾‹å¦‚<code>f.seek(0)</code>å¯ä»¥æŠŠæ–‡ä»¶æŒ‡é’ˆæ”¾åˆ°æœ€å¼€å§‹çš„åœ°æ–¹ã€‚</li>
<li>å­—ç¬¦å­—èŠ‚è¯´æ˜ï¼šutf-8ç¼–ç ä¸­æ–‡3å­—èŠ‚è‹±æ–‡1å­—èŠ‚ï¼›gbkç¼–ç ä¸­æ–‡2å­—èŠ‚è‹±æ–‡1å­—èŠ‚</li>
</ol>
</li>
<li><p>äºŒè¿›åˆ¶æ–‡ä»¶æ“ä½œï¼š</p>
<ol>
<li>openå‡½æ•°çš„æ‰“å¼€æ¨¡å¼ä¸º<code>b</code></li>
</ol>
</li>
<li><p>CSVæ–‡ä»¶ï¼šæ–‡æœ¬æ–‡ä»¶</p>
<ol>
<li>ç”±è‹¥å¹²æ¡è®°å½•ç»„æˆï¼Œæ¯æ¡è®°å½•ç”±å­—æ®µç»„æˆï¼Œå­—æ®µé—´ç”±åˆ† éš”ç¬¦åˆ†å¼€ï¼Œæœ€å¸¸è§çš„åˆ†éš”ç¬¦æ˜¯é€—å·ï¼Œä¹Ÿå¯ä»¥æ˜¯åˆ¶è¡¨ç¬¦ã€åˆ†å·ç­‰</li>
<li>åˆ—è¡¨è¯»å†™ï¼š<code>csv.reader</code>å’Œ<code>csv.writer</code></li>
<li>å­—å…¸è¯»å†™ï¼š<code>csv.DictReader</code>å’Œ<code>csv.DictWriter</code></li>
<li><code>csv.reader(csvfile, dialect=â€˜excelâ€™, **fmtparams)</code>ï¼šä»¥å­—ç¬¦ä¸²åˆ—è¡¨çš„å½¢å¼è¯»å…¥æ–‡ä»¶å†…å®¹ï¼Œä¸€è¡Œæ˜¯ä¸€ä¸ªåˆ—è¡¨<ol>
<li>æ˜¯å¯è¿­ä»£å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡<code>next</code>è®¿é—®ï¼Œæ¯”å¦‚è¯»å®Œæ–‡ä»¶å…ˆç”¨nextæŠŠç¬¬ä¸€è¡Œå­˜åœ¨æ ‡é¢˜å˜é‡é‡Œï¼Œå†éå†å‰©ä¸‹çš„å†…å®¹</li>
</ol>
</li>
<li><code>csv.writer(csvfile, dialect=â€˜excelâ€™, **fmtparams)</code>ï¼šæŠŠå­—ç¬¦ä¸²åˆ—è¡¨å†™å…¥csvæ–‡ä»¶ï¼Œæ³¨æ„å…ˆå†™å…¥æ ‡é¢˜è¡Œï¼Œå†å†™å…¥å‰©ä¸‹å†…å®¹</li>
<li><code>csv.DictReader(csvfile, fieldnames=None, restkey=None, restval=None, dialect=â€˜excelâ€™, *args, **kwds)</code>å­—å…¸æ–¹å¼è¯»å…¥ï¼Œæ ‡é¢˜æ˜¯keyï¼Œå†…å®¹æ˜¯value<ol>
<li>csvæ–‡ä»¶æ²¡æœ‰æ ‡é¢˜è¡Œæ—¶ï¼Œå¯ä»¥è®¾å®šåˆ—è¡¨æŒ‡å®šæ ‡é¢˜è¡Œï¼Œç„¶å<code>csv.DictReader(f,headers)</code>æ¥å»ºç«‹å†…å®¹å’Œæ ‡é¢˜ä¸€ä¸€å¯¹åº”çš„å­—å…¸</li>
</ol>
</li>
<li><code>csv.DictWriter(csvfile, fieldnames, restval=â€˜â€™, extrsaction=â€˜raiseâ€™, dialect=â€˜excelâ€™, *args, **kwds)</code> è¦æŒ‡å®šæ ‡é¢˜è¡Œå’Œå†…å®¹ï¼Œåœ¨åˆ›å»ºcsvå¯¹è±¡æ—¶å°±æŒ‡å®šæ ‡é¢˜ï¼Œæ¥ä¸‹æ¥å†™å…¥æ ‡é¢˜ï¼Œæœ€åå†™å…¥å†…å®¹</li>
</ol>
</li>
</ol>
<h3 id="éšå ‚ç»ƒä¹ "><a href="#éšå ‚ç»ƒä¹ " class="headerlink" title="éšå ‚ç»ƒä¹ "></a>éšå ‚ç»ƒä¹ </h3><ol>
<li><p>è¯»å…¥ã€ŠDeclaration.txtã€‹æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶é‡Œå­˜çš„æ˜¯ä¸€ç¯‡è‹±æ–‡æ–‡ç«  ï¼Œè¦æ±‚æŠŠè¿™ç¯‡æ–‡ç« ä¸­çš„ä¸é‡å¤å•è¯ï¼ˆå•è¯çš„ä¸åŒæ—¶æ€ä»¥åŠå•å¤æ•°éƒ½ çœ‹æˆæ˜¯ä¸åŒçš„å•è¯ï¼‰è¿›è¡Œæ’åºåå†™å…¥ä¸€ä¸ªæ–°çš„txtæ–‡ä»¶ï¼Œå¹¶è¦æ±‚æ¯è¡Œ 5ä¸ªå•è¯ï¼ŒåŒæ—¶æ³¨æ„å¯¹é½ã€‚</p>
<p>æ€è·¯ï¼š</p>
<ol>
<li><p>ä½¿ç”¨<code>with open</code>æ–¹å¼è¯»å…¥æ–‡ä»¶å¹¶æŠŠå…¶ä¸­çš„å•è¯å­˜å…¥åˆ—è¡¨ï¼›</p>
</li>
<li><p>å€ŸåŠ©<code>Counter</code>ç»Ÿè®¡è¯é¢‘å’Œæ’åº</p>
</li>
<li><p>æŠŠæ’åºä¹‹åçš„åˆ—è¡¨å†™å…¥æ–°æ–‡ä»¶</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="comment"># è¯»å…¥æ–‡ä»¶å†…å®¹ï¼ŒæŠŠå•è¯å­˜å…¥åˆ—è¡¨å¹¶è¿”å›</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">strtolist</span><span class="params">(name)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open (name,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        s = f.read()</span><br><span class="line">    words = re.findall(<span class="string">r'[a-zA-Z]+'</span>,s)</span><br><span class="line">    <span class="keyword">return</span> words</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹åˆ—è¡¨ä¸­çš„å•è¯æŒ‰å­—æ¯é¡ºåºæ’åºå¹¶è¿”å›</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sortword</span><span class="params">(words)</span>:</span></span><br><span class="line">    list1 = collections.Counter(words)</span><br><span class="line">    list2 = sorted(list1.items())</span><br><span class="line">    list3 = []</span><br><span class="line">    <span class="keyword">for</span> key, value <span class="keyword">in</span> list2:</span><br><span class="line">        list3.append(key)</span><br><span class="line">    <span class="keyword">return</span> list3</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠŠåˆ—è¡¨ä¸­çš„å…ƒç´ æŒ‰è¦æ±‚å†™å…¥æ–‡ä»¶</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">writefile</span><span class="params">(lists)</span>:</span></span><br><span class="line">    count=<span class="number">0</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'wordlist.txt'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> lists:</span><br><span class="line">            f.write(<span class="string">'&#123;:&lt;16&#125;'</span>.format(i))</span><br><span class="line">            f.write(<span class="string">'\t'</span>)</span><br><span class="line">            count+=<span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> count % <span class="number">5</span> == <span class="number">0</span>:</span><br><span class="line">                f.write(<span class="string">'\n'</span>)</span><br><span class="line">                </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    words = strtolist(<span class="string">'Declaration.txt'</span>)</span><br><span class="line">    lists = sortword(words)</span><br><span class="line">    writefile(lists)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>è¯»å…¥å­˜æœ‰å§“åå’Œæˆç»©çš„ æˆç»©å•.csv æ–‡ä»¶ï¼Œè®¡ç®—æœ€ç»ˆåŠ æƒæˆç»©ï¼ˆ å°æ•°ç‚¹åä¿ç•™ä¸¤ä½ï¼Œä¸‰ä¸ªæˆç»©çš„æƒé‡åˆ†åˆ«ä¸º0.22,0.18,0.6ï¼‰ï¼Œå¹¶ æŠŠè¯¥æˆç»©è¿½åˆ°åˆ°åŸæœ‰ä¿¡æ¯ä¸­ï¼Œä¿å­˜ä¸ºä¸€ä¸ªæ–°çš„csvæ–‡ä»¶ã€‚</p>
<p>æ€è·¯ï¼š</p>
<ol>
<li><p>è¯»å…¥csvæ–‡ä»¶ï¼Œå¹¶ä¸ºæ ‡é¢˜è¡Œæ·»åŠ â€œæœ€ç»ˆæˆç»©â€</p>
</li>
<li><p>è®¡ç®—å¹³å‡åˆ†å¹¶æ·»åŠ åˆ°è¿™ä¸€è¡Œçš„æœ«å°¾ï¼Œä¿ç•™2ä½å°æ•°</p>
</li>
<li><p>æŠŠè¿™ä¸€è¡Œçš„æ•°æ®å­˜åˆ°åˆ—è¡¨ä¸­</p>
</li>
<li><p>æŠŠåˆšæ‰çš„å†…å®¹é€è¡Œå†™å…¥æ–°çš„csvæ–‡ä»¶ï¼Œæ³¨æ„è¿™é‡Œè¦åœ¨ä¹‹å‰é‚£ä¸ªæ–‡ä»¶å…³é—­ä¹‹å‰å®Œæˆ</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> pandas</span><br><span class="line"><span class="keyword">with</span> open (<span class="string">'æˆç»©å•.csv'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f_csv=csv.reader(f)</span><br><span class="line">    headers = next(f_csv)</span><br><span class="line">    headers.append(<span class="string">'æœ€ç»ˆæˆç»©'</span>)</span><br><span class="line">    lists = []</span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> f_csv:</span><br><span class="line">        avg = <span class="number">0.22</span>*int(row[<span class="number">1</span>])+<span class="number">0.18</span>*int(row[<span class="number">2</span>])+<span class="number">0.6</span>*int(row[<span class="number">3</span>])</span><br><span class="line">        row.append(avg)</span><br><span class="line">        row[<span class="number">4</span>]=str(<span class="string">'&#123;:.2f&#125;'</span>.format(row[<span class="number">4</span>]))</span><br><span class="line">        lists.append(row)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'æ–°æˆç»©å•.csv'</span>,<span class="string">'w'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> s:</span><br><span class="line">        s_csv=csv.writer(s)</span><br><span class="line">        s_csv.writerow(headers)</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> lists:</span><br><span class="line">            s_csv.writerow(row)</span><br></pre></td></tr></table></figure>

</li>
</ol>
</li>
</ol>
]]></content>
      <categories>
        <category>è¯¾ç¨‹ç¬”è®°</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonè¯¾ç¨‹è®°å½•-7</title>
    <url>/2020/04/16/python%E8%AF%BE%E7%A8%8B%E8%AE%B0%E5%BD%95-7/</url>
    <content><![CDATA[<p>è¿™ä¸€è¯¾è®²pythonä¸­å‡½æ•°å’Œæ¨¡å—çš„ä½¿ç”¨ã€‚</p>
<a id="more"></a>

<h2 id="å‡½æ•°å‚æ•°"><a href="#å‡½æ•°å‚æ•°" class="headerlink" title="å‡½æ•°å‚æ•°"></a>å‡½æ•°å‚æ•°</h2><ol>
<li><p>å‡½æ•°å®šä¹‰æ—¶å¯ä»¥ä¸ºå‚æ•°æŒ‡å®šé»˜è®¤å€¼ï¼Œè¿™æ ·æ²¡ä¼ å‚çš„æ—¶å€™å°±ä¼šç”¨é»˜è®¤å€¼ï¼Œè¦å…ˆå£°æ˜æ²¡é»˜è®¤å€¼çš„å‚æ•°ï¼Œå†å£°æ˜æœ‰é»˜è®¤å€¼çš„ã€‚</p>
</li>
<li><p>è°ƒç”¨å‡½æ•°æ—¶å¯ä»¥ç›´æ¥æŒ‡æ˜å‚æ•°å€¼ï¼ˆ<code>mysum1(score1 = 88, score2 = 79)</code>)ï¼Œä¸æŒ‡æ˜çš„å‚æ•°å†™å‰é¢ï¼ŒæŒ‡æ˜çš„æ”¾åé¢ã€‚</p>
</li>
<li><p>æŒ‡é’ˆï¼ˆ*ï¼‰å½¢å¼ä¼ é€’å¯å˜å‚æ•°ï¼Œä»¥å…ƒç»„å½¢å¼æ‰“åŒ…å¤šå‡ºæ¥çš„å‚æ•°ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_sum2</span><span class="params">(a,b,*c)</span>:</span></span><br><span class="line">	total=a+b</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> c:</span><br><span class="line">        total=total+n</span><br><span class="line">    <span class="keyword">return</span> total</span><br><span class="line"></span><br><span class="line">print(my_sum2(<span class="number">1</span>,<span class="number">2</span>))				<span class="comment">#c=()	è¾“å‡º3</span></span><br><span class="line">print(my_sum2(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>))		<span class="comment">#c=(3,4,5)	è¾“å‡º15</span></span><br><span class="line">print(my_sum2(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">20</span>))	<span class="comment">#c=(3,4,5,10,20)	è¾“å‡º45</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åŒæŒ‡é’ˆï¼ˆ**ï¼‰å½¢å¼ä¼ é€’å¯å˜å‚æ•°ï¼Œä»¥å­—å…¸å½¢å¼æ‰“åŒ…å¤šå‡ºæ¥çš„å‚æ•°ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_sum3</span><span class="params">(a,b,*c,**d)</span>:</span></span><br><span class="line">	total=a+b</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> c:</span><br><span class="line">        total=total+n</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> d:</span><br><span class="line">        total=total+d[key]</span><br><span class="line">    <span class="keyword">return</span> total</span><br><span class="line"></span><br><span class="line">print(my_sum3(<span class="number">1</span>,<span class="number">2</span>))							<span class="comment">#c=() d=&#123;&#125; è¾“å‡º3</span></span><br><span class="line">print(my_sum3(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>))					<span class="comment">#c=(3,4,5) d=&#123;&#125; è¾“å‡º15</span></span><br><span class="line">print(my_sum3(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,male=<span class="number">6</span>,female=<span class="number">7</span>))	<span class="comment">#c=(3,4,5) d=&#123;'male':6,'female':7&#125; è¾“å‡º28</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><em>æˆ–*</em>çš„å‚æ•°å¦‚æœä¸ä½äºå½¢å‚åˆ—è¡¨çš„æœ€åä½ç½®ï¼Œåˆ™ä¼šä½¿å…¶åé¢å£° æ˜çš„å‚æ•°ä¸ºå¼ºåˆ¶å‘½åå‚æ•°ï¼›ä½¿ç”¨ä¸€ä¸ªæ˜Ÿå·è€Œä¸å¸¦å‚æ•°ï¼Œä¹Ÿå¯å¯¼è‡´å¼ºåˆ¶å‘½åå‚æ•°ã€‚</p>
</li>
<li><p>åˆ—è¡¨ã€å…ƒç»„ã€å­—å…¸å¯é€šè¿‡<em>å’Œ*</em>ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°ã€‚</p>
</li>
<li><p>å½¢å‚å¤åˆ¶äº†å®å‚æ‰€æŒ‡å¯¹è±¡çš„å¼•ç”¨</p>
</li>
</ol>
<h2 id="å‡½æ•°è¿”å›å€¼"><a href="#å‡½æ•°è¿”å›å€¼" class="headerlink" title="å‡½æ•°è¿”å›å€¼"></a>å‡½æ•°è¿”å›å€¼</h2><ol>
<li>è¿”å›å¤šä¸ªå€¼æ—¶ï¼Œæ˜¯å…ƒç»„å½¢å¼ã€‚</li>
</ol>
<h2 id="å˜é‡ä½œç”¨åŸŸ"><a href="#å˜é‡ä½œç”¨åŸŸ" class="headerlink" title="å˜é‡ä½œç”¨åŸŸ"></a>å˜é‡ä½œç”¨åŸŸ</h2><ol>
<li><p>å±€éƒ¨å˜é‡å…¨å±€å˜é‡å’Œå…¶ä»–è¯­è¨€åŸºæœ¬ä¸€è‡´</p>
</li>
<li><p>åªè¦åœ¨å‡½æ•°ä½“å†…æœ‰èµ‹å€¼è¯­å¥ï¼Œä¸ç®¡åœ¨å“ªä¸€è¡Œï¼Œè¿™ä¸ªå˜é‡å°±æ˜¯å±€éƒ¨å˜é‡ï¼Œå‡½æ•°ä½“å†…ä¹Ÿåªä¼šç”¨è¿™ä¸ªå±€éƒ¨å˜é‡ï¼Œè€Œä¸æ˜¯åŒåå…¨å±€å˜é‡ï¼Œä¾‹å¦‚ä¸‹è¿°ä»£ç ä¼šç›´æ¥æŠ¥é”™</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">var=<span class="number">1</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">()</span>:</span></span><br><span class="line">    print(var)</span><br><span class="line">    var=<span class="number">200</span></span><br><span class="line">fun()</span><br><span class="line"></span><br><span class="line">var=<span class="number">1</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">()</span>:</span></span><br><span class="line">    var+=<span class="number">1</span></span><br><span class="line">    print(var)</span><br><span class="line">fun()</span><br><span class="line"></span><br><span class="line">æŠ¥é”™ä¿¡æ¯ï¼šlocal variable <span class="string">'var'</span> referenced before assignment</span><br></pre></td></tr></table></figure>
</li>
<li><p>å‡½æ•°ä½“å†…ç”¨å…¨å±€å˜é‡ï¼Œè¦å£°æ˜<code>global</code></p>
</li>
<li><p>å‡½æ•°åµŒå¥—å‡½æ•°æ—¶ï¼Œå†…å±‚å‡½æ•°å˜é‡ä½œç”¨åŸŸåªåœ¨å†…å±‚ï¼Œä¸å½±å“å¤–å±‚ï¼Œå¦‚æœè¦å†…å±‚ç”¨å¤–å±‚çš„ï¼Œè¦å£°æ˜<code>nonlocal</code></p>
</li>
</ol>
<h2 id="ç‰¹æ®Šå‡½æ•°"><a href="#ç‰¹æ®Šå‡½æ•°" class="headerlink" title="ç‰¹æ®Šå‡½æ•°"></a>ç‰¹æ®Šå‡½æ•°</h2><ol>
<li><p>é€’å½’</p>
</li>
<li><p>å‡½æ•°å¯ä»¥ä½œä¸ºå…¶ä»–å‡½æ•°çš„å‚æ•°</p>
</li>
<li><p>lambdaåŒ¿åå‡½æ•°ï¼šå®ç°è¡Œå†…å‡½æ•° <code>lambda å½¢å‚åˆ—è¡¨:è¿”å›çš„ç»“æœ</code></p>
<p>ä¾‹å¦‚ï¼š<code>f=lambda x,y: x+y</code>ï¼Œ<code>f(12,34)=46</code></p>
</li>
<li><p>mapå‡½æ•°ï¼šä»¥æŠŠä¸€ä¸ªå‡½æ•°ä½œç”¨åˆ°å¯è¿­ä»£å¯¹è±¡ï¼ˆå¦‚åˆ—è¡¨ï¼‰çš„æ¯ä¸€ä¸ª å…ƒç´ ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a=[<span class="number">-2</span>,<span class="number">1</span>,<span class="number">3</span>]</span><br><span class="line">b=map(<span class="keyword">lambda</span> x: x+<span class="number">2</span>, a)</span><br><span class="line">print(b)	<span class="comment">#bæ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œprintå¾—åˆ°å®ƒçš„åœ°å€ï¼Œforå¾ªç¯è¾“å‡ºå¯çŸ¥b=0,3,5</span></span><br><span class="line">c=map(abs, a)</span><br><span class="line">c=list(c)</span><br><span class="line">print(c)	<span class="comment">#c=[2,1,3]</span></span><br><span class="line">d=map(<span class="keyword">lambda</span> x,y: x+y, a,c)</span><br><span class="line">print(list(d))	<span class="comment">#è¾“å‡º[0,2,6]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>filterå‡½æ•°ï¼šç­›é€‰å‡ºå¯è¿­ä»£å¯¹è±¡ä¸­æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼Œ<code>filter( è¿”å›boolç±»å‹çš„å‡½æ•°, å¯è¿­ä»£å¯¹è±¡)</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a=filter(<span class="keyword">lambda</span> x: x&gt;<span class="number">0</span>, (<span class="number">-1</span>,<span class="number">2</span>,<span class="number">-3</span>,<span class="number">0</span>,<span class="number">5</span>))</span><br><span class="line">print(list(a))		<span class="comment"># [2,5]</span></span><br><span class="line">b=filter(str.isalpha, (<span class="string">'word'</span>,<span class="string">','</span>,<span class="string">'\n'</span>,<span class="string">'$'</span>,<span class="string">'1'</span>))</span><br><span class="line">print(list(b))		<span class="comment"># ['word']</span></span><br><span class="line">c=filter(<span class="literal">None</span>,(<span class="number">-1</span>,<span class="number">2</span>,<span class="number">-3</span>,<span class="number">0</span>,<span class="number">5</span>))</span><br><span class="line">print(list(b))		<span class="comment"># [-1,2,-3,5] ä¼ å…¥Noneæ—¶ä¼šæŠŠåºåˆ—ä¸­çš„falseå€¼æ¯”å¦‚0ã€ç©ºå€¼ç­‰éƒ½å»æ‰</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>reduceå‡½æ•°ï¼šå¯¹å¯è¿­ä»£å¯¹è±¡çš„å…ƒç´ è¿›è¡Œé€’å½’è®¡ç®—ï¼Œ<code>reduce( å¸¦ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°, å¯è¿­ä»£å¯¹è±¡)</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a=functools.reduce(operator.add,[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>])</span><br><span class="line">print(a)	<span class="comment">#25</span></span><br><span class="line">b=functools.reduce(<span class="keyword">lambda</span> x,y:x+y,[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>])</span><br><span class="line">print(b)	<span class="comment">#25</span></span><br></pre></td></tr></table></figure>



</li>
</ol>
<h3 id="è¯¾åç»ƒä¹ "><a href="#è¯¾åç»ƒä¹ " class="headerlink" title="è¯¾åç»ƒä¹ "></a>è¯¾åç»ƒä¹ </h3><ol>
<li><p>å¯¹ç¬¬äºŒæ¬¡ä½œä¸šè¿›è¡Œå‡½æ•°å°è£…ï¼ŒæŒ‰åŠŸèƒ½å°è£…æˆå‡ ä¸ªå‡½æ•°ã€‚</p>
<p>è¿™ä¸ªæ²¡å•¥è¯´çš„ï¼Œæœ¬æ¥å°±æ˜¯ç”¨å‡½æ•°å†™çš„ã€‚</p>
</li>
<li><p>åˆ©ç”¨mapã€filterã€reduceã€lambdaå‡½æ•°ï¼Œå¯¹ä¸€ä¸ªå…ƒç´ ä¸ºæ•°å­— å­—ç¬¦ä¸²çš„åˆ—è¡¨ï¼Œåˆ†åˆ«æ±‚å‡ºå…¶ä¸­åŒ…å«çš„æ‰€æœ‰å¥‡æ•°çš„ä¹˜ç§¯ä»¥åŠæ‰€æœ‰ å¶æ•°çš„ä¹˜ç§¯ã€‚</p>
<p>æ€è·¯ï¼šé¦–å…ˆè¦æŠŠåˆ—è¡¨<code>l</code>çš„å…ƒç´ ä»å­—ç¬¦ä¸²è½¬æˆæ•´æ•°ï¼Œä»è€Œæ‰èƒ½è¿›è¡Œå¥‡å¶æ€§åˆ¤æ–­å’Œä¹˜æ³•è¿ç®—ï¼Œè¿™é‡Œç”¨<code>map</code>å‡½æ•°æ¥å®Œæˆï¼›æ¥ä¸‹æ¥ç”¨<code>filter</code>å‡½æ•°å°±å¯ä»¥æŠŠå¥‡æ•°å’Œå¶æ•°åˆ†åˆ«æ”¾åˆ°ä¸¤ä¸ªåˆ—è¡¨ä¸­ï¼Œæœ€åç”¨<code>reduce</code>å‡½æ•°å³å¯è¿›è¡Œä¹˜æ³•è¿ç®—ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> functools</span><br><span class="line">l=[<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>,<span class="string">'14'</span>,<span class="string">'20'</span>,<span class="string">'5'</span>,<span class="string">'7'</span>,<span class="string">'39'</span>,<span class="string">'150'</span>,<span class="string">'6'</span>]</span><br><span class="line">m=list(map(<span class="keyword">lambda</span> x: int(x), l))</span><br><span class="line">a=filter(<span class="keyword">lambda</span> x: x%<span class="number">2</span>==<span class="number">0</span>, m)</span><br><span class="line">b=functools.reduce(<span class="keyword">lambda</span> x,y:x*y,list(a))</span><br><span class="line">c=filter(<span class="keyword">lambda</span> x: x%<span class="number">2</span>==<span class="number">1</span>, m)</span><br><span class="line">d=functools.reduce(<span class="keyword">lambda</span> x,y:x*y,list(c))</span><br><span class="line">print(<span class="string">'å¶æ•°ä¹˜ç§¯æ˜¯'</span>,b)</span><br><span class="line">print(<span class="string">'å¥‡æ•°ä¹˜ç§¯æ˜¯'</span>,d)</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¬¬ä¸€æ¬¡ä½œä¸šç¬¬ä¸‰é¢˜æ‰“å°ç»“æœä¸º24çš„è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬é€šè¿‡åµŒå¥—å¾ªç¯ å¾—åˆ°åˆ—è¡¨çš„å…¨æ’åˆ—ï¼Œè¯•è¯•é‡‡ç”¨é€’å½’å‡½æ•°æ±‚å…¨æ’åˆ—ã€‚</p>
<p>æ€è·¯ï¼š</p>
<ol>
<li><p>åˆ—è¡¨åªæœ‰1ä¸ªå…ƒç´ æ—¶ï¼Œå…¨æ’åˆ—å°±æ˜¯åˆ—è¡¨æœ¬èº«ï¼›</p>
</li>
<li><p>åˆ—è¡¨æœ‰2ä¸ªå…ƒç´ æ—¶ï¼Œå…¨æ’åˆ—æ˜¯[a,b]å’Œ[b,a]ï¼›</p>
</li>
<li><p>åˆ—è¡¨æœ‰nä¸ªå…ƒç´ æ—¶ï¼Œå°†ç¬¬ä¸€ä¸ªå…ƒç´ å›ºå®šï¼Œå¯¹å‰©ä¸‹n - 1ä¸ªå…ƒç´ è¿›è¡Œå…¨æ’åˆ—ã€‚å†å°†ç¬¬ä¸€ä¸ªå…ƒç´ ä¾æ­¤ä¸å…¶ä»–å…ƒç´ äº¤æ¢ï¼Œå¯¹æ¯æ¬¡äº¤æ¢åå‰©ä¸‹çš„n-1ä¸ªå…ƒç´ è¿›è¡Œå…¨æ’åˆ—ã€‚å¯¹n-1ä¸ªå…ƒç´ çš„å…¨æ’åˆ—å°±æ˜¯ä¸€ä¸ªé€’å½’è¿‡ç¨‹ã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">permutations</span><span class="params">(l, start, end)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> start==end:</span><br><span class="line">        print(l)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i = start</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(start, end): </span><br><span class="line">            l[j], l[i] = l[i], l[j]</span><br><span class="line">            permutations(l, start + <span class="number">1</span>, end)</span><br><span class="line">            l[i], l[j] = l[j], l[i]            </span><br><span class="line">num=[<span class="string">'2'</span>,<span class="string">'3'</span>,<span class="string">'4'</span>,<span class="string">'5'</span>]</span><br><span class="line">permutations(num, <span class="number">0</span>, <span class="number">4</span>)</span><br></pre></td></tr></table></figure>



</li>
</ol>
</li>
</ol>
]]></content>
      <categories>
        <category>è¯¾ç¨‹ç¬”è®°</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>è®ºæ–‡è®°å½•-Privacy Policy in Online Social Network with Targeted Advertising Business</title>
    <url>/2020/04/15/%E8%AE%BA%E6%96%87%E8%AE%B0%E5%BD%95-Privacy-Policy-in-Online-Social-Network-with-Targeted-Advertising-Business/</url>
    <content><![CDATA[<h2 id="åœ¨çº¿ç¤¾äº¤ç½‘ç»œéšç§æ”¿ç­–ä¸å®šå‘å¹¿å‘Šä¸šåŠ¡"><a href="#åœ¨çº¿ç¤¾äº¤ç½‘ç»œéšç§æ”¿ç­–ä¸å®šå‘å¹¿å‘Šä¸šåŠ¡" class="headerlink" title="åœ¨çº¿ç¤¾äº¤ç½‘ç»œéšç§æ”¿ç­–ä¸å®šå‘å¹¿å‘Šä¸šåŠ¡"></a>åœ¨çº¿ç¤¾äº¤ç½‘ç»œéšç§æ”¿ç­–ä¸å®šå‘å¹¿å‘Šä¸šåŠ¡</h2><a id="more"></a>

<h4 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h4><ol>
<li>ç¤¾äº¤ç½‘ç»œæä¾›å•†SNPåˆ©ç”¨ç”¨æˆ·ä¿¡æ¯å®ç°å®šå‘æŠ•æ”¾å¹¿å‘Šï¼Œå¹¿å‘Šå•†ä»˜è´¹</li>
<li>éšç§æ”¿ç­–ï¼šSNPåº”è¯¥åˆ©ç”¨çš„ç”¨æˆ·ä¿¡æ¯æ¯”ä¾‹</li>
<li>ç”¨æˆ·ã€å¹¿å‘Šå•†ã€SNPâ€”â€”&gt;ä¸‰é˜¶æ®µstackelbergåšå¼ˆ</li>
<li>æ›´é«˜çš„ä¿¡æ¯åˆ©ç”¨å°†é˜»ç¢ç”¨æˆ·å±•ç¤ºä¿¡æ¯ï¼Œé™ä½è¢«åˆ©ç”¨ä¿¡æ¯çš„æ€»é‡ï¼Œå¹¶æŸå®³å¹¿å‘Šæ”¶å…¥ï¼ŒåŸºäºç”¨æˆ·ä¿¡æ¯ç­‰çº§ä¸éšç§ç­–ç•¥ä¹‹é—´çš„å…³è”ï¼Œè¿›ä¸€æ­¥åˆ»ç”»å‡ºæœ€ä¼˜éšç§ç­–ç•¥ã€‚</li>
</ol>
<h4 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h4><ol>
<li>å¹¿å‘Šå•†å†³å®šæ”¯ä»˜çš„å¹¿å‘Šè´¹ï¼ˆæ›´å¤šæ•°æ®æ„å‘³ç€æ›´ç²¾å‡†æŠ•æ”¾â€”â€”&gt;æ›´é«˜çš„å¹¿å‘Šè´¹ï¼‰ï¼šå¹¿å‘Šå•†å¦‚ä½•åœ¨ç”¨æˆ·ä¿¡æ¯åˆ©ç”¨æ‰€é™åˆ¶çš„æŠ•æ”¾ç²¾å‡†åº¦çš„åŸºç¡€ä¸Šè¿›è¡Œå¹¿å‘ŠæŠ•æ”¾ï¼Œä»¥å®ç°é¢„æœŸæ”¶ç›Šçš„æœ€å¤§åŒ–?</li>
<li>ç”¨æˆ·å†³å®šåœ¨ç¤¾äº¤å¹³å°çš„æ´»è·ƒåº¦ï¼ˆæ›´å¥½çš„éšç§ä¿æŠ¤â€”â€”&gt;æ›´æ´»è·ƒï¼‰ï¼šåœ¨éšç§å—åˆ°ä¾µçŠ¯çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·åœ¨ç¤¾äº¤æ´»åŠ¨ä¸­æš´éœ²è‡ªå·±çš„ç¨‹åº¦å¦‚ä½•?</li>
<li>SNPå†³å®šéšç§æ”¿ç­–ï¼ˆå¹¿å‘Šè´¹å’Œç”¨æˆ·æ´»è·ƒåº¦çš„æƒè¡¡ï¼‰ï¼šSNPå¦‚ä½•é‡‡å–é€‚å½“çš„éšç§æ”¿ç­–æ¥æœ€å¤§åŒ–ä»–çš„æ•ˆç”¨ï¼ŒåŒ…æ‹¬ç¤¾ä¼šç½‘ç»œæ•ˆç›Šå’Œç›®æ ‡å¹¿å‘Šæ”¶å…¥?</li>
</ol>
<h4 id="System-Model"><a href="#System-Model" class="headerlink" title="System Model"></a>System Model</h4><ol>
<li>ç”¨æˆ·ï¼Œå†³å®šæ´»è·ƒåº¦ï¼ˆåœ¨ç¤¾äº¤å¹³å°ä¸Šå‘å¸ƒçš„ä¿¡æ¯ç­‰çº§ï¼‰ï¼Œæ”¶ç›Šä¸‰éƒ¨åˆ†ç›¸åŠ ç»„æˆï¼š<ol>
<li>ç½‘ç»œæ”¶ç›Šï¼šç”¨æˆ·åœ¨ç¤¾äº¤å¹³å°ä¸Šè¿›è¡Œç¤¾äº¤äº’åŠ¨æ‰€å¾—åˆ°çš„çš„æ”¶ç›Šï¼Œç”±ç”¨æˆ·è‡ªå·±çš„éšç§ç­‰çº§å’Œå…¶ä»–ç”¨æˆ·çš„éšç§ç­‰çº§å…±åŒå†³å®šï¼Œè¿™éƒ¨åˆ†æ˜¯ä¸€ä¸ªå¯¹æ•°å‡½æ•°ï¼ˆæ ¹æ®æ¢…ç‰¹å¡å¤«å®šå¾‹å†³å®šå‡½æ•°å½¢å¼ï¼‰</li>
<li>éšç§æŸå¤±ï¼šç”±ã€ç”¨æˆ·æä¾›ä¿¡æ¯çš„ç¨‹åº¦å’ŒSNPçš„éšç§ç­‰çº§ã€‘å¯¹åº”çš„å‡½æ•°å…±åŒå†³å®šï¼ˆç›¸ä¹˜ï¼‰ï¼Œæ˜¯ä¸€ä¸ªå¢å‡½æ•°</li>
<li>è¡¥è´´ï¼šSNPé¼“åŠ±ç”¨æˆ·åœ¨ç¤¾äº¤å¹³å°ç§¯ææ´»è·ƒï¼Œä¼šæä¾›å›ºå®šçš„è¡¥è´´ï¼Œç”¨æˆ·æœ‰ä¸€å®šæ¦‚ç‡æ‹¿åˆ°ï¼Œæ‹¿åˆ°çš„æ¦‚ç‡ç”±ã€ç”¨æˆ·æä¾›ä¿¡æ¯çš„ç¨‹åº¦å’ŒSNPçš„éšç§ç­‰çº§ã€‘å¯¹åº”çš„å‡½æ•°å…±åŒå†³å®šï¼ˆç›¸ä¹˜ï¼‰</li>
</ol>
</li>
<li>å¹¿å‘Šå•†ï¼Œå†³å®šå¹¿å‘Šè´¹ï¼Œæ”¶ç›Šä¸¤éƒ¨åˆ†ç›¸ä¹˜ç»„æˆï¼š<ol>
<li>ä¸€ä¸ªç”¨æˆ·ä¹°è¯¥äº§å“çš„å‡€æ”¶ç›Šï¼ˆè€ƒè™‘æ ¸ç®—æ”¶å…¥å’Œç”Ÿäº§æˆæœ¬ï¼‰</li>
<li>ç›®æ ‡ç”¨æˆ·çœ‹äº†å¹¿å‘Šä»¥åä¹°äº§å“çš„æ¦‚ç‡ï¼Œä¸¤éƒ¨åˆ†ç›¸åŠ ç»„æˆï¼š<ol>
<li>ç”±ã€ç”¨æˆ·æä¾›ä¿¡æ¯çš„ç¨‹åº¦å’ŒSNPçš„éšç§ç­‰çº§ã€‘å¯¹åº”çš„æ¦‚ç‡</li>
<li>æŠ•æ”¾ä¸ç²¾å‡†çš„æƒ…å†µä¸‹ï¼ˆä¸èƒ½ä¾é SNPæ—¶ï¼‰çš„å…ˆéªŒæ¦‚ç‡ï¼ˆå°±æ˜¯å¹¿å‘Šç»™ä¸æ„Ÿå…´è¶£çš„äººæ”¾äº†ä¹‹åè¿™ä¸ªäººæ¥ä¹°çš„æ¦‚ç‡ï¼‰</li>
</ol>
</li>
<li>ä¸Šè¿°ä¸¤éƒ¨åˆ†ç›¸ä¹˜æ˜¯ä¸€ä¸ªç”¨æˆ·å¸¦æ¥çš„æ”¶ç›Šï¼Œå¹¿å‘Šå•†æ€»æ”¶ç›Šæ˜¯æŠŠæ‰€æœ‰ç›®æ ‡ç”¨æˆ·çš„åŠ èµ·æ¥ï¼Œå†å‡å»æ”¯ä»˜ç»™SNPçš„å¹¿å‘Šè´¹</li>
</ol>
</li>
<li>SNPï¼Œå†³å®šéšç§æ”¿ç­–å’Œç›®æ ‡å¹¿å‘Šè´¹ï¼Œæ”¶ç›Šä¸‰éƒ¨åˆ†ç›¸åŠ ï¼ˆå‡ï¼‰ç»„æˆï¼š<ol>
<li>ç¤¾äº¤ç½‘ç»œä»·å€¼ï¼šç”¨æˆ·æ´»è·ƒå¸¦æ¥çš„æ”¶ç›Šï¼Œè¦å»æ‰å¯¹ç”¨æˆ·æ´»è·ƒåº¦çš„è¡¥è´´</li>
<li>ç›®æ ‡å¹¿å‘Šæ”¶ç›Šï¼šå•ä¸ªç”¨æˆ·çš„å¹¿å‘Šè´¹*ç›®æ ‡ç”¨æˆ·</li>
<li>éšç§é—®é¢˜ï¼šå‡ºç°éšç§é—®é¢˜æ—¶æ‰€é¢ä¸´çš„é‡‘é’±ã€åèª‰æŸå¤±ï¼Œæœ‰æ¦‚ç‡ï¼Œæ³„éœ²è¶Šå¤šæŸå¤±è¶Šå¤§</li>
</ol>
</li>
<li>stackelbergåšå¼ˆï¼š<ol>
<li>ç¬¬ä¸€é˜¶æ®µSNPè€ƒè™‘ç”¨æˆ·å’Œå¹¿å‘Šå•†çš„å†³ç­–æ¥å†³å®šéšç§ç­‰çº§å’Œå¹¿å‘Šè´¹</li>
<li>ç¬¬äºŒé˜¶æ®µç”¨æˆ·æ ¹æ®éšç§æ”¿ç­–å†³å®šæ´»è·ƒåº¦</li>
<li>ç¬¬ä¸‰é˜¶æ®µå¹¿å‘Šå•†æ ¹æ®ç”¨æˆ·ä¿¡æ¯å’Œå¹¿å‘Šè´¹å†³å®šæ˜¯å¦æŠ•æ”¾å¹¿å‘Š</li>
</ol>
</li>
</ol>
<h4 id="Advertiserâ€™s-Decision"><a href="#Advertiserâ€™s-Decision" class="headerlink" title="Advertiserâ€™s Decision"></a>Advertiserâ€™s Decision</h4><ol>
<li>ç®€å•çš„è®©æ”¶ç›Šå¤§äºå¹¿å‘Šè´¹ï¼Œç„¶åæ˜¾ç„¶éšç§æ”¿ç­–è¶Šå¤§ï¼ˆSNPæ³„éœ²ç”¨æˆ·ä¿¡æ¯è¶Šå¤šæˆ–ç”¨æˆ·è‡ªå·±æš´éœ²è¶Šå¤šï¼‰ï¼Œå¹¿å‘Šå•†è¶Šå®¹æ˜“æŒ£é’±</li>
</ol>
<h4 id="Usersâ€™-Behavior"><a href="#Usersâ€™-Behavior" class="headerlink" title="Usersâ€™ Behavior"></a>Usersâ€™ Behavior</h4><ol>
<li>å¤šä¸ªç”¨æˆ·ä¹‹é—´çš„äº¤äº’â€”â€”&gt;å¤šç”¨æˆ·ä¿¡æ¯å±•ç¤ºåšå¼ˆâ€”â€”&gt;çº³ä»€å‡è¡¡ï¼šæ‰€æœ‰ç”¨æˆ·éƒ½æ”¶ç›Šæœ€å¤§åŒ–</li>
<li>ä¿¡æ¯å±•ç¤ºåšå¼ˆå…·æœ‰è¶…æ¨¡æ€§ï¼šåšå¼ˆæ–¹è¡Œä¸ºæ˜¯ç´§é›†ï¼Œæ”¶ç›Šå‡½æ•°æ˜¯è¿ç»­å‡½æ•°ä¸”äºŒé˜¶å¯¼å¤§äº0â€”â€”&gt;å½“å…¶ä»–ç©å®¶é€‰æ‹©æ›´é«˜å†³ç­–æ—¶ï¼Œè¯¥ç©å®¶é€‰æ‹©æ›´é«˜å†³ç­–çš„æ•ˆç”¨å¢åŠ å¾—æ›´å¤šâ€”â€”&gt;ä¸€ä¸ªç©å®¶çš„æœ€ä½³ååº”æ˜¯å…¶ä»–ç©å®¶å†³ç­–çš„ä¸€ä¸ªéé€’å‡å‡½æ•°</li>
<li>æ‰€æœ‰ç”¨æˆ·æ´»è·ƒåº¦ä»0å¼€å§‹ï¼Œé€ä¸ªæ ¹æ®å…¶ä»–ç”¨æˆ·çš„æ´»è·ƒåº¦è°ƒæ•´è‡ªå·±çš„æ¥æœ€å¤§åŒ–æ”¶ç›Šï¼Œç›´åˆ°æ”¶æ•›â€”â€”&gt;æœ€å°çº³ä»€å‡è¡¡</li>
<li>å‡è¡¡å±æ€§åˆ†æï¼š<ol>
<li>å‡è®¾ç”¨æˆ·æ•ˆç”¨æ€»çš„æ¥è¯´æ˜¯ä¸€ä¸ªå‡¸å‡½æ•°ï¼ˆæ´»è·ƒåº¦è¶Šé«˜ï¼Œæ´»è·ƒåº¦çš„æé«˜æ‰€å¸¦æ¥çš„æ”¶ç›Šè¶Šå°ï¼Œå’Œè¶…æ¨¡æ€§ä¸å†²çªï¼‰</li>
<li>éšç§æŸå¤±å‡½æ•°æ˜¯å‡¹å‡½æ•°ï¼šè¶Šæ´»è·ƒï¼Œéšç§æŸå¤±è¶Šå¤š</li>
<li>è¡¥è´´å‡½æ•°æ˜¯å‡¸å‡½æ•°ï¼šè¶Šæ´»è·ƒï¼Œè¡¥è´´å¢é•¿è¶Šå°‘</li>
<li>è¡¥è´´è¦èƒ½å¼¥è¡¥éšç§æŸå¤±å‡½æ•°å’Œè¡¥è´´å‡½æ•°çš„å†²çªæ¯”ä¾‹ï¼Œé¿å…å‡ºç°å¤§å®¶éƒ½æ˜¯0çš„åœºé¢ï¼ˆä»è€Œéƒ½æ˜¯0çš„åœºé¢ä¸æ˜¯çº³ä»€å‡è¡¡ï¼‰</li>
<li>å¤„äºNEæ—¶ï¼Œéšç§æ”¿ç­–è¶Šé«˜ï¼Œç”¨æˆ·æ”¶ç›Šè¶Šä½ï¼Œå­˜åœ¨ä¸€ä¸ªéšç§æ”¿ç­–é˜ˆå€¼ï¼Œå°äºè¿™ä¸ªå€¼ï¼ˆåªç”¨å¾ˆå°‘ä¸€éƒ¨åˆ†éšç§ï¼‰ï¼Œç”¨æˆ·ä¼šé€‰æ‹©å®Œå…¨æš´éœ²ä¿¡æ¯ï¼ˆæ´»è·ƒåº¦=1ï¼‰ï¼Œå¤§äºè¯¥å€¼ï¼Œæ´»è·ƒåº¦&lt;1</li>
<li>å½“éšç§æ”¿ç­–å°äºé˜ˆå€¼æ—¶ï¼Œã€ç”¨æˆ·æä¾›ä¿¡æ¯çš„ç¨‹åº¦å’ŒSNPçš„éšç§ç­‰çº§ç›¸ä¹˜ã€‘éšéšç§æ”¿ç­–å¢åŠ è€Œå¢åŠ ï¼›å¤§äºé˜ˆå€¼æ—¶ï¼Œã€ã€‘éšâ€¦å¢åŠ è€Œå‡å°ï¼›ç›´æ¥æ¥è¯´å°±æ˜¯ï¼Œç”¨æˆ·æ„¿æ„å®Œå…¨æš´éœ²ä¿¡æ¯æ—¶ï¼Œæå–æ›´å¤šä¿¡æ¯èƒ½æ›´å¥½åœ°æœåŠ¡ç”¨æˆ·ï¼ˆæˆ–è€…è¯´è¡¥è´´ç­‰ç­‰ç»¼åˆä¸‹æ¥æœ€å¥½ï¼‰ï¼Œåä¹‹ï¼Œåˆ™éšç§æå–è¶Šå°‘è¶Šå¥½äº†</li>
<li>å¦‚æœä¸¤ä¸ªç”¨æˆ·å¯¹ç¤¾äº¤ç½‘ç»œä»·å€¼çš„åˆ¤æ–­ç›¸ç­‰ï¼Œé‚£ä¹ˆä»–ä»¬å‡è¡¡è§£å¯¹åº”çš„æ´»è·ƒåº¦ä¹Ÿç›¸ç­‰ï¼›å¦‚æœä¸ç›¸ç­‰ï¼Œä»·å€¼åˆ¤æ–­é«˜çš„ï¼Œå‡è¡¡è§£æ—¶çš„æ´»è·ƒåº¦ä¹Ÿæ›´é«˜ï¼›ç›´æ¥è¯´å°±æ˜¯ï¼Œæ›´çœ‹é‡ç¤¾äº¤ä»·å€¼çš„ä¼šæ›´å€¾å‘äºé«˜æ´»è·ƒåº¦</li>
</ol>
</li>
</ol>
<h4 id="SNPâ€™s-Decision"><a href="#SNPâ€™s-Decision" class="headerlink" title="SNPâ€™s Decision"></a>SNPâ€™s Decision</h4><ol>
<li>å‡è¡¡è§£æ²¡æœ‰å…·ä½“å½¢å¼â€”â€”&gt;ç”¨æˆ·å‡è¡¡è§£å’Œéšç§æ”¿ç­–ä¹‹é—´çš„å…³ç³»æ¥è¯´æ˜SNPæ•ˆç”¨å‡½æ•°çš„å•è°ƒæ€§</li>
<li>å¹¿å‘Šå•†æ”¶å…¥ä¸­çš„ç”¨æˆ·æ•°é‡æ˜¯ç¦»æ•£çš„ï¼Œä¸”å–å†³äºéšç§æ”¿ç­–å’Œå¹¿å‘Šè´¹</li>
<li>å°†SNPæ•ˆç”¨å‡½æ•°æ‹†å¼€ï¼š<ol>
<li>å¹¿å‘Šè´¹æ”¶ç›Šï¼šå•ä¸ªç”¨æˆ·å¹¿å‘Šè´¹*ç”¨æˆ·ä¸ªæ•°ï¼ˆç”±ç”¨æˆ·æ´»è·ƒåº¦å‡è¡¡è§£ã€éšç§æ”¿ç­–å’Œå•ç”¨æˆ·å¹¿å‘Šè´¹å…±åŒå†³å®šï¼‰ï¼Œé€šè¿‡å¯¹å¹¿å‘Šå•†æ•ˆç”¨å‡½æ•°çš„åˆ†æï¼Œæ‰¾åˆ°å›ºå®šéšç§æ”¿ç­–æ—¶æœ€ä¼˜çš„å•ç”¨æˆ·å¹¿å‘Šè´¹</li>
<li>ç¤¾äº¤ç½‘ç»œæ”¶ç›Šâ€”éšç§é—®é¢˜ï¼šæœ€ä¼˜å¹¿å‘Šè´¹ä½œä¸ºéšç§æ”¿ç­–çš„å‡½æ•°ä»£å…¥ï¼Œå¾—åˆ°æœ€ä¼˜éšç§æ”¿ç­–</li>
</ol>
</li>
<li>æœ€ä¼˜å¹¿å‘Šè´¹å®šä»·é—®é¢˜ï¼š<ol>
<li>æŠŠç”¨æˆ·ä¸ªæ•°é—®é¢˜è½¬åŒ–æˆäº†æ¦‚ç‡é—®é¢˜ï¼šå¹¿å‘Šå•†æœ‰å¤šå¤§æ¦‚ç‡å‘æŸç”¨æˆ·æŠ•æ”¾å¹¿å‘Š</li>
<li>ç¤¾äº¤å‚æ•°ç®€åŒ–ä¸ºä¸¤ä¸ªå€¼ï¼šä¸€é«˜ä¸€ä½</li>
</ol>
</li>
<li>éšç§é—®é¢˜ï¼š<ol>
<li>ç¤¾äº¤å‚æ•°ä¾æ—§åªæœ‰ä¸¤ä¸ªå€¼ï¼Œå¯¹åº”çš„å‡è¡¡è§£çš„éšç§æ”¿ç­–é˜ˆå€¼ä¹Ÿæ˜¯ä¸¤ä¸ªå€¼</li>
<li>å¯ä»¥æ¨å¯¼å‡ºæ•ˆç”¨å‡½æ•°çš„å•è°ƒæ€§</li>
<li>å‡è®¾éšç§é—®é¢˜å‡½æ•°æ˜¯å‡¹å‡½æ•°ï¼Œå¹¿å‘Šå•†æ•ˆç”¨å‡½æ•°æ˜¯å‡¸å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯éšç§é—®é¢˜è¶Šä¸¥é‡ï¼ŒæŸå¤±å¢é•¿å¾—ä¼šè¶Šå¤šï¼Œå¹¿å‘Šå•†ä»ä¸­å¾—åˆ°çš„æ”¶ç›Šå¢é•¿è¶Šå°‘â€”â€”&gt;æ±‚å¯¼åˆ†ææ‰¾æœ€ä¼˜éšç§æ”¿ç­–çš„ç‰¹ç‚¹</li>
</ol>
</li>
</ol>
<h4 id="Numerical-Result"><a href="#Numerical-Result" class="headerlink" title="Numerical Result"></a>Numerical Result</h4><ol>
<li>è¿™éƒ¨åˆ†å¾ˆå°‘ï¼Œæ²¡è¯´æ•°å€¼å®éªŒå…·ä½“æ˜¯æ€ä¹ˆåšçš„</li>
</ol>
]]></content>
      <categories>
        <category>è®ºæ–‡</category>
      </categories>
      <tags>
        <tag>game theory</tag>
        <tag>stackelbergåšå¼ˆ</tag>
      </tags>
  </entry>
  <entry>
    <title>è®ºæ–‡è®°å½•-åˆ†ç‰‡ç›¸å…³</title>
    <url>/2020/04/13/%E8%AE%BA%E6%96%87%E8%AE%B0%E5%BD%95-%E5%88%86%E7%89%87%E7%9B%B8%E5%85%B3/</url>
    <content><![CDATA[<p>å…³äºåŒºå—é“¾åˆ†ç‰‡çš„å‡ ç¯‡è®ºæ–‡ã€‚</p>
<a id="more"></a>

<h2 id="1-RapidChain-Scaling-Blockchain-via-Full-Sharding"><a href="#1-RapidChain-Scaling-Blockchain-via-Full-Sharding" class="headerlink" title="1. RapidChain: Scaling Blockchain via Full Sharding"></a>1. RapidChain: Scaling Blockchain via Full Sharding</h2><h4 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h4><ol>
<li>åˆ†ç‰‡ç›®çš„ï¼šè§£é™¤åŒºå—é“¾æ€§èƒ½å’Œæ‰©å±•æ€§çš„é™åˆ¶</li>
<li>åˆ†ç‰‡å®šä¹‰ï¼šå°†å¤„ç†äº‹åŠ¡çš„å¼€é”€åˆ†é…ç»™å¤šä¸ªæ›´å°çš„èŠ‚ç‚¹ç»„ï¼Œè¿™äº›ç»„å¹¶è¡Œå·¥ä½œä»¥æœ€å¤§é™åº¦åœ°æé«˜æ€§èƒ½ï¼ŒåŒæ—¶æ˜¾è‘—åœ°å‡å°‘æ¯ä¸ªèŠ‚ç‚¹çš„é€šä¿¡ã€è®¡ç®—å’Œå­˜å‚¨ï¼Œä»è€Œå…è®¸ç³»ç»Ÿæ‰©å±•åˆ°å¤§å‹ç½‘ç»œã€‚</li>
<li>ç°æœ‰åˆ†ç‰‡åè®®çš„é—®é¢˜ï¼šæ‰©å±•æ€§å—é™åˆ¶ã€å®‰å…¨æ€§</li>
<li>æœ¬æ–‡RapidChainï¼šå…¬é“¾åˆ†ç‰‡</li>
</ol>
<h4 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h4><ol>
<li><p>èŠ‚ç‚¹åˆ†åˆ°ä¸åŒçš„committeesï¼ŒåŒºå—å’Œè´¦æœ¬å¹¶è¡Œ</p>
</li>
<li><p>ç³»ç»Ÿä¸­ä¸€å…±<code>n</code>ä¸ªèŠ‚ç‚¹ï¼Œåˆ™æ¯ä¸ªcommitteeçš„å¤§å°ä¸º$m=c logn$ï¼Œä¸€å…±æœ‰$k=n/m$ä¸ªcommitteesï¼Œ<code>c</code>æ˜¯ä¸€ä¸ªå’Œå®‰å…¨æœ‰å…³çš„å¸¸æ•°</p>
</li>
<li><p>ä¼˜ç‚¹ï¼š</p>
<ol>
<li>æ¬¡çº¿æ€§é€šä¿¡ï¼šæ¯ä¸ªäº‹åŠ¡çº¿æ€§å¤æ‚åº¦</li>
<li>é«˜å¼¹æ€§ï¼šå¯ä»¥æ¥å—<code>1/3</code>çš„æ¶æ„èŠ‚ç‚¹</li>
<li>å‡å°‘æ¯ä¸ªcommitteeçš„å¼€é”€å’Œå»¶è¿Ÿ</li>
<li>å®‰å…¨æ€§ï¼šæ‹œå åº­å®¹é”™</li>
<li>è·¨åˆ†ç‰‡éªŒè¯ï¼šcommitteesé€šè¿‡è·¯ç”±æœºåˆ¶å‘ç°å…¶ä»–committees</li>
<li>å»ä¸­å¿ƒåŒ–å¼•å¯¼ï¼šæ–°åŠ å…¥èŠ‚ç‚¹çš„è®¾è®¡</li>
</ol>
</li>
<li><p>RapidChainæŒ‰å›ºå®šæ—¶é—´å‘¨æœŸæ¨è¿›ï¼Œç§°ä¸ºepochï¼Œæ¯ä¸ªepochç»“æŸæ—¶ç”±è¢«é€‰ä¸­çš„reference committeeï¼ˆ$C_R$)ç”Ÿæˆä¸‹ä¸€è½®çš„éšæœºæ•°ï¼Œè¯¥éšæœºæ•°è®©æ¯ä¸ªèŠ‚ç‚¹åœ¨ä¸‹ä¸€è½®å¼€å§‹æ—¶æœ‰æ–°èº«ä»½ï¼Œå¹¶é¿å…æ¶æ„èŠ‚ç‚¹çš„é›†ä¸­å’ŒèŠ‚ç‚¹å…±è°‹</p>
</li>
<li><p>å¯¹ç­‰å‘ç°å’Œcommitteeé—´çš„è·¯ç”±ï¼Œå­˜äº¤æ˜“äº‹åŠ¡$t_x$çš„committeeè®°ä½œ$C_{out}$</p>
</li>
<li><p>è·¨åˆ†ç‰‡éªŒè¯ï¼š$C_{out}$åœ¨ç”ŸæˆåŒºå—è®°è´¦ä¹‹å‰ä¼šå’Œinput committeeéªŒè¯äº¤æ˜“åˆæ³•æ€§</p>
</li>
<li><p>åˆ†ç‰‡å†…å…±è¯†ï¼š</p>
<ol>
<li>åˆ†ç‰‡å†…æˆå‘˜ç”¨å½“å‰epochçš„éšæœºæ•°é€‰ä¸€ä¸ªä¸´æ—¶leader</li>
<li>leaderç”¨æµè¨€åè®®æŠŠåŒºå—å‘å¸ƒç»™åˆ†ç‰‡å†…æ‰€æœ‰èŠ‚ç‚¹</li>
<li>ä½¿ç”¨æ‹œå åº­åè®®ï¼ˆåŸºäºæŸè®ºæ–‡çš„åŒæ­¥åè®®ï¼‰ç¡®ä¿æ‰€æœ‰èŠ‚ç‚¹åŒæ„åŒä¸€ä¸ªåŒºå—</li>
</ol>
</li>
<li><p>é‡æ–°é…ç½®åŒºå—ï¼šæ¯ä¸ªepochç»“æŸæ—¶ç”±$C_R$äº§ç”Ÿï¼ŒåŒ…å«å†…å®¹ï¼š</p>
<ol>
<li>ä¸‹ä¸€è½®çš„éšæœºæ•°</li>
<li>å‚ä¸è€…åˆ—è¡¨å’Œcommitteeæˆå‘˜</li>
</ol>
<p>æƒ³å‚åŠ ä¸‹ä¸€è½®çš„èŠ‚ç‚¹è¦åœ¨ä¸€å®šæ—¶é—´å†…è§£é¢˜PoW</p>
</li>
<li><p>è¿™ç¯‡çš„related workéƒ¨åˆ†ä¹‹åå¯ä»¥å‚è€ƒ</p>
</li>
</ol>
<h2 id="2-A-Secure-Sharding-Protocol-For-Open-Blockchains"><a href="#2-A-Secure-Sharding-Protocol-For-Open-Blockchains" class="headerlink" title="2. A Secure Sharding Protocol For Open Blockchains"></a>2. A Secure Sharding Protocol For Open Blockchains</h2><h4 id="Abstract-1"><a href="#Abstract-1" class="headerlink" title="Abstract"></a>Abstract</h4><ol>
<li>åŒºå—é“¾æœ‰å®‰å…¨æ€§ï¼Œä½†è§„æ¨¡å¾ˆå°ï¼Œæ¯ç§’å¤„ç†3-7ç¬”äº¤æ˜“</li>
<li>ELASTICOï¼š1/4æ‹œå åº­æ”»å‡»ï¼Œåˆ†ä¸ºå¤šä¸ªcommitteesï¼Œæ¯ä¸ªå¤„ç†è‡ªå·±çš„äº‹åŠ¡é›†åˆï¼ˆç§°ä½œåˆ†ç‰‡ï¼‰</li>
</ol>
<h4 id="Mehtod"><a href="#Mehtod" class="headerlink" title="Mehtod"></a>Mehtod</h4><ol>
<li>æŒ‰ç®—åŠ›åˆ†ç‰‡</li>
<li>æ¯ä¸ªepochæµç¨‹ï¼š<ol>
<li>å»ºç«‹è‡ªå·±çš„å…¬é’¥ã€IPå¹¶è¿›è¡ŒPoWï¼ŒæŒ‰å…¬é’¥IDåˆ†ä¸ºä¸åŒCommittees</li>
<li>èŠ‚ç‚¹äº’ç›¸ç¡®è®¤èº«ä»½ï¼Œè®°å½•è‡ªå·±committeeæœ‰è°</li>
<li>committeeå†…çš„å…±è¯†ï¼šPBFTï¼Œå¸¦å¤šæ•°æˆå‘˜ç­¾åå¹¿æ’­</li>
<li>æœ€ç»ˆå…±è¯†å¹¿æ’­ï¼šæœ‰ä¸€ä¸ªfinal committeeæ¥è¿›è¡Œåˆå¹¶ï¼ˆPBFTç„¶åæŠŠæ¥æ”¶çš„åˆ†ç‰‡åŒºå—åœ¨committeeå†…å®ç°å…±è¯†ï¼Œç„¶åå…¨ç½‘å¹¿æ’­ï¼‰</li>
<li>äº§ç”Ÿä¸‹ä¸€è½®çš„éšæœºæ•°ï¼Œå¤§å®¶å¼€å§‹PoWï¼Œå¼€å§‹æ–°çš„ä¸€è½®</li>
</ol>
</li>
</ol>
<h2 id="3-A-Proof-of-Stake-Sharding-Protocol-for-Scalable-Blockchains"><a href="#3-A-Proof-of-Stake-Sharding-Protocol-for-Scalable-Blockchains" class="headerlink" title="3. A Proof of Stake Sharding Protocol for  Scalable Blockchains"></a>3. A Proof of Stake Sharding Protocol for  Scalable Blockchains</h2><ol>
<li><code>c</code>ç»„ï¼Œæ¯ç»„<code>n</code>ä¸ªï¼Œä¸€å…±<code>nc</code>ä¸ªèŠ‚ç‚¹</li>
<li>æ™®é€šèŠ‚ç‚¹ç»„äº§ç”Ÿä¸­é—´åŒºå—ï¼Œå‘é€ç»™æœ€ç»ˆéªŒè¯èŠ‚ç‚¹ç»„</li>
<li>æœ€ç»ˆéªŒè¯èŠ‚ç‚¹ç»„äº§ç”Ÿæœ€ç»ˆåŒºå—ï¼Œå…¨ç½‘å¹¿æ’­</li>
<li>æ¯ä¸ªepochåˆ†ä¸º4æ­¥ï¼š<ol>
<li>åˆ†ç»„ï¼Œç»„å†…éšæœºé€‰leaderï¼Œç»„å†…èŠ‚ç‚¹æŠŠèº«ä»½ä¿¡æ¯å‘ç»™leaderï¼Œleaderå‘å…¶ä»–ç»„çš„leaderå¹¿æ’­</li>
<li>ç»„å†…å…±è¯†ï¼šä¸€ä¸ªäº¤æ˜“éšæœºåˆ†åˆ°æŸç»„ï¼Œç»„å†…èŠ‚ç‚¹PoSï¼Œäº§ç”Ÿæ–°çš„ä¸­é—´åŒºå—</li>
<li>æœ€ç»ˆéªŒè¯ç»„åˆå¹¶åŒºå—ï¼Œç»„å†…PoSï¼Œäº§ç”Ÿæœ€ç»ˆåŒºå—å¹¶å¹¿æ’­</li>
<li>tè½®ä¹‹åï¼Œåˆ·æ–°é‡ç»„</li>
</ol>
</li>
</ol>
<h2 id="4-Ostraka-Secure-Blockchain-Scaling-by-Node-Sharding"><a href="#4-Ostraka-Secure-Blockchain-Scaling-by-Node-Sharding" class="headerlink" title="4. Ostraka: Secure Blockchain Scaling by Node Sharding"></a>4. Ostraka: Secure Blockchain Scaling by Node Sharding</h2><ol>
<li>é‡‡ç”¨UTXOã€PoS</li>
<li>çŸ¿æ± ã€UTXOã€åŒºå—é“¾å­˜å‚¨åœ¨è¢«ç§°ä¸ºåˆ†ç‰‡ï¼ˆshardï¼‰çš„å‡ ä¸ªæœºå™¨ä¸Šï¼Œæœºå™¨å¯ä»¥æ‰©å±•ï¼Œæ¯ä¸ªåˆ†ç‰‡çš„èŠ‚ç‚¹æ•°é‡ä¸ä¸€å®šä¸€æ ·</li>
<li>æœ‰ä¸€ä¸ªæœºå™¨ç§°ä¸º coordinatorè·Ÿè¸ªåŒºå—é“¾å¹¶åè°ƒèŠ‚ç‚¹é—´çš„é€šä¿¡ï¼Œå¯ä»¥è¦æ±‚æŸåˆ†ç‰‡å›æ»šåˆ°æŸåŒºå—é“¾çŠ¶æ€æˆ–å¼€å§‹æ–°çš„é“¾</li>
<li>åˆ†ç‰‡æœ‰ä¸€ä¸ªIDï¼Œç”±coordinatoråˆ†é…ï¼Œå†³å®šè¯¥åˆ†ç‰‡å¤„ç†å“ªäº›äº‹åŠ¡</li>
<li>å¥³å·«åˆ†ç‰‡ï¼šèŠ‚ç‚¹ç›¸åŒçš„åˆ†ç‰‡</li>
<li>äº‹åŠ¡åˆ‡åˆ†å­˜å‚¨åœ¨å¯¹åº”åˆ†ç‰‡ä¸Š</li>
<li>æ€»çš„æ¥è¯´å°±æ˜¯æœ‰ä¸ªç±»ä¼¼è·¯ç”±å™¨ä¸€æ ·çš„æœºå™¨æ¥åè°ƒå¤„ç†è·¨ç‰‡äº‹åŠ¡ï¼Œè¿™ç¯‡åŸºæœ¬ä¸Šæ²¡çœ‹æ‡‚ï¼Œä»¥åæœ‰éœ€è¦å†çœ‹çœ‹</li>
</ol>
<h2 id="5-OptChain-Optimal-Transactions-Placement-for-Scalable-Blockchain-Sharding"><a href="#5-OptChain-Optimal-Transactions-Placement-for-Scalable-Blockchain-Sharding" class="headerlink" title="5. OptChain: Optimal Transactions Placement for Scalable Blockchain Sharding"></a>5. OptChain: Optimal Transactions Placement for Scalable Blockchain Sharding</h2><ol>
<li>æ–°åˆ†ç‰‡æ–¹å¼ï¼Œæœ€å°åŒ–è·¨åˆ†ç‰‡äº‹åŠ¡ï¼ŒåŠ¨æ€äº‹åŠ¡åˆ†é…ï¼ŒæŠŠç›¸å…³å’Œå³å°†ç›¸å…³çš„äº‹åŠ¡åˆ†ç»„åˆ°åŒä¸€åˆ†ç‰‡</li>
<li>å¯¹äº‹åŠ¡åˆ†ç‰‡çš„ä¾æ®ï¼š<ol>
<li>è¿™æ ·åˆ†æ˜¯å¦å‡å°‘äº†è·¨ç‰‡äº‹åŠ¡</li>
<li>åˆ†ç‰‡é—´çš„è´Ÿè½½å¹³è¡¡</li>
</ol>
</li>
<li>TaNç»“æ„ï¼šUTXOæ¨¡å‹çš„äº‹åŠ¡ç½‘ç»œå›¾ç»“æ„</li>
<li>è·¨åˆ†ç‰‡äº‹åŠ¡å¤„ç†æµç¨‹ï¼š<ol>
<li>ç”¨æˆ·åˆ›å»ºè·¨åˆ†ç‰‡äº‹åŠ¡ï¼Œæµè¨€å¹¿æ’­</li>
<li>å‡ ä¸ªUTXOæ‰€åœ¨çš„åˆ†ç‰‡é”å®šUTXOå¹¶æµè¨€å¹¿æ’­è®¸å¯ï¼ˆæˆ–ä¸è®¸å¯ï¼‰</li>
<li>æ¥æ”¶äº‹åŠ¡çš„åˆ†ç‰‡è§£é”UTXOå¹¶è®°è´¦</li>
</ol>
</li>
<li>å¯¹äº‹åŠ¡åˆ†ç‰‡çš„ç®—æ³•ï¼š<ol>
<li>TaNï¼šæŠŠUTXOäº‹åŠ¡çœ‹åšå›¾é‡Œçš„èŠ‚ç‚¹ï¼Œç„¶åæŒ‰å›¾çš„æ‹“æ‰‘ç»“æ„åˆ†æå‡ºåº¦å’Œå…¥åº¦</li>
<li>T2Sï¼šç”¨PageRankè¯„åˆ†ï¼Œåˆ¤æ–­èŠ‚ç‚¹åŠ å…¥å“ªä¸ªåˆ†ç‰‡â€”â€”&gt;å°½å¯èƒ½å‡å°‘è·¨åˆ†ç‰‡äº‹åŠ¡</li>
<li>L2Sï¼šç¡®è®¤å»¶è¿Ÿï¼Œç½‘ç»œç»“æ„å†³å®šäº‹åŠ¡å¾—åˆ°ç¡®è®¤æ‰€éœ€çš„æ—¶é—´â€”â€”&gt;å°½å¯èƒ½åŠ å¿«äº‹åŠ¡ç¡®è®¤é€Ÿåº¦</li>
<li>T2Så’ŒL2Sç»“åˆé€‰æ‹©äº‹åŠ¡åˆ†ç‰‡</li>
</ol>
</li>
</ol>
<h2 id="6-Poster-A-Proof-of-Stake-PoS-Blockchain-Protocol-using-Fair-and-Dynamic-Sharding-Management"><a href="#6-Poster-A-Proof-of-Stake-PoS-Blockchain-Protocol-using-Fair-and-Dynamic-Sharding-Management" class="headerlink" title="6. Poster: A Proof-of-Stake(PoS) Blockchain Protocol using Fair and Dynamic Sharding Management"></a>6. Poster: A Proof-of-Stake(PoS) Blockchain Protocol using Fair and Dynamic Sharding Management</h2><ol>
<li>æ¯ä¸ªepochä¼šé‡æ–°åˆ†ç‰‡å¹¶é€‰æ‹©æ¯ä¸ªåˆ†ç‰‡çš„block producers</li>
<li>åœ¨ä¸Šä¸€ä¸ªepochä¸­ï¼Œusersç”¨è‡ªå·±çš„ä¿¡æ¯å’Œä¸€éƒ¨åˆ†èµ„äº§æ³¨å†Œæˆä¸ºvalidatorï¼ˆéªŒè¯å™¨ï¼‰ï¼Œè¿™ä¸ªepochå¼€å§‹ä»¥åï¼Œvalidatorå’Œäº‹åŠ¡è¢«åˆ†æˆkä¸ªåˆ†ç‰‡ï¼Œåˆ†ç‰‡è§„åˆ™ä¸ºï¼š<ol>
<li>éªŒè¯å™¨çš„åœ°å€å’Œä¸Šä¸€ä¸ªåŒºå—çš„å“ˆå¸Œå€¼ä¸€èµ·å“ˆå¸Œç„¶åå¯¹åˆ†ç‰‡ä¸ªæ•°å–ä½™ï¼Œå³å¯å¾—åˆ°éªŒè¯å™¨çš„åˆ†ç‰‡</li>
<li>äº‹åŠ¡åœ°å€å’Œâ€¦ï¼Œå³å¯å¾—åˆ°äº‹åŠ¡çš„åˆ†ç‰‡</li>
</ol>
</li>
<li>ä½¿ç”¨BFT-DPoSç®—æ³•ï¼Œåœ¨æ¯ä¸ªåˆ†ç‰‡å†…é€‰block producersï¼š<ol>
<li>è‚¡æƒæœ€å¤§çš„æˆä¸ºè¯¥åˆ†ç‰‡çš„producer</li>
<li>æ‰€æœ‰producersæŒ‰é¡ºåºå¾ªç¯é€‰æ€»çš„producer</li>
<li>çŸ¿å·¥å¯ä»¥æŠ•å‡ºä¸ä»–ä»¬æ‰€æŒè‚¡ä»½çš„å¹³æ–¹æ ¹æˆæ¯”ä¾‹çš„é€‰ç¥¨ï¼Œè€Œä¸æ˜¯ä¸æ‰€æŒè‚¡ä»½æˆçº¿æ€§æ¯”ä¾‹çš„é€‰ç¥¨ã€‚</li>
<li>æ ¹æ®BFTç®—æ³•ï¼Œåˆ†ç‰‡çš„produceräº§ç”Ÿè‡ªå·±åˆ†ç‰‡çš„åŒºå—ï¼Œå¹¶ç”±æ€»produceråˆå¹¶å¹¿æ’­</li>
</ol>
</li>
</ol>
<h2 id="7-SSChain-A-full-sharding-protocol-for-public-blockchain-without-data-migration-overhead"><a href="#7-SSChain-A-full-sharding-protocol-for-public-blockchain-without-data-migration-overhead" class="headerlink" title="7. SSChain: A full sharding protocol for public blockchain  without data migration overhead"></a>7. SSChain: A full sharding protocol for public blockchain  without data migration overhead</h2><ol>
<li><p>å…¬é“¾ï¼Œæ‹œå åº­å¼¹æ€§ï¼Œå¯¹äº‹åŠ¡åˆ†ç‰‡å’Œå¯¹çŠ¶æ€åˆ†ç‰‡ï¼ŒèŠ‚ç‚¹æ— éœ€å®šæœŸåˆ‡æ¢åˆ†ç‰‡ï¼ˆé¿å…æ•°æ®å†—ä½™ï¼‰ï¼Œä½¿ç”¨UTXO</p>
</li>
<li><p>èŠ‚ç‚¹å¯ä»¥è‡ªç”±åŠ å…¥åˆ†ç‰‡è€Œæ— éœ€åˆ·æ–°ï¼Œä¸ºé¿å…éšä¹‹è€Œæ¥çš„51%æ”»å‡»é—®é¢˜ï¼Œæœ¬æ–‡æå‡ºäº†ä¸€ä¸ªåŒå±‚ç»“æ„ï¼š</p>
<ol>
<li>æ ¹é“¾éªŒè¯åˆ†ç‰‡çš„åŒºå—ï¼Œé¿å…æ¶æ„èŠ‚ç‚¹æ”»å‡»ï¼Œæ¿€åŠ±æœºåˆ¶ä¿è¯çŸ¿å·¥æ„¿æ„åŠ å…¥</li>
<li>åˆ†ç‰‡ç»´æŠ¤ä¸ç›¸äº¤çš„åˆ†ç±»å¸å¹¶ç‹¬ç«‹å¤„ç†ä¸ç›¸äº¤çš„äº¤æ˜“å­é›†ã€‚</li>
<li>SSChainèƒŒåçš„å…³é”®æ€æƒ³æ˜¯æ ¹é“¾ç»´æŠ¤ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼Œè€Œåˆ‡åˆ†æé«˜äº†ååé‡å¹¶å‡å°‘äº†å­˜å‚¨éœ€æ±‚ã€‚</li>
</ol>
</li>
<li><p>åŒä¸€åˆ†ç‰‡å†…çš„äº¤æ˜“æœ‰æ›´ä½çš„ç¡®è®¤å»¶è¿Ÿå’Œæ›´å°‘çš„äº¤æ˜“è´¹ç”¨ï¼Œè¿›è€Œé¼“åŠ±ç”¨æˆ·ç‰‡å†…äº¤æ˜“</p>
</li>
<li><p>è§£è€¦äº‹åŠ¡éªŒè¯å’ŒçŠ¶æ€æ›´æ–°ï¼Œæ‹†åˆ†è·¨åˆ†ç‰‡äº‹åŠ¡</p>
</li>
<li><p>æ¿€åŠ±æœºåˆ¶ï¼šåŠ¨æ€è°ƒèŠ‚æ ¹é“¾å’Œåˆ†ç‰‡çš„ç®—åŠ›åˆ†é…ï¼Œæ ¹æ®å‚æ•°å¯å¾—åˆ°ä¸åŒçš„ååé‡å’Œå®‰å…¨æ€§</p>
</li>
<li><p>è·¨åˆ†ç‰‡äº‹åŠ¡ï¼šåˆ‡åˆ†æˆåˆ†ç‰‡å†…äº‹åŠ¡ï¼Œæˆ–è€…ç”±æ ¹é“¾å¤„ç†</p>
</li>
<li><p>æ ¹é“¾ï¼šPoWï¼Œåˆ†ç±»å¸ä¿®å‰ªæœºåˆ¶</p>
</li>
<li><p>äº‹åŠ¡åˆ†ç‰‡ï¼š</p>
<ol>
<li>äº‹åŠ¡åœ°å€åŒ…å«æ¯”ç‰¹å¸åœ°å€å’Œåˆ†ç‰‡ID</li>
<li>äº¤æ˜“åˆ†ç±»ï¼š<ol>
<li>inputså’Œoutputsåœ¨ä¸€ä¸ªåˆ†ç‰‡å†…</li>
<li>inputsåœ¨ä¸€ä¸ªåˆ†ç‰‡å†…ï¼Œoutputsåœ¨ä¸åŒåˆ†ç‰‡</li>
<li>éƒ½åœ¨ä¸åŒåˆ†ç‰‡</li>
</ol>
</li>
<li>è·¨åˆ†ç‰‡äº‹åŠ¡ï¼š<ol>
<li>äº¤ç»™æ ¹é“¾â€”â€”&gt;éšåˆ†ç‰‡å¢é•¿ä¼šå¾ˆéš¾å¤„ç†</li>
<li>é¼“åŠ±ç”¨æˆ·åœ¨åŒä¸€åˆ†ç‰‡å†…åˆ›å»ºæ–°åœ°å€â€”â€”&gt;è·¨åˆ†ç‰‡å˜æˆåŒä¸€åˆ†ç‰‡</li>
<li>A+Bâ€”â€”&gt;Cçš„äº‹åŠ¡æ‹†åˆ†æˆAâ€”â€”&gt;Cå’ŒBâ€”â€”&gt;Cï¼ˆä¸ªäººæ„Ÿè§‰è¿™æ²¡ç”¨å•Šï¼‰</li>
</ol>
</li>
</ol>
</li>
<li><p>çŠ¶æ€åˆ†ç‰‡ï¼šä¸€äº›èŠ‚ç‚¹å‚¨å­˜æ•´ä¸ªåŒºå—é“¾çš„çŠ¶æ€è€Œä¸æ˜¯åªå­˜åˆ†ç‰‡çŠ¶æ€</p>
</li>
<li><p>å¸‚åœºæ¿€åŠ±æœºåˆ¶ï¼šåŠ¨æ€åœ°è°ƒæ•´åˆ‡åˆ†å’Œæ ¹é“¾ä¹‹é—´çš„å“ˆå¸ŒåŠŸç‡åˆ†é…ã€‚åœ¨æ¿€åŠ±æœºåˆ¶ä¸‹ï¼ŒçŸ¿å•†å¯ä»¥è‡ªç”±é€‰æ‹©æœ€èµšé’±çš„ç¢ç‰‡ï¼Œä»è€Œé¿å…äº†å‘¨æœŸæ€§çš„ç½‘ç»œé‡ç»„ã€‚æœ‰ä¸¤ä¸ªç›®çš„ï¼š</p>
<ol>
<li>ä¸ºäº†ç»´æŠ¤ç³»ç»Ÿå®‰å…¨ï¼Œæ ¹é“¾å ç”¨äº†æ•´ä¸ªç½‘ç»œçš„å¾ˆå¤§ä¸€éƒ¨åˆ†ç®—åŠ›ã€‚ç”±äºåˆ‡åˆ†å—æ˜¯ç”±æ ¹é“¾ç½‘ç»œéªŒè¯çš„ï¼Œæ¶æ„å¯¹æ‰‹è‡³å°‘éœ€è¦æ ¹é“¾å“ˆå¸Œèƒ½åŠ›çš„ä¸€åŠæ‰èƒ½è¿›è¡ŒåŒå€å¼€é”€æ”»å‡»ã€‚</li>
<li>ç®—åŠ›è¢«é¼“åŠ±å¹³å‡åˆ†é…åˆ°ç¢ç‰‡ä¸­ï¼Œè¿™æ ·æ¯ä¸ªç¢ç‰‡éƒ½å¯ä»¥æ­£å¸¸å·¥ä½œã€‚</li>
</ol>
</li>
</ol>
<h2 id="8-Trust-Based-Shard-Distribution-Scheme-for-Fault-Tolerant-Shard-Blockchain-Networks"><a href="#8-Trust-Based-Shard-Distribution-Scheme-for-Fault-Tolerant-Shard-Blockchain-Networks" class="headerlink" title="8. Trust-Based Shard Distribution Scheme for Fault-Tolerant Shard Blockchain Networks"></a>8. Trust-Based Shard Distribution Scheme for Fault-Tolerant Shard Blockchain Networks</h2><ol>
<li>TBSDï¼šæŠŠæ¶æ„èŠ‚ç‚¹æ”¾åˆ°ä¸åŒçš„åˆ†ç‰‡ï¼Œä½¿ç”¨ä¿¡ä»»ç®¡ç†ç³»ç»Ÿå’Œé—ä¼ ç®—æ³•</li>
<li>å®šé‡è¡¡é‡èŠ‚ç‚¹çš„ä¿¡ä»»åº¦ï¼Œå¯¹æ¶æ„èŠ‚ç‚¹è¿›è¡Œä¿¡ç”¨æƒ©ç½š</li>
<li>é—ä¼ ç®—æ³•æ‰¾åˆ°æœ€ä¼˜åˆ†ç‰‡æ–¹æ³•ï¼Œä½¿å¾—æ¯ä¸ªåˆ†ç‰‡çš„ä¿¡ç”¨åº¦éƒ½å·®ä¸å¤š</li>
<li>æ€»çš„æ¥è¯´ä¿¡ç”¨ç³»ç»Ÿåˆ†ä¸º5æ­¥ï¼š<ol>
<li>æ¯ä¸€è½®å¼€å§‹æ—¶ï¼ŒPoSé€‰ä¸€ä¸ªleaderå‡ºå—</li>
<li>å…¨ç½‘å¹¿æ’­éªŒè¯åŒºå—ï¼Œå°‘æ•°æœä»å¤šæ•°</li>
<li>SCOï¼šèŠ‚ç‚¹ä¿¡ç”¨è¡¨ï¼Œç”±éªŒè¯èŠ‚ç‚¹äº§ç”Ÿï¼Œä¸Šä¸€æ­¥çš„éªŒè¯ç»“æœä½œä¸ºä¿¡ç”¨è¯„åˆ†çš„ä¾æ®</li>
<li>LCRï¼šæ ¹æ®SCOè®¡ç®—å¾—åˆ°çš„ç›¸å¯¹ä¿¡ç”¨åˆ†å¸ƒçŸ©é˜µ</li>
<li>æœ€ç»ˆä¿¡ç”¨è¯„ä¼°</li>
</ol>
</li>
<li>æ”»å‡»æ¨¡å‹ï¼š<ol>
<li>æ¶æ„èŠ‚ç‚¹æˆä¸ºleader</li>
<li>èŠ‚ç‚¹å…±è°‹</li>
<li>æ¶æ„èŠ‚ç‚¹è¡Œä¸ºä¸ä¸€è‡´ï¼Œä¸€ä¼šå„¿è¯šå®ä¸€ä¼šå„¿æ¶æ„</li>
</ol>
</li>
<li>åˆ†ç‰‡è¿‡ç¨‹ï¼šç”¨GA</li>
</ol>
<h2 id="9-Two-Phase-Cooperative-Bargaining-Game-Approach-for-Shard-Based-Blockchain-Consensus-Scheme"><a href="#9-Two-Phase-Cooperative-Bargaining-Game-Approach-for-Shard-Based-Blockchain-Consensus-Scheme" class="headerlink" title="9. Two-Phase Cooperative Bargaining Game Approach for Shard-Based Blockchain Consensus Scheme"></a>9. Two-Phase Cooperative Bargaining Game Approach for Shard-Based Blockchain Consensus Scheme</h2><ol>
<li>åˆ†ç‰‡åï¼Œè¿›è¡Œè®®ä»·åšå¼ˆï¼Œäº‹åŠ¡æ€»çš„æ¥è¯´å¹³åˆ†ç»™æ¯ä¸ªåˆ†ç‰‡å¤„ç†</li>
<li>æœ‰ä¸€ä¸ªadjust shardè´Ÿè´£ç¡®è®¤ï¼Œå…¶ä»–åˆ†ç‰‡è¿›è¡Œæ™®é€šçš„æŒ–çŸ¿</li>
<li>éšæœºæ•°åˆ†ç‰‡ï¼Œåˆ†ç‰‡å†…å…±è¯†ï¼šæ ‡å‡†æ‹œå åº­ä¸€è‡´åè®®ï¼Œçœ‹èµ·æ¥æ˜¯å¯¹èŠ‚ç‚¹åˆ†ç‰‡</li>
<li>èŠ‚ç‚¹éªŒè¯äº‹åŠ¡å’Œå‚ä¸å…±è¯†çš„è¿‡ç¨‹å¯çœ‹åšä¸¤é˜¶æ®µåšå¼ˆï¼š<ol>
<li>äº‹åŠ¡åˆ†é…é—®é¢˜</li>
<li>åŸºäºåˆ†ç‰‡çš„å…±è¯†æœºåˆ¶</li>
</ol>
</li>
<li>è®¨ä»·è¿˜ä»·åšå¼ˆè¿™é‡Œæ²¡å®Œå…¨çœ‹æ‡‚ï¼Œæ„Ÿè§‰å°±æ˜¯åˆ†ç‰‡å’ŒèŠ‚ç‚¹æ ¹æ®å¥–åŠ±å’Œæ”¯å‡ºå†³å®šæ˜¯å¦å¤„ç†äº‹åŠ¡ï¼Œä¸Šé¢çš„4.1é‡Œåšå¼ˆæ–¹æ˜¯åˆ†ç‰‡ï¼Œ4.2çš„åšå¼ˆæ–¹æ˜¯åŒºå—é“¾èŠ‚ç‚¹</li>
</ol>
<h2 id="A-Node-Rating-Based-Sharding-Scheme-for-Blockchain"><a href="#A-Node-Rating-Based-Sharding-Scheme-for-Blockchain" class="headerlink" title="A Node Rating Based Sharding Scheme for Blockchain"></a>A Node Rating Based Sharding Scheme for Blockchain</h2>]]></content>
      <categories>
        <category>è®ºæ–‡</category>
      </categories>
      <tags>
        <tag>blockchain</tag>
      </tags>
  </entry>
  <entry>
    <title>è®ºæ–‡è®°å½•-Monoxide: Scale Out Blockchain with Asynchronous Consensus Zones</title>
    <url>/2020/04/07/%E8%AE%BA%E6%96%87%E8%AE%B0%E5%BD%95-Monoxide%20Scale%20Out%20Blockchain%20with%20Asynchronous%20Consensus%20Zones/</url>
    <content><![CDATA[<h2 id="çªç ´åŒºå—é“¾ä¸å¯èƒ½ä¸‰è§’å¼‚æ­¥å…±è¯†ç»„"><a href="#çªç ´åŒºå—é“¾ä¸å¯èƒ½ä¸‰è§’å¼‚æ­¥å…±è¯†ç»„" class="headerlink" title="çªç ´åŒºå—é“¾ä¸å¯èƒ½ä¸‰è§’å¼‚æ­¥å…±è¯†ç»„"></a>çªç ´åŒºå—é“¾ä¸å¯èƒ½ä¸‰è§’å¼‚æ­¥å…±è¯†ç»„</h2><a id="more"></a>

<h3 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h3><ol>
<li>èƒŒæ™¯ï¼šåŠ å¯†è´§å¸åœ¨åŒ¿ååœ¨çº¿æ”¯ä»˜æ–¹é¢å¾ˆé‡è¦</li>
<li>é—®é¢˜ï¼š<ol>
<li>éšç”¨æˆ·å’Œäº¤æ˜“çš„å¢é•¿ï¼Œä½ååé‡é˜»ç¢åŠ å¯†è´§å¸ç³»ç»Ÿçš„æ‰©å±•</li>
<li>æ¯ä¸ªèŠ‚ç‚¹å¤åˆ¶æ•´ä¸ªç½‘ç»œçš„é€šä¿¡ã€å­˜å‚¨å’ŒçŠ¶æ€è¡¨ç¤ºä¹Ÿé˜»ç¢äº†ç³»ç»Ÿçš„æ‰©å±•</li>
</ol>
</li>
<li>æœ¬æ–‡ï¼š<ol>
<li>Asynchronous Consensus Zonesï¼ˆå¼‚æ­¥ä¸€è‡´ç½‘ç»œï¼‰ï¼šåˆ†åŒºåŸŸï¼Œä¸å½±å“å»ä¸­å¿ƒåŒ–å’Œå®‰å…¨æ€§ï¼Œæ¯ä¸ªåŒºåŸŸç‹¬ç«‹å¹¶è¡Œï¼Œå—å†…å…±è¯†ï¼›</li>
<li>è¯¸è‘›è¿å¼©ç³»ç»Ÿï¼šä½¿å¾—æ”»å‡»å•ç‹¬çš„ä¸€ä¸ªå—çš„éš¾åº¦å’Œæ”»å‡»æ•´ä¸ªåŒºå—çš„éš¾åº¦ä¸€æ ·å¤§</li>
</ol>
</li>
</ol>
<h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><ol>
<li>TPSï¼ˆæ¯ç§’äº¤æ˜“æ•°ï¼‰å¾ˆä½çš„åŸå› åœ¨äºåŒºå—æŒ‰é¡ºåºå»ºç«‹ï¼Œè€Œç½‘ç»œå»¶è¿Ÿå¯¼è‡´å¹¿æ’­æ—¶é—´ä¸èƒ½è¿‡çŸ­</li>
<li>æ¯ä¸€ä¸ªå®Œæ•´çš„èŠ‚ç‚¹éƒ½éœ€è¦å¤åˆ¶æ•´ä¸ªç½‘ç»œçš„é€šä¿¡ã€å­˜å‚¨å’ŒçŠ¶æ€è¡¨ç¤ºï¼Œç³»ç»Ÿå—é™äºç¡¬ä»¶è®¾å¤‡è€Œæ— æ³•æ‰©å±•</li>
<li>ç»¼ä¸Šå¯æ‰©å±•çš„åŒºå—é“¾è¦è€ƒè™‘ï¼š<ol>
<li>å…±è¯†åè®®çš„å¯æ‰©å±•æ€§</li>
<li>é€šä¿¡ã€å­˜å‚¨ã€è®¡ç®—å’Œå†…å­˜çš„èµ„æºä½¿ç”¨</li>
<li>å»ä¸­å¿ƒåŒ–å’Œå®‰å…¨æ€§</li>
</ol>
</li>
<li>ä»¥å¤ªåŠå·²æå‡ºåˆ†ç‰‡çš„è®¾è®¡</li>
<li>æœ¬æ–‡å¼‚æ­¥ä¸€è‡´ç½‘ç»œï¼š<ol>
<li>åˆ†åŒºåŸŸï¼Œé€šè¿‡åœ¨å¤šä¸ªç‹¬ç«‹å’Œå¹¶è¡Œå®ä¾‹(æˆ–ä¸€è‡´åŒºåŸŸ)ä¸­åˆ’åˆ†å’Œå¤„ç†å·¥ä½œè´Ÿè½½æ¥æ‰©å±•åŒºå—é“¾ç³»ç»Ÿ</li>
<li>æ•´ä¸ªç½‘ç»œåˆ’åˆ†ä¸ºåŒºåŸŸï¼Œæ¯ä¸ªåŒºåŸŸè´Ÿè´£è‡ªå·±é‚£éƒ¨åˆ†ï¼Œåªåœ¨åŒºåŸŸå†…å¤åˆ¶ï¼ŒæŒ–çŸ¿ç«äº‰å’Œäº¤æ˜“ç¡®è®¤ç­‰åœ¨åŒºå—é—´å¼‚æ­¥è¿›è¡Œ</li>
<li>æŒ‘æˆ˜åœ¨äºï¼š<ol>
<li>è·¨åŒºåŸŸäº‹åŠ¡çš„ååé‡</li>
<li>è¯šå®çŸ¿å·¥ç¨€é‡Šå¸¦æ¥çš„å®‰å…¨æ€§é—®é¢˜</li>
</ol>
</li>
</ol>
</li>
<li>æœ¬æ–‡æœ€ç»ˆåŸå­ç¡®è®¤ï¼šè·¨åŒºåŸŸäº‹åŠ¡ç”±åŸå­æ€§åˆ†è§£ä¸ºå¤šä¸ªäº‹åŠ¡ï¼Œæ¯ä¸ªäº‹åŠ¡æ¶‰åŠå•ç‹¬ä¸€ä¸ªåŒºåŸŸ</li>
<li>æœ¬æ–‡è¯¸è‘›è¿å¼©ï¼šçŸ¿å·¥æŒ–çŸ¿æˆåŠŸæ—¶å¯ä»¥åœ¨ä¸åŒçš„åŒºåŸŸé‡Œåˆ›å»ºå¤šä¸ªåŒºå—ï¼Œå…¶ç®—åŠ›å¹³å‡åˆ†é…åˆ°å„ä¸ªåŒºåŸŸï¼Œè€Œæ”»å‡»è€…çš„æ”»å‡»ç®—åŠ›åŒæ ·ä¹Ÿè¢«åˆ†åˆ°äº†ä¸åŒåŒºåŸŸï¼Œå› æ­¤æ”»å‡»å•ç‹¬ä¸€ä¸ªåŒºåŸŸå’Œæ”»å‡»æ•´ä¸ªç³»ç»Ÿéš¾åº¦ä¸€æ ·</li>
</ol>
<h3 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h3><p>å¯¹æ¯”PoSå’ŒPoWï¼ŒUTXOå’Œè´¦æˆ·ä½™é¢</p>
<ol>
<li>å½±å“åŒºå—é“¾ç³»ç»Ÿå’Œå…±è¯†åè®®æ€§èƒ½çš„å› ç´ ï¼šä¸€è‡´æ€§ï¼ˆå…±è¯†ï¼‰ã€é€šä¿¡ã€å­˜å‚¨ã€è¡¨ç¤º</li>
<li>PoWè€—è´¹ç®—åŠ›æ¥ç«äº‰è®°è´¦æƒï¼Œä½†æ˜¯åŠ å¯†è´§å¸ä¸€å®šç¨‹åº¦ä¸Šæœ‰å¯¹åº”ç°å®ä¸–ç•Œçš„ä»·å€¼ï¼›PoSç”±èŠ‚ç‚¹çš„è‚¡æƒï¼ˆè´¢å¯Œï¼‰æ¥å†³å®šåŒºå—çš„äº§ç”Ÿï¼›æœ¬æ–‡ç”¨PoWï¼Œä½†æ”¹PoSä¹Ÿè¡Œ</li>
<li>åŠ å¯†è´§å¸æœ‰ä¸¤ç§äº¤æ˜“æ¨¡å‹ï¼ŒUTXOå’Œè´¦æˆ·ä½™é¢ï¼Œä»¥å¤ªåŠç”¨äº†åè€…ï¼ˆæ›´æ”¯æŒæ™ºèƒ½åˆçº¦ï¼‰ï¼Œæœ¬æ–‡ä¹Ÿç”¨äº†åè€…ï¼Œæ€»ä¹‹è´¦æˆ·ä½™é¢æ¨¡å‹æœ‰å¾ˆå¤šä¼˜ç‚¹</li>
</ol>
<h3 id="System-Design"><a href="#System-Design" class="headerlink" title="System Design"></a>System Design</h3><ol>
<li><p>è·¨åŒºåŸŸäº‹åŠ¡çš„æ‰§è¡Œï¼š</p>
<ol>
<li>åŒºåŸŸAæ‰§è¡Œæ£€æŸ¥ä½™é¢ç„¶åå–é’±ï¼ˆ withdraw operationï¼‰ï¼Œä¸‹ä¸€ä¸ªè¯¥åŒºåŸŸçš„åŒºå—å°±ä¼šæ›´æ–°ä½™é¢çŠ¶æ€ç­‰</li>
<li>åŒºåŸŸAæŠŠå­˜é’±ï¼ˆ deposit operation ï¼‰æ‰“åŒ…æˆä¸€ä¸ªä¸­ç»§æ“ä½œï¼ˆ relay transaction ï¼‰å‘ç»™åŒºåŸŸB</li>
<li>åŒºåŸŸBæ‰§è¡Œå­˜é’±æ“ä½œï¼Œä¸éœ€è¦æ£€æŸ¥ä½™é¢</li>
<li>å–é’±åªæ¶‰åŠåŒºåŸŸAï¼Œå­˜é’±åªæ¶‰åŠåŒºåŸŸBï¼Œå› æ­¤ä¸éœ€è¦è¿›è¡ŒåŒºåŸŸé—´çš„ç¡®è®¤ç­‰</li>
</ol>
</li>
<li><p>åˆ’åˆ†å’Œå‘½åï¼ˆPartitioning and Namingï¼‰ï¼š</p>
<ol>
<li>ç”¨æˆ·åœ°å€è¢«å‡åŒ€åˆ’åˆ†ä¸º$2^k$ä¸ªåŒºåŸŸï¼Œä¸€ä¸ªåŒºåŸŸç”±å®ƒçš„åˆ†ç‰‡å°ºåº¦kå’ŒåŒºåŸŸç´¢å¼•sæ¥è¯†åˆ«</li>
<li>ç¾¤swarmï¼šå‚ä¸ç›¸åŒæ•°æ®é›†çš„å¤åˆ¶çš„ä¸€ç»„èŠ‚ç‚¹ã€‚å…¨èŠ‚ç‚¹åŠ å…¥ç¾¤ä»è€Œå¹¿æ’­ä¿¡æ¯å’Œæ¥æ”¶å…¶ä»–å…¨èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚æ¯”ç‰¹å¸å’Œä»¥å¤ªåŠç³»ç»Ÿåªæœ‰ä¸€ä¸ªç¾¤ï¼Œå¤§å®¶éƒ½ä¿å­˜åŒæ ·çš„ä¿¡æ¯ã€‚</li>
<li>æœ¬æ–‡æœ‰å¤šä¸ªå‡ºäºä¸åŒç›®çš„å»ºç«‹çš„ç¾¤ï¼Œé‡‡ç”¨åˆ†å¸ƒå¼å“ˆå¸Œè¡¨(DHT)è¿›è¡Œç¾¤å¯»å€å’Œå¯¹ç­‰å‘ç°ã€‚</li>
<li>ç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªåŒ…å«æ‰€æœ‰å…¨èŠ‚ç‚¹çš„å…¨å±€ç¾¤ï¼Œç”¨äºå¤åˆ¶æ‰€æœ‰åŒºåŸŸçš„æœ€å°å…¬å…±ä¿¡æ¯ã€‚</li>
<li>åœ¨æ¯ä¸ªç¾¤å†…ï¼Œå…¨èŠ‚ç‚¹ç¨€ç–åˆ†å¸ƒï¼Œä½¿ç”¨gossip protocolå¹¿æ’­ä¿¡æ¯</li>
<li>åŒºåŸŸç‰¹å®šçš„ç¾¤ä¹Ÿç”¨åˆ†ç‰‡å°ºåº¦kå’ŒåŒºåŸŸç´¢å¼•sæ¥è¯†åˆ«</li>
</ol>
</li>
<li><p>å•ç‹¬ä¸€ä¸ªåŒºåŸŸï¼šåŒºåŸŸé—´è®¡ç®—å’Œäº‹åŠ¡ç›¸äº’éš”ç¦»ã€ç‹¬ç«‹å¹¶è¡Œï¼Œéšç½‘ç»œå¢é•¿ä¼šåˆ›å»ºæ–°åŒºåŸŸ</p>
<ol>
<li>å…¨èŠ‚ç‚¹æˆ–çŸ¿å·¥æœ‰ç‰¹å®šæ ‡è¯†ç¬¦æ¥å†³å®šåœ¨å“ªä¸ªåŒºåŸŸå†…å·¥ä½œ</li>
<li>æ¯ä¸ªåŒºåŸŸæœ‰è‡ªå·±çš„åŒºå—é“¾</li>
<li>çŸ¿å·¥åªä¸åŒåŒºåŸŸçš„PoWç«äº‰è®°è´¦æƒ</li>
<li>å…¨èŠ‚ç‚¹ä¼šå¿½ç•¥å…¶ä»–åŒºåŸŸçš„äº‹åŠ¡æ¶ˆæ¯</li>
</ol>
</li>
<li><p>æœ€å°åŒ–è·¨åŒºåŸŸå¼€é”€ï¼š</p>
<ol>
<li>ç³»ç»Ÿåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šç»´æŠ¤ä¸€ä¸ªåˆ†å¸ƒå¼å“ˆå¸Œè¡¨(DHT)</li>
<li>å¤§å¤šæ•°é€šä¿¡ç”¨äºå¤åˆ¶æœªç»ç¡®è®¤çš„äº‹åŠ¡ï¼Œå¹¶å¹¿æ’­å¸¦æœ‰å·²ç¡®è®¤äº‹åŠ¡çš„æ–°å—</li>
<li>è·å–æœªç¡®è®¤äº‹åŠ¡æˆ–æ–°å—å¯¹åº”çš„åŒºåŸŸç´¢å¼•såï¼Œç³»ç»Ÿåœ¨DHTä¸­é€‰æ‹©ç´¢å¼•ç›¸åŒçš„èŠ‚ç‚¹ï¼Œé€šè¿‡gossip protocolæŠŠäº‹åŠ¡å’ŒåŒºå—å‘ç»™å®ƒä»¬ã€‚</li>
<li>åªæŠŠä¸­ç»§äº‹åŠ¡å‘ç»™å¯¹åº”åŒºåŸŸï¼Œè€Œä¸æ˜¯å…¨ç½‘å¹¿æ’­</li>
<li>ç”¨äºå½¢æˆé“¾çš„æœ€å°åŒ–æ•°æ®ä¼šè¢«å¤åˆ¶åˆ°æ‰€æœ‰åŒºåŸŸï¼ˆä¸‹ä¸€éƒ¨åˆ†è®¨è®ºï¼‰</li>
</ol>
<h3 id="Efï¬cient-Cross-Zone-Atomicity"><a href="#Efï¬cient-Cross-Zone-Atomicity" class="headerlink" title="Efï¬cient Cross-Zone Atomicity"></a>Efï¬cient Cross-Zone Atomicity</h3><ol>
<li>äº‹åŠ¡åˆ†ä¸ºå–é’±ï¼ˆrelayï¼‰å’Œå­˜é’±ï¼ˆdepositï¼‰æ“ä½œï¼Œåˆ†åˆ«åœ¨å¯¹åº”çš„åŒºåŸŸè¿›è¡ŒéªŒè¯</li>
<li>ä¸ºé¿å…åˆ†å‰å‡ºç°çš„é—®é¢˜ï¼š<ol>
<li>å–é’±éªŒè¯ä¸€æ¬¡</li>
<li>å­˜é’±éªŒè¯ä¸€æ¬¡</li>
<li>ä¸­ç»§æ“ä½œéš”ä¸€å®šæ•°é‡çš„åŒºå—åæ‰è¢«æ‰“åŒ…</li>
</ol>
</li>
</ol>
<h3 id="Defense-Per-Zone-Security"><a href="#Defense-Per-Zone-Security" class="headerlink" title="Defense Per-Zone Security"></a>Defense Per-Zone Security</h3><ol>
<li>å…è®¸çŸ¿å·¥å®Œæˆä¸€æ¬¡PoWåœ¨å¤šä¸ªåŒºåŸŸå»ºç«‹å¤šä¸ªåŒºå—ï¼ˆåŒºå—ç½‘ï¼Ÿï¼‰ï¼Œæ¯ä¸ªåŒºåŸŸåªèƒ½å»ºç«‹ä¸€ä¸ª</li>
<li>å‚ä¸è¯¸è‘›è¿å¼©çš„çŸ¿å·¥çš„ç®—åŠ›æ²¡è¢«ç¨€é‡Šï¼Œè¿™æ ·æ”»å‡»å•ç‹¬ä¸€ä¸ªåŒºåŸŸæ‰€éœ€çš„ç®—åŠ›ä»ç„¶æ˜¯50%</li>
</ol>
</li>
</ol>
]]></content>
      <categories>
        <category>è®ºæ–‡</category>
      </categories>
      <tags>
        <tag>blockchain</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonè¯¾ç¨‹è®°å½•-6</title>
    <url>/2020/04/01/python%E8%AF%BE%E7%A8%8B%E8%AE%B0%E5%BD%95-6/</url>
    <content><![CDATA[<p>è¿™ä¸€è¯¾è®²ç¬¬ä¸‰æ–¹åº“çš„å®‰è£…å’Œä½¿ç”¨ï¼Œç„¶åç”¨<code>wordcloud</code>å’Œ<code>jieba</code>ç”Ÿæˆè¯äº‘å›¾å’Œä¸­æ–‡åˆ†è¯ã€‚æ²¡æœ‰è¯¾å ‚ç»ƒä¹ ï¼Œåªæœ‰ä¸€ä¸ªåœ¨ä¸Šæ¬¡ä½œä¸šåŸºç¡€ä¸Šçš„ä½œä¸šã€‚</p>
<p>æˆ‘æ˜¯ç›´æ¥<code>pip</code>å®‰è£…çš„ï¼Œåœ¨å®‰è£…<code>wordcloud</code>æ—¶ï¼Œ<code>pip install wordcloud</code>å¾ˆå¿«å°±è£…å¥½äº†ï¼Œä½†æ˜¯<code>jieba</code>åå¤å‡ºé”™ï¼Œæœ€åæŒ‡å®šæ¸…åé•œåƒï¼Œ<code>pip install -i https://pypi.tuna.tsinghua.edu.cn/simple jieba</code>ï¼Œè¿™æ ·å°±é£å¿«åœ°å®‰è£…å¥½äº†ã€‚</p>
<a id="more"></a>

<h3 id="è¯¾åä½œä¸š"><a href="#è¯¾åä½œä¸š" class="headerlink" title="è¯¾åä½œä¸š"></a>è¯¾åä½œä¸š</h3><p>(4) åˆ©ç”¨<code>wordcloud</code>ç»“åˆ<code>jieba</code>åˆ†åˆ«å¯¹æç™½ï¼ˆæœç”«ï¼‰è¯—æ­Œå†…å®¹ä¸­çš„å­—å’Œè¯è¯­è¿›è¡Œå¯è§†åŒ–ã€‚</p>
<h5 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h5><p>ä¸ŠèŠ‚è¯¾çš„ä½œä¸šå®Œæˆåå·²ç»å¾—åˆ°äº†å¤„ç†å¥½çš„è¯—æ­Œå­—ç¬¦ä¸²å’Œå­—é¢‘ç»Ÿè®¡<code>Counter</code>ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±å¯ä»¥ç”¨è¿™ä¸¤ä¸ªå˜é‡æ¥å¾—åˆ°å¯¹åº”çš„è¯äº‘å›¾ã€‚</p>
<p>ç”¨<code>fit_words()</code>å‡½æ•°æ ¹æ®å·²ç»å¾—åˆ°çš„è®¡æ•°å™¨<code>poems_counter</code>ç”Ÿæˆçš„å­—å…¸æ¥åˆ¶ä½œå­—é¢‘çš„è¯äº‘å›¾ç‰‡ï¼Œç”¨<code>generate()</code>å‡½æ•°å¯¹ç”¨<code>jieba</code>è¿›è¡Œåˆ†è¯ä¹‹åçš„<code>poems_text</code>ç”Ÿæˆè¯é¢‘çš„è¯äº‘å›¾ç‰‡ã€‚åœ¨ä¿å­˜å›¾ç‰‡åå¯ä»¥ç”¨<code>PIL</code>ä¸­çš„<code>Image.open()</code>å’Œ<code>show()</code>æ¥æ˜¾ç¤ºå›¾ç‰‡ã€‚å¯¹åº”çš„å‡½æ•°ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯¼å…¥åº“</span></span><br><span class="line"><span class="keyword">import</span> jieba</span><br><span class="line"><span class="keyword">import</span> wordcloud</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cloud_character</span><span class="params">(poems_counter, name)</span>:</span></span><br><span class="line">    dict_character = dict(poems_counter)</span><br><span class="line">    <span class="comment"># ç”Ÿæˆå›¾åƒå¯¹åº”çš„é®ç½©ï¼Œè¿™æ ·è¯äº‘å›¾å°±æ˜¯æŒ‰å›¾åƒé‡Œéç™½è‰²åŒºåŸŸæ¥å¡«å……çš„</span></span><br><span class="line">    mask = np.array(Image.open(name + <span class="string">'.jpg'</span>))</span><br><span class="line">    <span class="comment"># æ ¹æ®å›¾åƒç”Ÿæˆé¢œè‰²è¡¨ï¼Œè¿™æ ·è¯äº‘å›¾çš„é¢œè‰²å°±å’Œå›¾åƒä¸€è‡´äº†</span></span><br><span class="line">    color = wordcloud.ImageColorGenerator(mask)</span><br><span class="line">    <span class="comment"># ç”Ÿæˆè¯äº‘å›¾å˜é‡ï¼ŒèƒŒæ™¯ç™½è‰²ï¼Œrandom_stateçš„å€¼å½±å“å­—åœ¨å›¾ä¸­çš„åˆ†å¸ƒï¼Œcolor_funcè®¾å®šè¯äº‘é¢œè‰²ï¼Œmaskè®¾å®šå›¾åƒé®ç½©ï¼Œfont_pathæŒ‡å®šå­—ä½“ï¼Œä¸æŒ‡å®šçš„è¯ä¸­æ–‡æ²¡æ³•æ˜¾ç¤º</span></span><br><span class="line">    wc = wordcloud.WordCloud(background_color=<span class="string">"white"</span>, random_state=<span class="number">42</span>, color_func=color, mask=mask, font_path=<span class="string">'C:\Windows\Fonts\simsun.ttc'</span>)</span><br><span class="line">    <span class="comment"># æ ¹æ®å­—å…¸ç”Ÿæˆè¯äº‘å›¾çš„å†…å®¹</span></span><br><span class="line">    wc.fit_words(dict_character)</span><br><span class="line">    <span class="comment"># ä¿å­˜è¯äº‘å›¾</span></span><br><span class="line">    wc.to_file(name + <span class="string">"cloud_character.png"</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cloud_word</span><span class="params">(poems_text, name)</span>:</span></span><br><span class="line">    text = <span class="string">' '</span>.join(jieba.cut(poems_text))</span><br><span class="line">    mask = np.array(Image.open(name + <span class="string">'.jpg'</span>))</span><br><span class="line">    color = wordcloud.ImageColorGenerator(mask)</span><br><span class="line">    wc = wordcloud.WordCloud(background_color=<span class="string">"white"</span>, random_state=<span class="number">42</span>, color_func=color, mask=mask, font_path=<span class="string">'C:\Windows\Fonts\simsun.ttc'</span>)</span><br><span class="line">    <span class="comment"># æ ¹æ®æ–‡æœ¬å­—ç¬¦ä¸²ç”Ÿæˆè¯äº‘å›¾çš„å†…å®¹</span></span><br><span class="line">    wc.generate(text)</span><br><span class="line">    wc.to_file(name + <span class="string">"cloud_word.png"</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_pic</span><span class="params">(name)</span>:</span></span><br><span class="line">    <span class="comment"># æ‰“å¼€å›¾åƒ</span></span><br><span class="line">    img1 = Image.open(name + <span class="string">"cloud_character.png"</span>)</span><br><span class="line">    img2 = Image.open(name + <span class="string">"cloud_word.png"</span>)</span><br><span class="line">    <span class="comment"># æ˜¾ç¤ºå›¾åƒ</span></span><br><span class="line">    img1.show()</span><br><span class="line">    img2.show()</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸»ç¨‹åºéƒ¨åˆ†</span></span><br><span class="line">cloud_character(counter_libai, <span class="string">'libai'</span>)</span><br><span class="line">cloud_character(counter_dufu, <span class="string">'dufu'</span>)</span><br><span class="line">cloud_word(text_libai, <span class="string">'libai'</span>)</span><br><span class="line">cloud_word(text_dufu, <span class="string">'dufu'</span>)</span><br><span class="line">show_pic(<span class="string">"libai"</span>)</span><br><span class="line">show_pic(<span class="string">"dufu"</span>)</span><br></pre></td></tr></table></figure>

<p>ï¼ˆæœ€åç”Ÿæˆçš„è¯äº‘å›¾æ˜¯çœŸçš„æ€ªæ€ªçš„â€¦â€¦ï¼‰</p>
]]></content>
      <categories>
        <category>è¯¾ç¨‹ç¬”è®°</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonè¯¾ç¨‹è®°å½•-5</title>
    <url>/2020/03/31/python%E8%AF%BE%E7%A8%8B%E8%AE%B0%E5%BD%95-5/</url>
    <content><![CDATA[<p>è¿™ä¸€è¯¾è®²çš„æ˜¯å­—å…¸å’Œé›†åˆã€‚</p>
<a id="more"></a>

<h3 id="è¯¾å ‚ç»ƒä¹ "><a href="#è¯¾å ‚ç»ƒä¹ " class="headerlink" title="è¯¾å ‚ç»ƒä¹ "></a>è¯¾å ‚ç»ƒä¹ </h3><ol>
<li><p>å¯¹äºä¸‹åˆ—è´¢ç»æ•°æ®<code>lst</code>ï¼Œå¦‚ä½•æ„é€ å…¬å¸ä»£ç å’Œè‚¡ç¥¨ä»·æ ¼çš„å­—å…¸<code>d</code>ï¼Ÿ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">lst=[(<span class="string">'AXP'</span>,<span class="string">'American Epress Company'</span>,<span class="string">'86.40'</span>),</span><br><span class="line">	(<span class="string">'BA'</span>,<span class="string">'The Boeing Company'</span>,<span class="string">'22.64'</span>),</span><br><span class="line">	(<span class="string">'CAT'</span>,<span class="string">'Caterpillar Inc.'</span>,<span class="string">'99.44'</span>),</span><br><span class="line">	(<span class="string">'CSCO'</span>,<span class="string">'Cisco System Inc.'</span>,<span class="string">'23.78'</span>),</span><br><span class="line">	(<span class="string">'CVX'</span>,<span class="string">'Chevron Corporation'</span>,<span class="string">'115.91'</span>)]</span><br><span class="line">d=&#123;<span class="string">'AXP'</span>:<span class="string">'86.40'</span>,<span class="string">'BA'</span>:<span class="string">'122.64'</span>,<span class="string">'CAT'</span>:<span class="string">'99.44'</span>,<span class="string">'CSCO'</span>:<span class="string">'23.78'</span>,<span class="string">'CVX'</span>:<span class="string">'115.91'</span>&#125;</span><br></pre></td></tr></table></figure>

<p>ç­”æ¡ˆï¼šä»åˆ—è¡¨æ„é€ å­—å…¸ï¼Œæ ¹æ®å®šä¹‰å¯ä»¥ç›´æ¥ä½¿ç”¨<code>d={a:c for a,b,c in lst}</code></p>
</li>
<li><p>å¦‚ä½•æŠŠä¸€ä¸ªå­—å…¸ä¸­çš„<code>key</code>å’Œ<code>value</code>äº’æ¢ï¼Ÿ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">d=&#123;<span class="string">'blue'</span>:<span class="number">500</span>, <span class="string">'green'</span>:<span class="number">300</span>, <span class="string">'red'</span>:<span class="number">100</span>&#125;</span><br><span class="line">&#123;<span class="number">100</span>:<span class="string">'red'</span>, <span class="number">300</span>:<span class="string">'green'</span>, <span class="number">500</span>:<span class="string">'blue'</span>&#125;</span><br></pre></td></tr></table></figure>

<p>ç­”æ¡ˆï¼šä½¿ç”¨<code>items</code>å±æ€§å³å¯ï¼Œ<code>new_d={value:key for key, value in d.items()}</code></p>
</li>
</ol>
<h3 id="è¯¾åä½œä¸š"><a href="#è¯¾åä½œä¸š" class="headerlink" title="è¯¾åä½œä¸š"></a>è¯¾åä½œä¸š</h3><ol>
<li>åˆ©ç”¨å†…ç½®æ•°æ®ç±»å‹å¯¹æç™½å’Œæœç”«çš„è¯—æ­Œè¿›è¡Œåˆ†æï¼ŒåŒ…æ‹¬ï¼š</li>
</ol>
<p>(1)è¯»å…¥æç™½.txtï¼Œå¾—åˆ°æç™½è¯—æ­Œå†…å®¹ä¸­çš„æ‰€æœ‰çš„æ±‰å­—ï¼Œå¹¶è¿›ä¸€æ­¥å¾—åˆ°å…¶ä¸­çš„ä¸é‡å¤æ±‰å­—ï¼Œæœ€åæ‰“å°æ‰€æœ‰æ±‰å­—çš„ä¸ªæ•°ã€ä¸é‡å¤æ±‰å­—çš„ä¸ªæ•°ã€ä»¥åŠä¸é‡å¤æ±‰å­—ï¼Œæ‰“å°æ±‰å­—æ—¶è¦æ±‚æ¯è¡Œ10ä¸ªæ±‰å­—ï¼Œæ±‰å­—ä¹‹é—´ä»¥2ä¸ªç©ºæ ¼åˆ†å¼€ã€‚</p>
<p>(2)è¿›ä¸€æ­¥åˆ©ç”¨å­—å…¸è¿›è¡Œæç™½è¯—æ­Œçš„å­—é¢‘ç»Ÿè®¡ï¼Œå³ç»Ÿè®¡æ¯ä¸ªå­—å‡ºç°çš„æ¬¡æ•°ï¼Œå¹¶å¯¹å­—é¢‘è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼ˆå³é™¤ä»¥è¯—æ­Œç¯‡æ•°ï¼‰ï¼Œç„¶åè¾“å‡ºæ˜¾ç¤ºå­—é¢‘ç»Ÿè®¡ç»“æœï¼Œè¾“å‡ºæ˜¾ç¤ºæ—¶æ ¹æ®å­—é¢‘é™åºæ’åˆ—ï¼Œåªæ‰“å°é¢‘ç‡å¤§äºç­‰äº0.1çš„ç»“æœï¼Œå¹¶æ³¨æ„å¯¹é½ã€‚</p>
<p>(3)é‡‡ç”¨åŒä¸Šè¿°ç›¸åŒçš„æ–¹æ³•ï¼Œå¾—åˆ°æœç”«è¯—æ­Œçš„å­—é¢‘ç»Ÿè®¡ç»“æœã€‚åœ¨æ­¤åŸºç¡€ä¸Šè·å¾—æç™½å’Œæœç”«çš„é«˜é¢‘è¯é›†åˆï¼ˆå³é¢‘ç‡å¤§äºç­‰äº0.1çš„æ±‰å­—é›†åˆï¼‰ï¼Œåˆ©ç”¨é›†åˆæ“ä½œè¿›ä¸€æ­¥è·å¾—ä¸¤ä½è¯—äººéƒ½çˆ±ç”¨çš„å­—ã€æç™½çˆ±ç”¨ä½†æœç”«ä¸çˆ±ç”¨çš„å­—ä»¥åŠæœç”«çˆ±ç”¨è€Œæç™½ä¸çˆ±ç”¨çš„å­—ï¼Œå¹¶è¾“å‡ºä¸Šè¿°ç»“æœï¼Œè¾“å‡ºæ—¶æ¯è¡Œ10ä¸ªå•è¯ï¼Œæ±‰å­—ä¹‹é—´ä»¥2ä¸ªç©ºæ ¼åˆ†å¼€ã€‚</p>
<p>è¯´æ˜ï¼šç»Ÿè®¡æ—¶ä¸è€ƒè™‘é¢˜ç›®ã€æœä»£ã€ä½œè€…ï¼Œåªè€ƒè™‘è¯—æ­Œå†…å®¹ã€‚</p>
<p>ä½œä¸šæ€è·¯ï¼š</p>
<p>é¦–å…ˆæ˜¯è¦è¯»å–txtæ–‡ä»¶ï¼Œè¿™é‡Œä½œä¸šæç¤ºè¯´ç”¨ä¸‹è¿°ä»£ç æ¥è¯»å–æ–‡ä»¶ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">'æç™½.txt'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    poems_text = f.read()</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶æ•´ä¸ªæ–‡ä»¶çš„å†…å®¹ä½œä¸ºå­—ç¬¦ä¸²å­˜åœ¨<code>poems_text</code>ä¸­ï¼Œå¹¶ä¸”æ¯é¦–è¯—ä¹‹é—´æœ‰æ¢è¡Œç¬¦ï¼Œå› æ­¤ä½¿ç”¨<code>poems_list = poems_text.splitlines()</code>å°†æ¯é¦–è¯—ä½œä¸ºåˆ—è¡¨<code>poems_list</code>ä¸­çš„å…ƒç´ ï¼ˆå­—ç¬¦ä¸²ï¼‰å­˜å‚¨ã€‚</p>
<p>æ¥ä¸‹æ¥éå†åˆ—è¡¨å…ƒç´ ï¼Œå› ä¸ºæ¯é¦–è¯—æ ¼å¼éƒ½æ˜¯â€œæ ‡é¢˜ æœä»£ ä½œè€… è¯—æ­Œå†…å®¹â€è¿™æ ·ï¼Œæ‰€ä»¥å¯¹æ¯ä¸ªå­—ç¬¦ä¸²æŸ¥æ‰¾ä½œè€…åå­—ï¼Œå¹¶åªç•™å­˜ä½œè€…åå­—ä¹‹åçš„å­—ç¬¦ä¸²å†…å®¹ï¼Œå°±å¯ä»¥å¾—åˆ°æˆ‘ä»¬éœ€è¦ç»Ÿè®¡çš„è¯—æ­Œå†…å®¹ï¼Œå†å»æ‰ä¸­æ–‡æ ‡ç‚¹ã€è‹±æ–‡æ ‡ç‚¹å’Œç©ºæ ¼ï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªå¤„ç†å¥½çš„è¯—æ­Œå†…å®¹åˆ—è¡¨ï¼Œè¿™éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(poems_list)):</span><br><span class="line">    index = poems_list[i].find(name)</span><br><span class="line">    poems_list[i] = poems_list[i][index + <span class="number">3</span>:]</span><br><span class="line">    poems_list[i] = poems_list[i].translate(str.maketrans(<span class="string">''</span>, <span class="string">''</span>, zhon.hanzi.punctuation))</span><br><span class="line">    poems_list[i] = poems_list[i].translate(str.maketrans(<span class="string">''</span>, <span class="string">''</span>, string.punctuation))</span><br><span class="line">    poems_list[i] = poems_list[i].translate(str.maketrans(<span class="string">''</span>, <span class="string">''</span>, <span class="string">' '</span>))</span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶<code>poems_num = len(poems_list)</code>å³å¯å¾—åˆ°è¯—æ­Œæ€»æ•°ï¼Œ<code>poems_text = &#39;&#39;.join(poems_list)</code>å³å¯å¾—åˆ°å¤„ç†å¥½ä¹‹åçš„å­—ç¬¦ä¸²ã€‚ç„¶åè¿›è¡Œç»Ÿè®¡ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨<code>poems_counter = collections.Counter(poems_text)</code>å¯ä»¥å¾—åˆ°ä¸€ä¸ª<code>Counter</code>è®¡æ•°å™¨ï¼Œè¯¥è®¡æ•°å™¨æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œ<code>key</code> æ˜¯å­—ï¼Œ<code>val</code>æ˜¯è¯¥å­—å‡ºç°çš„æ¬¡æ•°ï¼ŒæŒ‰å‡ºç°æ¬¡æ•°éå†è¿™ä¸ªè®¡æ•°å™¨ï¼Œå¹¶æŠŠ<code>key</code>åŠ å…¥åˆ°é›†åˆ<code>poems_set</code>ä¸­ï¼Œå½“å­—é¢‘ï¼ˆ<code>val/poems_num</code>ï¼‰ä½äº0.1æ—¶ï¼Œbreakç»“æŸéå†ï¼Œè¿™æ ·å°±å¾—åˆ°äº†é«˜é¢‘å­—çš„é›†åˆï¼Œè¿™éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> key, val <span class="keyword">in</span> poems_counter.most_common():</span><br><span class="line">    <span class="keyword">if</span> val / poems_num &lt; <span class="number">0.1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    poems_set.add(key)</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥é€šè¿‡é›†åˆè¿ç®—å°±å¯ä»¥å¾—åˆ°æç™½å’Œæœç”«çš„äº¤é›†å’Œå·®é›†äº†ã€‚</p>
<p>å…³äºæ ¼å¼åŒ–è¾“å‡ºï¼Œé¦–å…ˆæ˜¯è¾“å‡ºè¯—æ­Œæœ¬èº«çš„å­—æ•°ã€ä¸é‡å¤å­—æ•°å’Œä¸é‡å¤å­—ï¼Œæ¯10ä¸ªæ¢è¡Œï¼Œå­—ä¸­é—´æ˜¯ä¸¤ä¸ªç©ºæ ¼ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">print(name + <span class="string">'è¯—è¯ä¸­æ€»å…±æœ‰'</span> + str(len(poems_text)) + <span class="string">'ä¸ªæ±‰å­—ï¼Œå…¶ä¸­ä¸é‡å¤çš„æ±‰å­—æœ‰'</span> + str(len(poems_counter)) + <span class="string">'ä¸ªï¼Œå…·ä½“å¦‚ä¸‹ï¼š'</span>)</span><br><span class="line">print_num = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> poems_counter:</span><br><span class="line">    print(key, end=<span class="string">'  '</span>)</span><br><span class="line">    print_num += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> print_num % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">        print()</span><br><span class="line">print()</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥æ˜¯å­—é¢‘ç»Ÿè®¡çš„è¾“å‡ºï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">print(<span class="string">'å­—é¢‘ç»Ÿè®¡ä¿¡æ¯å¦‚ä¸‹ï¼š\næ±‰å­—---é¢‘ç‡'</span>)</span><br><span class="line"><span class="keyword">for</span> key, val <span class="keyword">in</span> poems_counter.most_common():</span><br><span class="line">    <span class="keyword">if</span> val / poems_num &lt; <span class="number">0.1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    print(<span class="string">'&#123;&#125;\t &#123;&#125;'</span>.format(key, val / poems_num))</span><br></pre></td></tr></table></figure>

<p>æœ€åæ˜¯å­—é¢‘é›†åˆçš„è¾“å‡ºï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">print_num = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> set:</span><br><span class="line">    print(i, end=<span class="string">'  '</span>)</span><br><span class="line">    print_num += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> print_num % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">        print()</span><br><span class="line">print()</span><br></pre></td></tr></table></figure>



<p>æ•´ä½“ä»£ç æˆ‘æŠŠè¯—æ­Œçš„é¢„å¤„ç†éƒ¨åˆ†ä½œä¸ºä¸€ä¸ªå‡½æ•°ã€è¯—æ­Œè¾“å‡ºä½œä¸ºä¸€ä¸ªå‡½æ•°ã€é›†åˆè¾“å‡ºä½œä¸ºä¸€ä¸ªå‡½æ•°ï¼Œæœ€åä¸»å‡½æ•°è°ƒç”¨å®ƒä»¬ã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> zhon.hanzi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">poems</span><span class="params">(name)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(name + <span class="string">'.txt'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        poems_text = f.read()</span><br><span class="line">    poems_list = poems_text.splitlines()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(poems_list)):</span><br><span class="line">        index = poems_list[i].find(name)</span><br><span class="line">        poems_list[i] = poems_list[i][index + <span class="number">3</span>:]</span><br><span class="line">        poems_list[i] = poems_list[i].translate(str.maketrans(<span class="string">''</span>, <span class="string">''</span>, zhon.hanzi.punctuation))</span><br><span class="line">        poems_list[i] = poems_list[i].translate(str.maketrans(<span class="string">''</span>, <span class="string">''</span>, string.punctuation))</span><br><span class="line">        poems_list[i] = poems_list[i].translate(str.maketrans(<span class="string">''</span>, <span class="string">''</span>, <span class="string">' '</span>))</span><br><span class="line">    poems_num = len(poems_list)</span><br><span class="line">    poems_text = <span class="string">''</span>.join(poems_list)</span><br><span class="line">    poems_counter = collections.Counter(poems_text)</span><br><span class="line">    poems_set = set()</span><br><span class="line">    <span class="keyword">for</span> key, val <span class="keyword">in</span> poems_counter.most_common():</span><br><span class="line">        <span class="keyword">if</span> val / poems_num &lt; <span class="number">0.1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        poems_set.add(key)</span><br><span class="line">    <span class="keyword">return</span> poems_num, poems_text, poems_counter, poems_set</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_poem</span><span class="params">(name, poems_num, poems_text, poems_counter)</span>:</span></span><br><span class="line">    print(name + <span class="string">'è¯—è¯ä¸­æ€»å…±æœ‰'</span> + str(len(poems_text)) + <span class="string">'ä¸ªæ±‰å­—ï¼Œå…¶ä¸­ä¸é‡å¤çš„æ±‰å­—æœ‰'</span> + str(len(poems_counter)) + <span class="string">'ä¸ªï¼Œå…·ä½“å¦‚ä¸‹ï¼š'</span>)</span><br><span class="line">    print_num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> poems_counter:</span><br><span class="line">        print(key, end=<span class="string">'  '</span>)</span><br><span class="line">        print_num += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> print_num % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">            print()</span><br><span class="line">    print()</span><br><span class="line">    print(<span class="string">'å­—é¢‘ç»Ÿè®¡ä¿¡æ¯å¦‚ä¸‹ï¼š\næ±‰å­—---é¢‘ç‡'</span>)</span><br><span class="line">    <span class="keyword">for</span> key, val <span class="keyword">in</span> poems_counter.most_common():</span><br><span class="line">        <span class="keyword">if</span> val / poems_num &lt; <span class="number">0.1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        print(<span class="string">'&#123;&#125;\t &#123;&#125;'</span>.format(key, val / poems_num))</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_set</span><span class="params">(set)</span>:</span></span><br><span class="line">    print_num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> set:</span><br><span class="line">        print(i, end=<span class="string">'  '</span>)</span><br><span class="line">        print_num += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> print_num % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">            print()</span><br><span class="line">    print()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">num_libai, text_libai, counter_libai, set_libai = poems(<span class="string">'æç™½'</span>)</span><br><span class="line">num_dufu, text_dufu, counter_dufu, set_dufu = poems(<span class="string">'æœç”«'</span>)</span><br><span class="line">print_poem(<span class="string">'æç™½'</span>, num_libai, text_libai, counter_libai)</span><br><span class="line">print_poem(<span class="string">'æœç”«'</span>, num_dufu, text_dufu, counter_dufu)</span><br><span class="line">s_both_love = set_libai &amp; set_dufu</span><br><span class="line">s_only_libai = set_libai - set_dufu</span><br><span class="line">s_only_dufu = set_dufu - set_libai</span><br><span class="line">print(<span class="string">'ä¸¤ä½è¯—äººéƒ½çˆ±ç”¨çš„å­—æœ‰'</span> + str(len(s_both_love)) + <span class="string">'ä¸ªï¼Œè¿™äº›å­—ä¸ºï¼š'</span>)</span><br><span class="line">print_set(s_both_love)</span><br><span class="line">print(<span class="string">'æç™½çˆ±ç”¨ä½†æœç”«ä¸çˆ±ç”¨çš„å­—æœ‰'</span>+str(len(s_only_libai))+<span class="string">'ä¸ªï¼Œè¿™äº›å­—ä¸ºï¼š'</span>)</span><br><span class="line">print_set(s_only_libai)</span><br><span class="line">print(<span class="string">'æœç”«çˆ±ç”¨ä½†æç™½ä¸çˆ±ç”¨çš„å­—æœ‰'</span>+str(len(s_only_libai))+<span class="string">'ä¸ªï¼Œè¿™äº›å­—ä¸ºï¼š'</span>)</span><br><span class="line">print_set(s_only_dufu)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>è¯¾ç¨‹ç¬”è®°</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonè¯¾ç¨‹è®°å½•-4</title>
    <url>/2020/03/23/python%E8%AF%BE%E7%A8%8B%E8%AE%B0%E5%BD%95-4/</url>
    <content><![CDATA[<p>è¿™ä¸€è¯¾æ˜¯è®²å­—ç¬¦ä¸²çš„ï¼Œä¸»è¦æ˜¯å‡ ç§å­—ç¬¦ä¸²å‡½æ•°ã€‚</p>
<a id="more"></a>

<h3 id="è¯¾å ‚ç»ƒä¹ "><a href="#è¯¾å ‚ç»ƒä¹ " class="headerlink" title="è¯¾å ‚ç»ƒä¹ "></a>è¯¾å ‚ç»ƒä¹ </h3><ol>
<li><p>ä¸‹é¢ä»£ç çš„è¿è¡Œç»“æœæ˜¯ï¼ˆï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">	print(i)</span><br><span class="line">	s.remove(i)</span><br></pre></td></tr></table></figure>

<p>A. 1 2 3 4 5ï¼ˆä¸€ä¸ªæ•°å­—ä¸€è¡Œï¼‰</p>
<p>B. 1 3 5ï¼ˆä¸€ä¸ªæ•°å­—ä¸€è¡Œï¼‰</p>
<p>ç­”æ¡ˆï¼šæ˜¾ç„¶è¿™é‡Œ<code>s</code>æ˜¯ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨çš„<code>remove()</code>å‡½æ•°çš„ä½œç”¨æ˜¯ç§»é™¤æŒ‡å®šå…ƒç´ ï¼Œåªç§»é™¤åŒ¹é…åˆ°çš„ç¬¬ä¸€ä¸ªã€‚æŒ‰é¡ºåºçœ‹ï¼Œæœ€åˆåˆ—è¡¨æ˜¯<code>s=[1,2,3,4,5]</code>ï¼Œ<code>for</code>å¾ªç¯è®¿é—®åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º<code>1</code>ï¼Œæ¥ç€ç§»é™¤<code>1</code>ï¼Œè¿™ä¹‹ååˆ—è¡¨<code>s</code>çš„å…ƒç´ ä¼šæ•´ä½“å¾€å‰æŒªä¸€ä½ï¼Œå˜æˆ<code>s=[2,3,4,5]</code>ï¼Œæ­¤æ—¶ç¬¬ä¸€ä¸ªå…ƒç´ å˜æˆ<code>2</code>ï¼Œç¬¬äºŒä¸ªå…ƒç´ å˜æˆ<code>3</code>ï¼Œè€Œ<code>for</code>å¾ªç¯ä¼šå»æ‰¾åˆ—è¡¨çš„ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è·³è¿‡<code>2</code>è®¿é—®<code>3</code>ï¼Œè¾“å‡ºå¹¶ç§»é™¤ï¼Œå˜æˆ<code>s=[2,4,5]</code>ï¼Œç„¶åè¾“å‡ºå¹¶ç§»é™¤ç¬¬ä¸‰ä¸ªå…ƒç´ <code>5</code>ã€‚</p>
<p>æ‰€ä»¥æœ€åè¾“å‡ºçš„æ˜¯<code>1 3 5</code>ï¼Œé€‰Bã€‚</p>
</li>
<li><p>ä¸‹åˆ—æ“ä½œçš„ç»“æœæ˜¯ï¼ˆï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s=<span class="string">'!..Hi!!!.'</span></span><br><span class="line">s.strip(<span class="string">'!.'</span>)</span><br></pre></td></tr></table></figure>

<p>A. â€˜.Hi!!!â€™        B. â€˜.Hi!!!.â€™        C. â€˜!..Hi!!â€™        D. â€˜Hiâ€™</p>
<p>ç­”æ¡ˆï¼šå­—ç¬¦ä¸²çš„<code>strip</code>å‡½æ•°æ˜¯ç§»é™¤å­—ç¬¦ä¸²å·¦å³ä¸¤è¾¹çš„æŒ‡å®šå­—ç¬¦å…ƒç´ ï¼Œå¦‚æœæ²¡æŒ‡å®šå°±ç§»é™¤ç©ºæ ¼ï¼Œç„¶åé‡åˆ°ç¬¬ä¸€ä¸ªä¸æ˜¯æŒ‡å®šå…ƒç´ çš„æ—¶å€™å°±åœæ­¢ç§»é™¤æ“ä½œï¼Œå¹¶ä¸”æŒ‡å®šå…ƒç´ ä¸ä¼šè¿èµ·æ¥çœ‹ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œçš„<code>!</code>å’Œ<code>.</code>æ˜¯ä¼šè¢«çœ‹åšä¸¤ä¸ªå…ƒç´ ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„å­—ç¬¦ä¸²ï¼Œå› æ­¤ç§»é™¤çš„æ—¶å€™å¹¶ä¸æ˜¯æ‰¾è¿ç»­çš„<code>!.</code>ï¼Œè€Œæ˜¯ç§»é™¤å·¦å³ä¸¤è¾¹æ‰€æœ‰<code>!</code>å’Œ<code>.</code>ï¼Œä¹Ÿå°±æ˜¯é€‰Dã€‚</p>
</li>
<li><p>ç”¨ä¸€è¡Œä»£ç æŠŠå­—ç¬¦ä¸²<code>s=&#39;  abcdbacbaab&#39;</code>ä¸­çš„<code>b</code>å»æ‰ã€‚</p>
<p>ç­”æ¡ˆï¼šé¦–å…ˆå¯ä»¥ç”¨å­—ç¬¦ä¸²ä¸­çš„ç¿»è¯‘å‡½æ•°ï¼Œå°†æ‰€æœ‰<code>b</code>ç¿»è¯‘æˆç©ºå­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯<code>s.translate(str.maketrans(&#39;&#39;, &#39;&#39;,&#39;b&#39;))</code>ã€‚æœ€ç›´æ¥çš„æ–¹æ³•æ˜¯ç”¨å­—ç¬¦ä¸²çš„<code>replace</code>å‡½æ•°ï¼Œå°†<code>b</code>æ›¿æ¢æˆç©ºå­—ç¬¦ï¼Œå³<code>s=s.replace(&#39;b&#39;,&#39;&#39;)</code>ã€‚</p>
</li>
<li><p>åˆ¤æ–­ä¸¤ä¸ªå•è¯s1å’Œs2æ˜¯å¦æ„æˆå­—è°œï¼šå³s1å’Œs2çš„å­—æ¯å’Œä¸ªæ•°ç›¸åŒï¼Œåªæ˜¯é¡ºåºä¸åŒï¼Œå¦‚cinemaä½•icemanï¼Œè¦æ±‚åªç”¨ä¸€è¡Œä»£ç ã€‚</p>
<p>ç­”æ¡ˆï¼šå¦‚æœä¸è¦æ±‚åªç”¨ä¸€è¡Œä»£ç ï¼Œé‚£åŠæ³•æœ‰å¾ˆå¤šäº†ï¼Œç°åœ¨è¦æ±‚åªç”¨ä¸€è¡Œä»£ç ï¼Œå› æ­¤åªèƒ½é‡‡ç”¨å­—ç¬¦ä¸²çš„<code>sorted()</code>å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªæ’å¥½åºçš„å­—ç¬¦ä¸²ï¼Œå› æ­¤å¯ä»¥é€šè¿‡<code>sorted(s1)==sorted(s2)</code>æ¥åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ„æˆå­—è°œã€‚</p>
</li>
<li><p>å¦‚ä½•å°†<code>s=&#39;d,f,a,c,b,d,g,e,a,f&#39;</code>ä¸­çš„å­—æ¯è¿›è¡Œæ’åºï¼Œå¾—åˆ°æ–°çš„å­—ç¬¦ä¸²<code>s=&#39;a,a,b,c,d,d,e,f,f,g&#39;</code>ï¼Ÿ</p>
<p>ç­”æ¡ˆï¼šç›´æ¥æ¥è¯´å°±æ˜¯è¦æŠŠåŸå­—ç¬¦ä¸²ä¸­çš„<code>,</code>å»æ‰ï¼Œå‰©ä¸‹çš„å­—ç¬¦ä¸²æŒ‰å­—æ¯é¡ºåºæ’åºï¼Œç„¶åå†æŠŠ<code>,</code>åŠ å›æ¥ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s=<span class="string">'d,f,a,c,b,d,g,e,a,f'</span> </span><br><span class="line">s1=s.replace(<span class="string">','</span>,<span class="string">''</span>) </span><br><span class="line">s2=sorted(s1) </span><br><span class="line"><span class="string">','</span>.join(s2)</span><br></pre></td></tr></table></figure>

<h3 id="è¯¾åç»ƒä¹ "><a href="#è¯¾åç»ƒä¹ " class="headerlink" title="è¯¾åç»ƒä¹ "></a>è¯¾åç»ƒä¹ </h3><ol>
<li><p>åœ¨ç¬¬ä¸€è¯¾ç»ƒä¹ çš„åŸºç¡€ä¸Šï¼Œåˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ˜¯å›æ–‡ä¸²ï¼ˆè§„åˆ™æ›´å®½æ¾ï¼‰ï¼š</p>
<p>ä¾‹å¦‚ï¼šMadam, Iâ€™m Adam                 True</p>
<p>A man, a plan, a canal, Panama!                True</p>
<p>å®¢ä¸Šå¤©ç„¶å±…ï¼Œå±…ç„¶å¤©ä¸Šå®¢.                True</p>
<p>ç­”æ¡ˆï¼šæˆ‘çš„æ€è·¯æ˜¯æŠŠå­—ç¬¦ä¸²é‡Œæ‰€æœ‰çš„æ ‡ç‚¹å’Œç©ºæ ¼å»æ‰ï¼Œç„¶åæŠŠæ‰€æœ‰å­—æ¯éƒ½è½¬æˆå°å†™å­—æ¯ï¼Œæœ€åç”¨ä¹‹å‰å†™å¥½çš„å‡½æ•°æ¥åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦æ˜¯å›æ–‡ä¸²ã€‚ <code>string.punctuation</code>ä¸­å­˜æœ‰æ‰€æœ‰æ ‡ç‚¹ç¬¦å·ï¼Œå› æ­¤å¯ä»¥å°†å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„<code>string.punctuation</code>æ›¿æ¢æˆç©ºå­—ç¬¦ï¼Œä»è€Œå»æ‰æ ‡ç‚¹ï¼›ç©ºæ ¼åŒç†ï¼›<code>casefold()</code>å‡½æ•°å¯ä»¥ä½¿å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„å­—ç¬¦éƒ½å˜æˆå°å†™ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_palindromic4</span><span class="params">(num)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> num == num[::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">del_space_punc</span><span class="params">(s)</span>:</span></span><br><span class="line">    s_1=s.translate(str.maketrans(<span class="string">''</span>, <span class="string">''</span>, string.punctuation))</span><br><span class="line">    s_2=s_1.translate(str.maketrans(<span class="string">''</span>, <span class="string">''</span>, <span class="string">' '</span>))</span><br><span class="line">    s_3=s_2.casefold()</span><br><span class="line">    <span class="keyword">return</span> s_3</span><br><span class="line">    </span><br><span class="line">s1 = <span class="string">"Madam, I'm Adam"</span></span><br><span class="line">s2 = <span class="string">"A man, a plan, a canal, Panama!"</span></span><br><span class="line">s3 = <span class="string">"å®¢ä¸Šå¤©ç„¶å±…ï¼Œå±…ç„¶å¤©ä¸Šå®¢."</span></span><br><span class="line"></span><br><span class="line">print(is_palindromic4(del_space_punc(s1)))</span><br><span class="line">print(is_palindromic4(del_space_punc(s2)))</span><br><span class="line">print(is_palindromic4(del_space_punc(s3)))</span><br></pre></td></tr></table></figure>
</li>
<li><p>è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²aå’Œå­—ç¬¦ä¸²bï¼ŒæŸ¥æ‰¾båœ¨aä¸­çš„æ‰€æœ‰ä½ç½®å¹¶è¾“å‡ºæ˜¾ç¤ºã€‚</p>
<p>ä¾‹å¦‚ï¼šè¯·è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼šabcdeabcdeab</p>
<p>è¯·è¾“å…¥å¦ä¸€ä¸ªå­—ç¬¦ä¸²ï¼šab</p>
<p>è¾“å‡º0 5 10</p>
<p>ç­”æ¡ˆï¼šç›´æ¥ä¸€äº›çš„æƒ³æ³•æ˜¯éå†å­—ç¬¦ä¸²æ£€ç´¢<code>a</code>ï¼Œç„¶åçœ‹ä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯<code>b</code>ï¼Œä¸è¿‡ç™¾åº¦ä¹‹åå‘ç°å¯ä»¥ç›´æ¥ç”¨æ­£åˆ™åŒ¹é…ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">a = input(<span class="string">'è¯·è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼š'</span>)</span><br><span class="line">b = input(<span class="string">'è¯·è¾“å…¥å¦ä¸€ä¸ªå­—ç¬¦ä¸²ï¼š'</span>)</span><br><span class="line">print([i.start() <span class="keyword">for</span> i <span class="keyword">in</span> re.finditer(b,a)])</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç»Ÿè®¡ä¸€ç¯‡æ–‡ç« ï¼ˆçœ‹æˆä¸€ä¸ªé•¿å­—ç¬¦ä¸²ï¼‰ä¸­å•è¯çš„ä¸ªæ•°ï¼Œä»¥åŠæ–‡ç« ä¸­ä¸åŒå•è¯çš„ä¸ªæ•°åŠåˆ—è¡¨ï¼Œæœ€åè¾“å‡ºæ˜¾ç¤ºã€‚ï¼ˆå¤‡æ³¨ï¼šå•è¯çš„ä¸åŒæ—¶æ€ ä»¥åŠå•å¤æ•°éƒ½çœ‹æˆæ˜¯ä¸åŒçš„å•è¯ï¼‰ã€‚å­—ç¬¦ä¸²ä¸ºå˜é‡speechï¼Œ<code>speech=&#39;&#39;&#39;  Four score and seven years ago our fathers brought forth on this continent, a new nation, conceived in Liberty, and dedicated to the proposition that all men are created equal. Now we are engaged in a great civil war, testing whether that nation, or any nation so conceived and so dedicated, can long endure. We are met on a great battle-field of that war. We have come to dedicate a portion of that field, as a final resting place for those who here gave their lives that that nation might live. It is altogether fitting and proper that we should do this. But, in a larger sense, we can not dedicate -- we can not consecrate -- we can not hallow -- this ground. The brave men, living and dead, who struggled here, have consecrated it, far above our poor power to add or detract. The world will little note, nor long remember what we say here, but it can never forget what they did here. It is for us the living, rather, to be dedicated here to the unfinished work which they who fought here have thus far so nobly advanced. It is rather for us to be here dedicated to the great task remaining before us -- that from these honored dead we take increased devotion to that cause for which they gave the last full measure of devotion -- that we here highly resolve that these dead shall not have died in vain -that this nation, under God, shall have a new birth of freedom -- and that government of the people, by the people, for the people, shall not perish from the earth.&#39;&#39;&#39;</code></p>
<p>ç­”æ¡ˆï¼šå—ä¸Šä¸€é¢˜çš„å½±å“ï¼Œè¿™é‡Œä¹Ÿè€ƒè™‘ç”¨æ­£åˆ™åŒ¹é…æ¥åˆ¤æ–­æœ‰å¤šå°‘ä¸ªå•è¯ï¼Œå¹¶æŠŠå•è¯æ”¾åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œå†æ ¹æ®åˆ—è¡¨å»ºç«‹å­—å…¸ä»è€Œè¾“å‡ºè¯é¢‘ã€‚ç»Ÿè®¡è¯é¢‘å¯ä»¥ç”¨<code>collections.Counter</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">speech=<span class="string">'''  Four score and seven years ago our fathers brought forth on this continent, a new nation, conceived in Liberty, and dedicated to the proposition that all men are created equal. Now we are engaged in a great civil war, testing whether that nation, or any nation so conceived and so dedicated, can long endure. We are met on a great battle-field of that war. We have come to dedicate a portion of that field, as a final resting place for those who here gave their lives that that nation might live. It is altogether fitting and proper that we should do this. But, in a larger sense, we can not dedicate -- we can not consecrate -- we can not hallow -- this ground. The brave men, living and dead, who struggled here, have consecrated it, far above our poor power to add or detract. The world will little note, nor long remember what we say here, but it can never forget what they did here. It is for us the living, rather, to be dedicated here to the unfinished work which they who fought here have thus far so nobly advanced. It is rather for us to be here dedicated to the great task remaining before us -- that from these honored dead we take increased devotion to that cause for which they gave the last full measure of devotion -- that we here highly resolve that these dead shall not have died in vain -that this nation, under God, shall have a new birth of freedom -- and that government of the people, by the people, for the people, shall not perish from the earth.'''</span></span><br><span class="line">words=re.findall(<span class="string">r'[a-zA-Z]+'</span>,speech)</span><br><span class="line">count=len(words)</span><br><span class="line">print(<span class="string">'å•è¯å‡ºç°æ¬¡æ•°ï¼š'</span>,count)</span><br><span class="line">list2 = collections.Counter(words)</span><br><span class="line">print(dict(list2))</span><br></pre></td></tr></table></figure>



</li>
</ol>
</li>
</ol>
]]></content>
      <categories>
        <category>è¯¾ç¨‹ç¬”è®°</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>Let-s-Build-A-Simple-Interpreterç¬”è®°-8</title>
    <url>/2020/03/23/Let-s-Build-A-Simple-Interpreter%E7%AC%94%E8%AE%B0-8/</url>
    <content><![CDATA[<p>è¿˜æ²¡å¼€å§‹çœ‹ï¼Œçœ‹å®Œå†å†™ã€‚</p>
]]></content>
      <categories>
        <category>Let&#39;s Build A Simple Interpreter</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>ç¼–è¯‘åŸç†</tag>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>Let-s-Build-A-Simple-Interpreterç¬”è®°-7</title>
    <url>/2020/03/15/Let-s-Build-A-Simple-Interpreter%E7%AC%94%E8%AE%B0-7/</url>
    <content><![CDATA[<h2 id="è¯¾ç¨‹æ–‡æ¡£"><a href="#è¯¾ç¨‹æ–‡æ¡£" class="headerlink" title="è¯¾ç¨‹æ–‡æ¡£"></a>è¯¾ç¨‹æ–‡æ¡£</h2><p><a href="https://ruslanspivak.com/lsbasi-part7/" target="_blank" rel="noopener">åŸæ–‡</a></p>
<p><a href="https://feng-qi.github.io/2018/02/02/lets-build-a-simple-interpreter-part-07/" target="_blank" rel="noopener">ç¿»è¯‘</a></p>
<p>ï¼ˆè¿™æ¬¡ç¿»è¯‘åˆå‡ºç°äº†ä¸€äº›ä¸å½±å“ç†è§£çš„å°é—®é¢˜ã€‚è¯¾ç¨‹ä»£ç è¶Šæ¥è¶Šé•¿ï¼Œæˆ‘å†³å®šæ”¹ä¸€ä¸‹æ–‡æ¡£ç»“æ„ï¼Œä¸åœ¨ä¸€å¼€å§‹æ”¾æ•´å—ä»£ç äº†ã€‚ï¼‰</p>
<a id="more"></a>

<h2 id="ç¬”è®°"><a href="#ç¬”è®°" class="headerlink" title="ç¬”è®°"></a>ç¬”è®°</h2><p>è¿™ä¸€è¯¾çš„çŸ¥è¯†ç‚¹æ ¼å¤–å¤šã€‚</p>
<h4 id="æŠ½è±¡è¯­æ³•æ ‘å’Œè§£ææ ‘"><a href="#æŠ½è±¡è¯­æ³•æ ‘å’Œè§£ææ ‘" class="headerlink" title="æŠ½è±¡è¯­æ³•æ ‘å’Œè§£ææ ‘"></a>æŠ½è±¡è¯­æ³•æ ‘å’Œè§£ææ ‘</h4><ol>
<li><p>åœ¨ä¹‹å‰çš„ä»£ç ä¸­ï¼Œè¯æ³•åˆ†æç»“æŸåè¿›è¡Œè¯­æ³•åˆ†æçš„åŒæ—¶å°±å®Œæˆäº†è¿ç®—ï¼Œè¿™ç§ interpreter è¢«ç§°ä¸ºè¯­æ³•å¯¼å‘è§£é‡Šå™¨ (syntax-directed interpreter)ï¼Œå¯¹äºæ›´å¤æ‚çš„è¯­æ³•ç»“æ„ï¼Œæˆ‘ä»¬éœ€è¦å»ºç«‹ä¸€ä¸ªä¸­é—´è¡¨ç¤ºï¼ˆintermediate representation, IRï¼‰ï¼Œæˆ‘ä»¬çš„ parser ä¼š è´Ÿè´£æ„å»º IR è€Œ interpreter ä¼šç”¨æ¥è§£é‡Šç”± IR æ‰€ä»£è¡¨çš„è¾“å…¥ã€‚ä¸€èˆ¬æ¥è¯´ä¼šç”¨æ ‘æ¥æ„å»ºIRã€‚</p>
</li>
<li><p>è§£ææ ‘ï¼ˆæœ‰æ—¶å«åšå…·ä½“è¯­æ³•æ ‘ï¼‰æ˜¯ä¸€ä¸ªæ ¹æ®æˆ‘ä»¬çš„è¯­æ³•å®šä¹‰æ¥è¡¨ç¤ºä¸€é—¨è¯­è¨€çš„å¥æ³•ç»“æ„çš„æ ‘å½¢ç»“æ„ã€‚å®ƒåŸºæœ¬ä¸Šå±•ç¤ºäº†ä½ çš„ <code>parser</code> å¦‚ä½•è¯†åˆ«è¯­è¨€ç»“æ„æˆ–è€…ï¼Œ æ¢å¥è¯è¯´ï¼Œå®ƒå±•ç¤ºäº†ä½ è¯­æ³•çš„å¼€å§‹ç¬¦å·æ€ä¹ˆæ´¾ç”Ÿå‡ºè¯¥ç¼–ç¨‹è¯­è¨€ä¸­ä¸€ä¸ªç‰¹å®šçš„å­—ç¬¦ä¸²çš„ã€‚</p>
</li>
<li><p>æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰æ˜¯æˆ‘ä»¬çš„è§£é‡Šå™¨å’Œæœªæ¥ç¼–è¯‘å™¨é¡¹ç›®çš„ä¸­å¿ƒæ•°æ®ç»“æ„ã€‚</p>
</li>
<li><p>å¦‚ä¸‹å›¾ï¼Œåˆ†åˆ«æ˜¯çš„ASTå’Œè§£ææ ‘ã€‚</p>
<p><img src="https://github.com/kun-bin/image/blob/master/lsbasi_part7_ast_01.png?raw=true" alt="ASTå’Œè§£ææ ‘å¯¹æ¯”"></p>
</li>
<li><p>ç®€å•æ¥è¯´ï¼ŒASTå°±æ˜¯æŠŠæ“ä½œæ•°æ”¾åˆ°å¶èŠ‚ç‚¹ï¼Œæ“ä½œç¬¦æ”¾åˆ°ä¸­é—´èŠ‚ç‚¹å’Œæ ¹èŠ‚ç‚¹ï¼Œæ“ä½œç¬¦èŠ‚ç‚¹åœ¨æ ‘ä¸­çš„é«˜åº¦å¯ä»¥ä½“ç°è¿ç®—ä¼˜å…ˆçº§ï¼Œæ‹¬å·æ”¹å˜ä¼˜å…ˆçº§ä¹Ÿæ˜¯é€šè¿‡æ”¹å˜æ“ä½œç¬¦çš„é«˜åº¦ã€‚</p>
</li>
<li><p>å…·ä½“åˆ°ä»£ç ï¼Œé¦–å…ˆè¦æ„å»ºä¸€ä¸ªASTç±»ï¼Œç›®å‰è¿™ä¸ªç±»é‡Œä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œå°±åªæ˜¯ç”¨æ¥è®©åˆ«çš„ç±»ç»§æ‰¿ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AST</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥è¦å®šä¹‰è¿™ä¸ªæ ‘çš„èŠ‚ç‚¹ç±»ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># äºŒå…ƒæ“ä½œç¬¦ç±»ï¼Œç»§æ‰¿AST</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BinOp</span><span class="params">(AST)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, left, op, right)</span>:</span></span><br><span class="line">		self.left = left</span><br><span class="line">		self.token = self.op = op</span><br><span class="line">		self.right = right</span><br><span class="line">    </span><br><span class="line"><span class="comment"># æ•´æ•°ç±»ï¼Œç»§æ‰¿AST</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Num</span><span class="params">(AST)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, token)</span>:</span></span><br><span class="line">		self.token = token</span><br><span class="line">		self.value = token.value</span><br></pre></td></tr></table></figure>

<p><code>Token</code>è¿™ä¸ªç±»å’Œå‰å‡ è¯¾é‡Œçš„å®Œå…¨ä¸€è‡´ã€‚</p>
<p>åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬å°±åˆ›å»ºå¥½ASTçš„åŸºæœ¬ç»“æ„äº†ï¼Œæ¥ä¸‹æ¥å¯ä»¥é€šè¿‡èµ‹å€¼çš„æ–¹å¼ä¸€ç‚¹ç‚¹åˆ›å»ºä¸€ä¸ªè§£æå¼çš„ASTï¼Œä¾‹å¦‚<code>2*7+3</code>çš„ASTï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å»ºç«‹åŠ å·å’Œä¹˜å·çš„Token</span></span><br><span class="line">mul_token = Token(MUL, <span class="string">'*'</span>)</span><br><span class="line">plus_token = Token(PLUS, <span class="string">'+'</span>)</span><br><span class="line"><span class="comment"># å…ˆå»ºç«‹ä¹˜æ³•æ“ä½œç¬¦çš„èŠ‚ç‚¹</span></span><br><span class="line">mul_node = BinOp(</span><br><span class="line">    <span class="comment"># å·¦è¾¹æ˜¯ç¬¬ä¸€ä¸ªä¹˜æ•°</span></span><br><span class="line">    left=Num(Token(INTEGER, <span class="number">2</span>)),</span><br><span class="line">    <span class="comment"># æ˜¯ä¹˜æ³•</span></span><br><span class="line">    op=mul_token,</span><br><span class="line">    <span class="comment"># å³è¾¹æ˜¯ç¬¬äºŒä¸ªä¹˜æ•°</span></span><br><span class="line">    right=Num(Token(INTEGER, <span class="number">7</span>))</span><br><span class="line">)</span><br><span class="line"><span class="comment">#å»ºç«‹åŠ æ³•æ“ä½œç¬¦çš„èŠ‚ç‚¹</span></span><br><span class="line">add_node = BinOp(</span><br><span class="line">    <span class="comment"># å·¦è¾¹æ˜¯åˆšæ‰è¿›è¡Œçš„ä¹˜æ³•èŠ‚ç‚¹</span></span><br><span class="line">    left=mul_node,</span><br><span class="line">    <span class="comment"># ä¸­é—´æ˜¯åŠ å·</span></span><br><span class="line">    op=plus_token,</span><br><span class="line">    <span class="comment"># å³è¾¹æ˜¯åŠ æ•°</span></span><br><span class="line">    right=Num(Token(INTEGER, <span class="number">3</span>))</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
<li><p>æŠŠä¸Šè¿°å†…å®¹åˆå¹¶åˆ°ä¹‹å‰çš„ä»£ç ä¸­ï¼Œåœ¨<code>Lexer</code>å¾—åˆ°è¯æ³•å•å…ƒåï¼Œä¸æ˜¯ç›´æ¥è¿›è¡Œè¿ç®—ï¼Œè€Œæ˜¯å»ºç«‹ASTï¼Œå³ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parse</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, lexer)</span>:</span></span><br><span class="line">        å’Œä¹‹å‰ä¸€æ ·</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">error</span><span class="params">(self)</span>:</span></span><br><span class="line">        å’Œä¹‹å‰ä¸€æ ·</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">eat</span><span class="params">(self, token_type)</span>:</span></span><br><span class="line">        å’Œä¹‹å‰ä¸€æ ·</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">factor</span><span class="params">(self)</span>:</span></span><br><span class="line">        token = self.current_token</span><br><span class="line">		<span class="keyword">if</span> token.type == INTEGER:</span><br><span class="line">            self.eat(INTEGER)</span><br><span class="line">            <span class="comment"># ä¹‹å‰æ˜¯return token.value</span></span><br><span class="line">	    	<span class="keyword">return</span> Num(token)</span><br><span class="line">		<span class="keyword">elif</span> token.type == LPAREN:</span><br><span class="line">            self.eat(LPAREN)</span><br><span class="line">            <span class="comment"># ä¹‹å‰æ˜¯value = self.expr()</span></span><br><span class="line">            node = self.expr()</span><br><span class="line">            self.eat(RPAREN)</span><br><span class="line">            <span class="comment"># ä¹‹å‰æ˜¯return value</span></span><br><span class="line">            <span class="keyword">return</span> node</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">term</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># ä¹‹å‰æ˜¯value = self.factor()</span></span><br><span class="line">		node = self.factor()</span><br><span class="line">		<span class="keyword">while</span> self.current_token.type <span class="keyword">in</span> (MUL, DIV):</span><br><span class="line">            token = self.current_token</span><br><span class="line">            <span class="keyword">if</span> token.type == MUL:</span><br><span class="line">            	self.eat(MUL)</span><br><span class="line">                <span class="comment"># ä¹‹å‰æœ‰value *= self.factor()æ±‚å€¼</span></span><br><span class="line">            <span class="keyword">elif</span> token.type == DIV:</span><br><span class="line">            	self.eat(DIV)</span><br><span class="line">                <span class="comment"># ä¹‹å‰æœ‰value /= self.factor()æ±‚å€¼</span></span><br><span class="line">	    	node = BinOp(left=node, op=token, right=self.factor())</span><br><span class="line">        <span class="comment"># ä¹‹å‰æ˜¯return value</span></span><br><span class="line">		<span class="keyword">return</span> node</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">expr</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># ä¹‹å‰æ˜¯value = self.term()</span></span><br><span class="line">        node = self.term()</span><br><span class="line">		<span class="keyword">while</span> self.current_token.type <span class="keyword">in</span> (PLUS, MINUS):</span><br><span class="line">		    token = self.current_token</span><br><span class="line">	    	<span class="keyword">if</span> token.type == PLUS:</span><br><span class="line">				self.eat(PLUS)</span><br><span class="line">                <span class="comment"># ä¹‹å‰æœ‰value += self.factor()æ±‚å€¼</span></span><br><span class="line">	    	<span class="keyword">elif</span> token.type == MINUS:</span><br><span class="line">				self.eat(MINUS)</span><br><span class="line">                <span class="comment"># ä¹‹å‰æœ‰value -= self.factor()æ±‚å€¼</span></span><br><span class="line">	    	node = BinOp(left=node, op=token, right=self.term())</span><br><span class="line">        <span class="comment"># ä¹‹å‰æ˜¯return value</span></span><br><span class="line">		<span class="keyword">return</span> node</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self)</span>:</span></span><br><span class="line">		<span class="keyword">return</span> self.expr()</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼ŒåŸæœ¬æ±‚å€¼çš„åœ°æ–¹ï¼Œç°åœ¨æ”¹ä¸ºä¸æ–­ç»™<code>node</code>èµ‹å€¼ï¼Œè€Œ<code>node</code>åˆ™å±‚å±‚åµŒå¥—ï¼Œæœ€ç»ˆå¯ä»¥è¡¨è¾¾å‡ºASTã€‚</p>
</li>
<li><p>ä»¥<code>7 + 3 * (10 - 1)</code>ä¸ºä¾‹ï¼Œçœ‹è¿™ä»½ä»£ç ï¼š</p>
<ol>
<li><code>parse</code>è°ƒç”¨<code>expr()</code>ï¼Œè¿›å…¥<code>expr</code>ï¼›</li>
<li><code>expr</code>è°ƒç”¨<code>term</code>ï¼Œ<code>term</code>è°ƒç”¨<code>factor</code>ï¼Œå‘ç°æ˜¯<code>INTEGER</code>ï¼Œäºæ˜¯è¿”å›<code>Num(token(INTEGER,7))</code>ä½œä¸º<code>node</code>ï¼Œ<code>term</code>å‘ç°æ¥ä¸‹æ¥ä¸æ˜¯ä¹˜é™¤æ³•ï¼Œäºæ˜¯ç›´æ¥è¿”å›<code>node</code>ï¼Œå›åˆ°<code>expr</code>ï¼Œè¯¥èŠ‚ç‚¹ç±»å‹ä»¥ä¸‹ç®€å†™ä¸º<code>Num(7)</code>ï¼›</li>
<li><code>expr</code>å‘ç°æ¥ä¸‹æ¥æ˜¯åŠ æ³•ï¼Œäºæ˜¯<code>node</code>å˜ä¸º<code>BinOp(left=Num(7), op=Token(PLUS, &#39;+&#39;), right=self.term())</code>ï¼Œå†æ¬¡è°ƒç”¨<code>term</code>ï¼›</li>
<li><code>term</code>è°ƒç”¨<code>factor</code>å¾—åˆ°<code>Num(3)</code>ï¼Œæ¥ä¸‹æ¥æ˜¯ä¹˜æ³•ï¼Œäºæ˜¯è¿™é‡Œè¦è¿”å›ç»™ç¬¬ä¸‰æ­¥ä¸­<code>expr</code>çš„<code>right</code>çš„ä¸œè¥¿å˜æˆäº†<code>BinOp(left=Num(3), op=Token(MUL, &#39;*&#39;), right=self.factor())</code>ï¼Œæ˜¾ç„¶åˆè¦è°ƒç”¨<code>factor</code>ï¼›</li>
<li><code>factor</code>åˆ¤æ–­æ¥ä¸‹æ¥çš„å·¦æ‹¬å·ï¼Œäºæ˜¯è°ƒç”¨<code>expr</code>å¤„ç†ï¼Œå†…å®¹å’Œä¸Šé¢çš„ç±»ä¼¼ï¼Œä¼šè¿”å›<code>BinOp(left=Num(10), op=Token(MINUS, &#39;-&#39;), right=Num(1))</code>ç»™ç¬¬å››æ­¥çš„<code>right</code>ï¼›</li>
<li>ä»¥æ­¤ç±»æ¨ï¼Œæœ€ç»ˆ<code>parse</code>ä¸­å¾—åˆ°çš„æ˜¯<code>node=BinOp(left=Num(7), op=Token(PLUS, &#39;+&#39;), right=BinOp(left=Num(3), op=Token(MUL, &#39;*&#39;), BinOp(left=Num(10), op=Token(MINUS, &#39;-&#39;), right=Num(1))))</code>ã€‚</li>
</ol>
</li>
</ol>
<h4 id="éå†æ ‘æ±‚å€¼"><a href="#éå†æ ‘æ±‚å€¼" class="headerlink" title="éå†æ ‘æ±‚å€¼"></a>éå†æ ‘æ±‚å€¼</h4><ol>
<li><p>åœ¨å¾—åˆ°ASTä¹‹åï¼Œå°±è¦å¼€å§‹æ±‚å€¼äº†ï¼Œæˆ‘ä»¬é‡‡ç”¨ååºéå†çš„æ–¹æ³•æ¥éå†ASTè¿›è¡Œè¿ç®—ã€‚</p>
<ol>
<li><p>å‰åºéå†ï¼š<strong>æ ¹</strong>å·¦å³</p>
</li>
<li><p>ä¸­åºéå†ï¼šå·¦<strong>æ ¹</strong>å³</p>
</li>
<li><p>ååºéå†ï¼šå·¦å³<strong>æ ¹</strong></p>
</li>
<li><p>æ˜¾ç„¶å‰ä¸­åæ˜¯æŒ‡æ ¹èŠ‚ç‚¹çš„éå†è¾“å‡ºé¡ºåºï¼Œå¦‚ä¸‹å›¾çš„æ ‘ï¼Œå‰åºéå†çš„è¾“å‡ºç»“æœæ˜¯ï¼š1-&gt;2-&gt;4-&gt;6-&gt;7-&gt;3-&gt;5ï¼Œä¸­åºéå†æ˜¯4-&gt;6-&gt;7-&gt;2-&gt;1-&gt;5-&gt;3ï¼Œååºéå†æ˜¯7-&gt;6-&gt;4-&gt;2-&gt;5-&gt;3-&gt;1</p>
<p><img src="https://github.com/kun-bin/image/blob/master/visit.png?raw=true" alt="ä¸€æ£µæ ‘"></p>
</li>
<li><p>å¯¹åº”åˆ°ASTä¸­ï¼Œå°±æ˜¯å…ˆè®¿é—®<code>node</code>çš„<code>left</code>ï¼Œå¾—åˆ°ä¸€ä¸ªç»“æœï¼Œå†è®¿é—®<code>right</code>ï¼Œå¾—åˆ°å¦ä¸€ä¸ªç»“æœï¼Œæœ€åè®¿é—®ä¸­é—´çš„<code>op</code>ï¼Œè¿›è¡Œè¿ç®—ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">visit</span><span class="params">(node)</span>:</span></span><br><span class="line">    <span class="comment"># for every child node from left to right</span></span><br><span class="line">    <span class="keyword">for</span> child <span class="keyword">in</span> node.children:</span><br><span class="line">		visit(child)</span><br><span class="line">    <span class="comment"># æŒ‡åŠ å‡ä¹˜é™¤ç­‰è¿ç®—æ“ä½œ</span></span><br><span class="line">    &lt;&lt;postorder actions&gt;&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>æœ‰æ—¶å¯èƒ½ä¸‰ç§éå†éƒ½éœ€è¦è¿›è¡Œä¸€äº›æ“ä½œï¼Œå› æ­¤ä¼ªä»£ç æ”¹ä¸ºï¼š</p>
   <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">visit</span><span class="params">(node)</span>:</span></span><br><span class="line">    &lt;&lt; preorder actions &gt;&gt;</span><br><span class="line">    left_val = visit(node.left)</span><br><span class="line">    &lt;&lt; inorder actions &gt;&gt;</span><br><span class="line">    right_action = visit(node.right)</span><br><span class="line">    &lt;&lt; postorder actions &gt;&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å…·ä½“æ¥å®ç°çš„æ—¶å€™é¦–å…ˆè¦æœ‰<code>NodeVisitor</code>ç±»ï¼š</p>
   <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NodeVisitor</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">visit</span><span class="params">(self, node)</span>:</span></span><br><span class="line">        method_name = <span class="string">'visit_'</span> + type(node).__name__</span><br><span class="line">        visitor = getattr(self, method_name, self.generic_visit)</span><br><span class="line">        <span class="keyword">return</span> visitor(node)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">generic_visit</span><span class="params">(self, node)</span>:</span></span><br><span class="line">		<span class="keyword">raise</span> Exception(<span class="string">'No visit_&#123;&#125; method'</span>.format(type(node).__name__))</span><br></pre></td></tr></table></figure>

<p>   <code>getattr(object, name, default)</code>å‡½æ•°çš„ä½œç”¨æ˜¯ï¼Œè¿”å›<code>object</code>è¿™ä¸ªå˜é‡çš„<code>name</code>å±æ€§ï¼Œå¦‚æœæ²¡æœ‰<code>name</code>åˆ™è¿”å›<code>default</code>ï¼Œå¦‚æœç”¨è¿™ä¸ªå‡½æ•°çš„æ—¶å€™æ²¡æœ‰æŒ‡æ˜<code>default</code>ï¼Œé‚£ä¹ˆå½“<code>name</code>å±æ€§ä¸å­˜åœ¨æ—¶ä¼šæŠ¥é”™ã€‚</p>
<p>   <code>f.__name__</code>çš„ä½œç”¨æ˜¯è¿”å›<code>f</code>çš„å‡½æ•°åã€‚</p>
<p>   åœ¨è¿™æ®µä»£ç ä¸­ï¼Œé¦–å…ˆ<code>method_name</code>æ˜¯å½“å‰èŠ‚ç‚¹<code>node</code>å¯¹åº”<code>Token</code>çš„<code>type</code>ï¼Œæ¥ä¸‹æ¥è¿”å›è¯¥<code>NodeVisitor</code>å¯¹è±¡çš„<code>method_name</code>å±æ€§ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™æŠ¥é”™ã€‚å…·ä½“æ¥è¯´ï¼Œå½“<code>node</code>ç±»å‹æ˜¯<code>BinOp</code>æ—¶ï¼Œä¼šè¿”å›<code>visit_BinOp(node)</code>ï¼Œè€Œ<code>node</code>ç±»å‹æ˜¯<code>Num</code>æ—¶ï¼Œåˆ™è¿”å›<code>visit_Num(node)</code>ã€‚</p>
</li>
<li><p>æ¥ä¸‹æ¥çœ‹æˆ‘ä»¬çš„è§£é‡Šå™¨<code>Interpreter</code>ç±»ï¼Œå®ƒç»§æ‰¿äº†<code>NodeVisitor</code>ï¼š</p>
   <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Interpreter</span><span class="params">(NodeVisitor)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, parser)</span>:</span></span><br><span class="line">		self.parser = parser</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">visit_BinOp</span><span class="params">(self, node)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> node.op.type == PLUS:</span><br><span class="line">            <span class="keyword">return</span> self.visit(node.left) + self.visit(node.right)</span><br><span class="line">        <span class="keyword">elif</span> node.op.type == MINUS:</span><br><span class="line">            <span class="keyword">return</span> self.visit(node.left) - self.visit(node.right)</span><br><span class="line">        <span class="keyword">elif</span> node.op.type == MUL:</span><br><span class="line">            <span class="keyword">return</span> self.visit(node.left) * self.visit(node.right)</span><br><span class="line">        <span class="keyword">elif</span> node.op.type == DIV:</span><br><span class="line">            <span class="keyword">return</span> self.visit(node.left) / self.visit(node.right)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">visit_Num</span><span class="params">(self, node)</span>:</span></span><br><span class="line">		<span class="keyword">return</span> node.value</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">interpret</span><span class="params">(self)</span>:</span></span><br><span class="line">        tree = self.parser.parse()</span><br><span class="line">        <span class="keyword">return</span> self.visit(tree)</span><br></pre></td></tr></table></figure>

<p>   é¦–å…ˆæ˜¯è§£é‡Šå™¨çš„åˆå§‹åŒ–ï¼Œæˆ‘ä»¬å°†<code>parser</code>å¾—åˆ°çš„ASTä¼ å…¥<code>Interpreter</code>ã€‚</p>
<p>   æ¥ä¸‹æ¥è®¿é—®äºŒå…ƒè¿ç®—ç¬¦èŠ‚ç‚¹çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°é€»è¾‘å¾ˆç®€å•ï¼Œå°±æ˜¯åˆ¤å®šä¼ å…¥çš„<code>node</code>å¯¹åº”çš„<code>op</code>ç±»å‹æ˜¯ä»€ä¹ˆï¼Œç„¶åè®¿é—®å…¶å·¦å³èŠ‚ç‚¹ï¼Œæœ€åè¿›è¡Œè¿ç®—ã€‚</p>
<p>   æœ€åæ˜¯è®¿é—®æ•´æ•°èŠ‚ç‚¹çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°è´Ÿè´£å°†èŠ‚ç‚¹çš„<code>value</code>è¿”å›ã€‚</p>
<p>   è¿™é‡Œè¦æ€»ç»“ä¸€ä¸‹<code>node</code>è¿™ä¸ªå˜é‡ï¼Œå› ä¸º<code>python</code>é‡Œä¸éœ€è¦æŒ‡å®šå˜é‡ç±»å‹ï¼Œä¼šåŠ¨æ€å†³å®šï¼Œå®é™…ä¸Šè¿™é‡Œçš„<code>node</code>æœ‰ä¸¤ä¸ªå¯èƒ½ï¼Œå½“å®ƒæ˜¯å¶èŠ‚ç‚¹çš„æ—¶å€™ï¼Œå®ƒæ˜¯æ•´æ•°ï¼Œä¹Ÿå°±æ˜¯<code>Num(Token)</code>ç±»å‹ï¼Œåœ¨<code>visit</code>å‡½æ•°åä¼šè¿”å›å¹¶æ‰§è¡Œ<code>visit_Num</code>å‡½æ•°ï¼›è€Œå½“å®ƒæ˜¯ä¸­é—´èŠ‚ç‚¹å’Œæ ¹èŠ‚ç‚¹æ—¶ï¼Œå°±å˜æˆæ“ä½œç¬¦ï¼Œä¹Ÿå°±æ˜¯<code>BinOp(left, op, right)</code>ç±»å‹ï¼Œåœ¨<code>visit</code>å‡½æ•°åä¼šè¿”å›å¹¶æ‰§è¡Œ<code>visit_BinOp</code>å‡½æ•°ã€‚</p>
</li>
<li><p>å½“è°ƒç”¨è§£é‡Šå™¨çš„<code>interpret</code>å‡½æ•°æ—¶ï¼Œé¦–å…ˆè¿›å…¥<code>visit</code>å‡½æ•°ï¼Œåˆ¤å®šæ˜¯æ“ä½œç¬¦ï¼Œè½¬å…¥<code>visit_BinOp</code>å‡½æ•°ï¼Œå†åˆ¤æ–­è¿ç®—ç±»å‹ï¼Œå¹¶è®¿é—®å·¦å³èŠ‚ç‚¹ç›´åˆ°å¾—åˆ°ä¸€ä¸ªè¿”å›å€¼ï¼Œæœ€åè¿›è¡Œè¿ç®—å¾—åˆ°ç»“æœã€‚</p>
</li>
<li><p>æ€»ç»“ä¸€ä¸‹ï¼Œæ•´ä¸ªæµç¨‹æ˜¯ï¼šparser ä» lexer ä¸­ å¾—åˆ° token ç„¶åè¿”å›ç”Ÿæˆçš„ AST ç»™ interpreter è¿›è¡Œéå†å¹¶è§£é‡Šæ‰§è¡Œæ‰€ç»™è¾“å…¥ã€‚</p>
</li>
</ol>
<h4 id="é€’å½’ä¸‹é™"><a href="#é€’å½’ä¸‹é™" class="headerlink" title="é€’å½’ä¸‹é™"></a>é€’å½’ä¸‹é™</h4><p>ä¸€ä¸ª <strong>é€’å½’ä¸‹é™parser</strong> å°± æ˜¯ä¸€ä¸ªè‡ªé¡¶å‘ä¸‹çš„ parserï¼Œå®ƒä½¿ç”¨ä¸€ç»„é€’å½’è¿‡ç¨‹æ¥å¤„ç†è¾“å…¥ã€‚è‡ªé¡¶å‘ä¸‹åæ˜ äº† parser ä» æ„å»ºè§£ææ ‘çš„é¡¶éƒ¨ç»“ç‚¹å¼€å§‹é€æ¸æ„å»ºæ›´ä½çš„ç»“ç‚¹è¿™ä¸€äº‹å®ã€‚</p>
<h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><ol>
<li><p>å†™ä¸€ä¸ªç¿»è¯‘å™¨ï¼ˆæç¤ºï¼šnode visitorï¼‰ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªç®—æœ¯è¡¨è¾¾å¼ä½œä¸ºè¾“å…¥å¹¶æ‰“å°å‡ºå®ƒçš„åç¼€å½¢å¼ï¼Œå³é€†æ³¢å…°å¼(Reverse Polish Notation, RPN)ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç¿»è¯‘å™¨æ¥æ”¶çš„è¾“å…¥æ˜¯ è¡¨è¾¾å¼ <code>(5 + 3) * 12 / 3</code> åˆ™è¾“å…¥åº”è¯¥æ˜¯ <code>5 3 + 12 * 3 /</code> ã€‚ç­”æ¡ˆåœ¨<a href="https://github.com/rspivak/lsbasi/blob/master/part7/python/ex1.py" target="_blank" rel="noopener">è¿™å„¿</a>ï¼Œä¸è¿‡è¦å…ˆè‡ªå·±è§£å†³å†çœ‹å•Šã€‚</p>
<p>æˆ‘çš„æƒ³æ³•æ˜¯ï¼šé€†æ³¢å…°å¼è¾“å‡ºé¡ºåºå®é™…ä¸Šå°±æ˜¯è¿™ä¸€è¯¾éå†çš„é¡ºåºï¼Œå› æ­¤åªéœ€è¦åœ¨ç°æœ‰çš„<code>visit_BinOp</code>å’Œ<code>visit_Num</code>åŠ ä¸Š<code>print</code>å°±è¡Œï¼Œæ³¨æ„è¿™é‡Œå› ä¸ºæ˜¯ååºè¾“å‡ºï¼Œ<code>BinOP</code>éœ€è¦å…ˆ<code>visit(left)</code>å’Œ<code>visit(right)</code>ï¼Œå†<code>print(op.value)</code>ï¼Œä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">visit_BinOp</span><span class="params">(self, node)</span>:</span></span><br><span class="line">	<span class="keyword">if</span> node.op.type == PLUS:</span><br><span class="line">        tmp = self.visit(node.left) + self.visit(node.right)</span><br><span class="line">    <span class="keyword">elif</span> node.op.type == MINUS:</span><br><span class="line">        tmp = self.visit(node.left) - self.visit(node.right)</span><br><span class="line">    <span class="keyword">elif</span> node.op.type == MUL:</span><br><span class="line">        tmp = self.visit(node.left) * self.visit(node.right)</span><br><span class="line">    <span class="keyword">elif</span> node.op.type == DIV:</span><br><span class="line">        tmp = self.visit(node.left) // self.visit(node.right)</span><br><span class="line">    print(node.op.value, end=<span class="string">' '</span>)</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">visit_Num</span><span class="params">(self, node)</span>:</span></span><br><span class="line">    print(node.value, end=<span class="string">' '</span>)</span><br><span class="line">    <span class="keyword">return</span> node.value</span><br></pre></td></tr></table></figure>
</li>
<li><p>å†™ä¸€ä¸ªç¿»è¯‘å™¨ï¼ˆnode visitorï¼‰ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªç®—æœ¯è¡¨è¾¾å¼ä½œä¸ºè¾“å…¥å¹¶å°†å®ƒæ‰“å°ä¸º LISP é£ æ ¼çš„è®°æ³•ï¼Œå³ <code>2 + 3</code> å˜æˆ <code>(+ 2 3)</code> åŠ <code>(2 + 3 * 5)</code> å˜æˆ <code>(+ 2 (* 3 5))</code> ã€‚ä½  å¯ä»¥åœ¨<a href="https://github.com/rspivak/lsbasi/blob/master/part7/python/ex2.py" target="_blank" rel="noopener">è¿™å„¿</a>æ‰“åˆ°ç­”æ¡ˆï¼Œä½†åœ¨æŸ¥çœ‹ä¹‹å‰è¿˜æ˜¯è¦å…ˆå°è¯•è‡ªå·±è§£å†³ã€‚</p>
<p>è¿™æ˜¯è¦å‰åºéå†è¾“å‡ºï¼Œä¹Ÿå°±æ˜¯å…ˆè¾“å‡º<code>op.value</code>ï¼Œå†è¿›è¡Œ<code>visit(left)</code>å’Œ<code>visit(right)</code>ï¼Œå’Œç»ƒä¹ 1ç›¸æ¯”ï¼Œå°±æ˜¯æŠŠ<code>visit_BinOp</code>ä¸­çš„<code>print(node.op.value, end=&#39; &#39;)</code>æ”¾åˆ°æœ€å‰é¢ã€‚</p>
</li>
</ol>
<p>ï¼ˆè¿™ä¿©ç»ƒä¹ çš„ç­”æ¡ˆå’Œæˆ‘æƒ³çš„è¿˜æœ‰ç‚¹ä¸å¤ªä¸€æ ·â€¦â€¦ä¸è¿‡é—®é¢˜ä¸å¤§â€¦â€¦ï¼‰</p>
]]></content>
      <categories>
        <category>Let&#39;s Build A Simple Interpreter</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>ç¼–è¯‘åŸç†</tag>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>Let-s-Build-A-Simple-Interpreterç¬”è®°-6</title>
    <url>/2020/03/12/Let-s-Build-A-Simple-Interpreter%E7%AC%94%E8%AE%B0-6/</url>
    <content><![CDATA[<h2 id="è¯¾ç¨‹æ–‡æ¡£"><a href="#è¯¾ç¨‹æ–‡æ¡£" class="headerlink" title="è¯¾ç¨‹æ–‡æ¡£"></a>è¯¾ç¨‹æ–‡æ¡£</h2><p><a href="https://ruslanspivak.com/lsbasi-part6/" target="_blank" rel="noopener">åŸæ–‡</a></p>
<p><a href="https://feng-qi.github.io/2018/02/01/lets-build-a-simple-interpreter-part-06/" target="_blank" rel="noopener">ç¿»è¯‘</a></p>
<a id="more"></a>

<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Token types</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># EOF (end-of-file) token is used to indicate that</span></span><br><span class="line"><span class="comment"># there is no more input left for lexical analysis</span></span><br><span class="line">INTEGER, PLUS, MINUS, MUL, DIV, LPAREN, RPAREN, EOF = (</span><br><span class="line">    <span class="string">'INTEGER'</span>, <span class="string">'PLUS'</span>, <span class="string">'MINUS'</span>, <span class="string">'MUL'</span>, <span class="string">'DIV'</span>, <span class="string">'LPAREN'</span>, <span class="string">'RPAREN'</span>, <span class="string">'EOF'</span></span><br><span class="line">)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Token</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, type, value)</span>:</span></span><br><span class="line">        self.type = type</span><br><span class="line">        self.value = value</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""String representation of the class instance.</span></span><br><span class="line"><span class="string">        Examples:</span></span><br><span class="line"><span class="string">            Token(INTEGER, 3)</span></span><br><span class="line"><span class="string">            Token(PLUS, '+')</span></span><br><span class="line"><span class="string">            Token(MUL, '*')</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">f'Token(<span class="subst">&#123;self.type&#125;</span>, <span class="subst">&#123;repr(self.value)&#125;</span>)'</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.__str__()</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Lexer</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, text)</span>:</span></span><br><span class="line">        <span class="comment"># client string input, e.g. "4 + 2 * 3 - 6 / 2"</span></span><br><span class="line">        self.text = text</span><br><span class="line">        <span class="comment"># self.pos is an index into self.text</span></span><br><span class="line">        self.pos = <span class="number">0</span></span><br><span class="line">        self.current_char = self.text[self.pos]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">error</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">'Lexer error'</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">advance</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Advance the `pos` pointer and set the `current_char` variable."""</span></span><br><span class="line">        self.pos += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> self.pos &gt;= len(self.text):</span><br><span class="line">            self.current_char = <span class="literal">None</span>  <span class="comment"># Indicates end of input</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.current_char = self.text[self.pos]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">skip_whitespace</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">while</span> self.current_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> self.current_char.isspace():</span><br><span class="line">            self.advance()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">integer</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Return a (multidigit) integer consumed from the input."""</span></span><br><span class="line">        value = <span class="string">''</span></span><br><span class="line">        <span class="keyword">while</span> self.current_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> self.current_char.isdigit():</span><br><span class="line">            value += self.current_char</span><br><span class="line">            self.advance()</span><br><span class="line">        <span class="keyword">return</span> int(value)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_next_token</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Lexical analyzer (also known as scanner or tokenizer)</span></span><br><span class="line"><span class="string">        This method is responsible for breaking a sentence</span></span><br><span class="line"><span class="string">        apart into tokens. One token at a time.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">while</span> self.current_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">if</span> self.current_char.isspace():</span><br><span class="line">                self.skip_whitespace()</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">elif</span> self.current_char.isdigit():</span><br><span class="line">                <span class="keyword">return</span> Token(INTEGER, self.integer())</span><br><span class="line">            <span class="keyword">elif</span> self.current_char == <span class="string">'+'</span>:</span><br><span class="line">                self.advance()</span><br><span class="line">                <span class="keyword">return</span> Token(PLUS, <span class="string">'+'</span>)</span><br><span class="line">            <span class="keyword">elif</span> self.current_char == <span class="string">'-'</span>:</span><br><span class="line">                self.advance()</span><br><span class="line">                <span class="keyword">return</span> Token(MINUS, <span class="string">'-'</span>)</span><br><span class="line">            <span class="keyword">elif</span> self.current_char == <span class="string">'*'</span>:</span><br><span class="line">                self.advance()</span><br><span class="line">                <span class="keyword">return</span> Token(MUL, <span class="string">'*'</span>)</span><br><span class="line">            <span class="keyword">elif</span> self.current_char == <span class="string">'/'</span>:</span><br><span class="line">                self.advance()</span><br><span class="line">                <span class="keyword">return</span> Token(DIV, <span class="string">'/'</span>)</span><br><span class="line">            <span class="keyword">elif</span> self.current_char == <span class="string">'('</span>:</span><br><span class="line">                self.advance()</span><br><span class="line">                <span class="keyword">return</span> Token(LPAREN, <span class="string">'('</span>)</span><br><span class="line">            <span class="keyword">elif</span> self.current_char == <span class="string">')'</span>:</span><br><span class="line">                self.advance()</span><br><span class="line">                <span class="keyword">return</span> Token(RPAREN, <span class="string">')'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.error()</span><br><span class="line">        <span class="keyword">return</span> Token(EOF, <span class="literal">None</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Interpreter</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, lexer)</span>:</span></span><br><span class="line">        self.lexer = lexer</span><br><span class="line">        <span class="comment"># set current token to the first token taken from the input</span></span><br><span class="line">        self.current_token = self.lexer.get_next_token()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">error</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">'Interpreter error'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">eat</span><span class="params">(self, token_type)</span>:</span></span><br><span class="line">        <span class="comment"># compare the current token type with the passed token</span></span><br><span class="line">        <span class="comment"># type and if they match then "eat" the current token</span></span><br><span class="line">        <span class="comment"># and assign the next token to the self.current_token,</span></span><br><span class="line">        <span class="comment"># otherwise raise an exception.</span></span><br><span class="line">        <span class="keyword">if</span> self.current_token.type == token_type:</span><br><span class="line">            self.current_token = self.lexer.get_next_token()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.error()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">factor</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""factor : INTEGER | LPAREN expr RPAREN"""</span></span><br><span class="line">        token = self.current_token</span><br><span class="line">        <span class="keyword">if</span> token.type == INTEGER:</span><br><span class="line">            self.eat(INTEGER)</span><br><span class="line">            <span class="keyword">return</span> token.value</span><br><span class="line">        <span class="keyword">elif</span> self.current_token.type == LPAREN:</span><br><span class="line">            self.eat(LPAREN)</span><br><span class="line">            value = self.expr()</span><br><span class="line">            self.eat(RPAREN)</span><br><span class="line">            <span class="keyword">return</span> value</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">term</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""term : factor ((MUL | DIV) factor)*"""</span></span><br><span class="line">        value = self.factor()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> self.current_token.type <span class="keyword">in</span> (MUL, DIV):</span><br><span class="line">            token_type = self.current_token.type</span><br><span class="line">            <span class="keyword">if</span> token_type == MUL:</span><br><span class="line">                self.eat(MUL)</span><br><span class="line">                value *= self.factor()</span><br><span class="line">            <span class="keyword">elif</span> token_type == DIV:</span><br><span class="line">                self.eat(DIV)</span><br><span class="line">                value /= self.factor()</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">expr</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Arithmetic expression parser / interpreter.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        calc&gt; 7 + 3 * (10 / (12 / (3 + 1) - 1))</span></span><br><span class="line"><span class="string">        22</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        expr   : term ((PLUS | MINUS) term)*</span></span><br><span class="line"><span class="string">        term   : factor ((MUL | DIV) factor)*</span></span><br><span class="line"><span class="string">        factor : INTEGER | LPAREN expr RPAREN</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        value = self.term()</span><br><span class="line">        <span class="keyword">while</span> self.current_token.type <span class="keyword">in</span> (PLUS, MINUS):</span><br><span class="line">            token_type = self.current_token.type</span><br><span class="line">            <span class="keyword">if</span> token_type == PLUS:</span><br><span class="line">                self.eat(PLUS)</span><br><span class="line">                value += self.term()</span><br><span class="line">            <span class="keyword">elif</span> token_type == MINUS:</span><br><span class="line">                self.eat(MINUS)</span><br><span class="line">                value -= self.term()</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.expr()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            text = input(<span class="string">'calc&gt; '</span>)</span><br><span class="line">        <span class="keyword">except</span> EOFError:</span><br><span class="line">            print()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> len(text.strip()):</span><br><span class="line">            interpreter = Interpreter(Lexer(text))</span><br><span class="line">            print(interpreter.parse())</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="ç¬”è®°"><a href="#ç¬”è®°" class="headerlink" title="ç¬”è®°"></a>ç¬”è®°</h2><p>è¿™ä¸€è¯¾åœ¨åŠ å‡ä¹˜é™¤çš„åŸºç¡€ä¸ŠåŠ å…¥äº†æ‹¬å·ï¼Œè€Œæ‹¬å·é‡Œçš„å†…å®¹åˆå¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªæ–°çš„åŠ å‡ä¹˜é™¤è¡¨è¾¾å¼ï¼Œå³å¦‚ä¸‹è¯­æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">expr   : term   ((PLUS | MINUS) term)*</span><br><span class="line">term   : factor ((MUL | DIV) factor)*</span><br><span class="line">factor : INTEGER | LPAREN expr RPAREN</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡ºï¼Œ<code>expr</code>å’Œ<code>term</code>æ²¡æœ‰ä»»ä½•å˜åŒ–ï¼Œè€Œ<code>factor</code>åˆ™å¤šäº†ä¸€ç§å¯èƒ½ï¼š<code>(expr)</code>ï¼Œå› æ­¤éœ€è¦ä½œå‡ºä»¥ä¸‹ä¿®æ”¹ï¼š</p>
<ol>
<li><code>Lexer</code>éƒ¨åˆ†æ·»åŠ å·¦å³æ‹¬å·çš„è¿”å›ï¼›</li>
<li><code>Interpreter</code>ç°åœ¨åˆ†æˆäº†ä¸¤ä¸ªåˆ†æ”¯ï¼Œå­—ç¬¦ç±»å‹æ˜¯<code>INTEGER</code>æ—¶ï¼Œå’Œä¹‹å‰çš„ä¸€æ ·ï¼Œè¿”å›è¯¥å­—ç¬¦çš„<code>value</code>ï¼›å­—ç¬¦ç±»å‹æ˜¯å·¦æ‹¬å·æ—¶ï¼Œåˆ™è¿”å›è¯¥æ‹¬å·é‡Œçš„<code>expr</code>çš„å€¼ï¼Œå¹¶æŠŠå³æ‹¬å·ä¹Ÿè¯»è¿‡å»ã€‚</li>
</ol>
<p>è¿™æ ·çš„é€’å½’è¯­æ³•ï¼Œç§°ä¹‹ä¸ºé€’å½’ä¸‹é™è§£é‡Šå™¨ã€‚</p>
<h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><ol>
<li><p>å¦‚æœ¬æ–‡çš„æè¿°ï¼Œå†™ä¸€ä¸ªä½ è‡ªå·±ç‰ˆæœ¬çš„ç®—æœ¯è¡¨è¾¾å¼è§£é‡Šå™¨ã€‚è®°ä½ï¼šé‡å¤æ˜¯å­¦ä¹ ä¹‹æ¯ã€‚</p>
<p>è¯•ç€å›é¡¾ä¸€ä¸‹æ•´ä¸ªä»£ç çš„æ€è·¯ï¼š</p>
<ol>
<li><p>ä»£ç é™¤äº†<code>main()</code>ä»¥å¤–ï¼Œæœ‰3ä¸ª<code>class</code>ï¼Œåˆ†åˆ«æ˜¯<code>Token</code>ã€<code>Lexer</code>ã€<code>Interpreter</code>ã€‚</p>
</li>
<li><p><code>Token</code>æ˜¯æœ€åŸºç¡€çš„è¯æ³•å•å…ƒï¼Œæœ‰ä¸¤ä¸ªæˆå‘˜å˜é‡ï¼š<code>type</code>å’Œ<code>value</code>ï¼Œæ­¤å¤–æœ‰åˆå§‹åŒ–å’Œè¾“å‡ºçš„å‡½æ•°ã€‚</p>
</li>
<li><p><code>Lexer</code>æ˜¯è¯æ³•åˆ†æå™¨ï¼Œæˆå‘˜å˜é‡ä¸ºï¼š<code>text</code>ï¼ˆå®Œæ•´çš„è¯­å¥ï¼‰ã€<code>pos</code>ï¼ˆå½“å‰è¯»å–åˆ°è¯­å¥ä½ç½®çš„ç´¢å¼•ï¼‰ã€<code>current_char</code>ï¼ˆå½“å‰è¯»å–å‡ºçš„å­—ç¬¦ï¼‰ï¼Œæˆå‘˜å‡½æ•°ä¸ºï¼š<code>error</code>ï¼ˆæŠ¥è¯æ³•é”™è¯¯ï¼‰ã€<code>advance</code>ï¼ˆå¾€åè¯»å–ä¸€ä¸ªæ–°å­—ç¬¦ï¼‰ã€<code>skip_whitespace</code>ï¼ˆè·³è¿‡ç©ºæ ¼ï¼‰ã€<code>integer</code>ï¼ˆæŠŠè¿ç»­çš„æ•°å­—å­—ç¬¦è½¬æˆæ•´æ•°è¿”å›ï¼‰ã€<code>get_next_token()</code>ï¼ˆè¿”å›å½“å‰è¯æ³•å•å…ƒï¼‰ã€‚</p>
</li>
<li><p><code>Interpreter</code>æ˜¯è¯­æ³•è§£é‡Šå™¨ï¼Œæˆå‘˜å˜é‡ä¸ºï¼š<code>lexer</code>ï¼ˆè¯æ³•åˆ†æå™¨ï¼‰ã€<code>current_token</code>ï¼ˆå½“å‰å¤„ç†çš„è¯æ³•å•å…ƒï¼‰ï¼Œæˆå‘˜å‡½æ•°ä¸ºï¼š<code>error</code>ï¼ˆæŠ¥è¯­æ³•é”™è¯¯ï¼‰ã€<code>eat()</code>ï¼ˆå¾€åå¤„ç†ä¸‹ä¸€ä¸ªè¯æ³•å•å…ƒï¼‰ã€<code>factor</code>ã€<code>term</code>ã€<code>expr</code>ä¸‰ä¸ªéƒ½æ˜¯è¯­æ³•å›¾é‡Œçš„å†…å®¹ï¼Œæœ€ååŠ äº†ä¸€ä¸ª<code>parse</code>è¿”å›<code>expr()</code>ã€‚</p>
</li>
</ol>
<p>å¤§è‡´å°±æ˜¯è¿™æ ·äº†ã€‚</p>
</li>
</ol>
<h2 id="æ£€æŸ¥ç†è§£"><a href="#æ£€æŸ¥ç†è§£" class="headerlink" title="æ£€æŸ¥ç†è§£"></a>æ£€æŸ¥ç†è§£</h2><p>è¿™ä¸€è¯¾æ²¡æœ‰è¿™ä¸€éƒ¨åˆ†ã€‚</p>
]]></content>
      <categories>
        <category>Let&#39;s Build A Simple Interpreter</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>ç¼–è¯‘åŸç†</tag>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonè¯¾ç¨‹è®°å½•-3</title>
    <url>/2020/03/11/python%E8%AF%BE%E7%A8%8B%E8%AE%B0%E5%BD%95-3/</url>
    <content><![CDATA[<h3 id="çŸ¥è¯†ç‚¹è®°å½•"><a href="#çŸ¥è¯†ç‚¹è®°å½•" class="headerlink" title="çŸ¥è¯†ç‚¹è®°å½•"></a>çŸ¥è¯†ç‚¹è®°å½•</h3><p>è¿™æ¬¡ä¸Šè¯¾æœ‰ä¸€äº›æ˜¯ä»¥å‰ä¸å¤ªäº†è§£çš„çŸ¥è¯†ç‚¹ã€‚</p>
<a id="more"></a>

<h5 id="åºåˆ—"><a href="#åºåˆ—" class="headerlink" title="åºåˆ—"></a>åºåˆ—</h5><p>åŒ…æ‹¬å­—ç¬¦ä¸²ã€åˆ—è¡¨ã€å…ƒç»„ã€å­—èŠ‚åºåˆ—ã€‚</p>
<ol>
<li><p>ç´¢å¼•è®¿é—®ï¼š</p>
<p>æœ‰<code>n</code>ä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œç´¢å¼•èŒƒå›´æ˜¯<code>[0, n-1]</code>æˆ–<code>[-n, -1]</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤äº†å¸¸è§„çš„ç±»ä¼¼å…¶ä»–è¯­è¨€ä¸­æ•°ç»„çš„ä¸‹æ ‡ç´¢å¼•æ–¹å¼ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡<code>-1</code>æ¥é€†åºè®¿é—®ã€‚è¿™åœ¨æŸäº›æ—¶å€™æ˜¯å¾ˆæ–¹ä¾¿çš„ä¸€ä¸ªæ“ä½œï¼Œæ¯”å¦‚åˆ¤æ–­å›æ–‡å­—ç¬¦ä¸²ã€‚</p>
</li>
<li><p>éå†è®¿é—®ï¼š</p>
<p>éå†ä¹Ÿæ˜¯ç”¨<code>for</code>å¾ªç¯ï¼Œä¸è¿‡å’Œå…¶ä»–è¯­è¨€ä¸åŒçš„æ˜¯ï¼Œè¿™é‡Œ<code>for</code>å¾ªç¯ä¸­çš„<code>i</code>ç±»å‹å¾ˆéšæ„ï¼Œå¯ä»¥æ˜¯<code>1, 2, 3, ...</code>ä¹Ÿå¯ä»¥æ˜¯å…ƒç»„ã€å­—ç¬¦ç­‰ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> <span class="string">'hello'</span>:</span><br><span class="line">	print(c)</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„<code>c</code>æ˜¯å­—ç¬¦ï¼Œæœ€ç»ˆä¼šæŠŠ<code>h</code>, <code>e</code>, <code>l</code>, <code>l</code>, <code>o</code> é€è¡Œè¾“å‡ºã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> [(<span class="number">1</span>,<span class="number">2</span>),(<span class="number">3</span>,<span class="number">4</span>),(<span class="number">5</span>,<span class="number">6</span>)]</span><br><span class="line">	print(t,t[<span class="number">0</span>],t[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„<code>t</code>æ˜¯å…ƒç»„ï¼Œæœ€ç»ˆè¾“å‡ºæ˜¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">(<span class="number">1</span>,<span class="number">2</span>) <span class="number">1</span> <span class="number">2</span></span><br><span class="line">(<span class="number">3</span>,<span class="number">4</span>) <span class="number">3</span> <span class="number">4</span></span><br><span class="line">(<span class="number">5</span>,<span class="number">6</span>) <span class="number">5</span> <span class="number">6</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ‡ç‰‡</p>
<p>åºåˆ—<code>s</code>å¯ä»¥é€šè¿‡<code>s[i:j:k]</code>æ¥æˆªå–å…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œ<code>i</code>æ˜¯èµ·ç‚¹ï¼Œ<code>j</code>æ˜¯ç»ˆç‚¹ï¼Œ<code>k</code>æ˜¯æ­¥é•¿ï¼Œæ³¨æ„è¿™é‡Œçš„èµ·ç‚¹ç»ˆç‚¹éƒ½å¯ä»¥æ˜¯è´Ÿæ•°ï¼Œç»“åˆä¸Šæ–‡å¯çŸ¥ï¼Œ<code>s[::-1]</code>å®é™…ä¸Šå°±æ˜¯åºåˆ—çš„é€†åºã€‚æ³¨æ„è¿™ä¸ªåˆ‡ç‰‡å¹¶ä¸ä¼šæ”¹å˜åºåˆ—<code>s</code>ã€‚æƒ³è¦å°†åˆ‡ç‰‡çš„ä¸‹æ ‡ä¿¡æ¯ä¿å­˜ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>slice(i:j:k)</code>å‡½æ•°ã€‚è¿™é‡Œå¦‚æœè¶Šç•Œäº†ä¹Ÿä¸ä¼šæŠ¥é”™ã€‚</p>
</li>
<li><p>è¿æ¥å’Œé‡å¤</p>
<p>è¿æ¥<code>+</code>ï¼š<code>s1+s2</code></p>
<p>é‡å¤<code>*</code>ï¼š<code>s*n</code> æˆ–è€… <code>n*s</code></p>
<p>å¢é‡èµ‹å€¼ï¼š<code>+=</code>å’Œ<code>*=</code></p>
<p>å…ƒç»„ä¸å¯ä»¥<code>+=</code>åºåˆ—ï¼Œä½†æ˜¯åè¿‡æ¥åºåˆ—<code>+=</code>å…ƒç»„æ˜¯æ²¡é—®é¢˜çš„ã€‚</p>
</li>
<li><p>æˆå‘˜å…³ç³»æ“ä½œ</p>
<p><code>in</code>å’Œ<code>not in</code>å¯ä»¥åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨åºåˆ—ä¸­ã€‚</p>
<p><code>s.count(value)</code>å¯ä»¥ç»Ÿè®¡<code>value</code>åœ¨åºåˆ—<code>s</code>ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚</p>
<p><code>s.index(value, [start, [stop]])</code>æŸ¥æ‰¾valueåœ¨åºåˆ—æŒ‡å®šèŒƒå›´ <code>[start,stop)</code>ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä¸‹æ ‡ã€‚</p>
</li>
<li><p>åºåˆ—å†…ç½®å‡½æ•°</p>
<p><code>len</code> å•çº¯æ±‚åºåˆ—é•¿åº¦</p>
<p><code>sorted</code>å¯¹åºåˆ—æ’åºå¹¶è¿”å›æ’åºåçš„åˆ—è¡¨ï¼Œä¸æ”¹å˜åŸå§‹åºåˆ—</p>
<p><code>reversed</code>é€†åºï¼Œä¸æ”¹åŠ¨åŸåºåˆ—ï¼Œè¿”å›åå‘è¿­ä»£å™¨</p>
<p><code>max</code>å’Œ<code>min</code>æ±‚æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Œè¦æ±‚å…ƒç´ ç±»å‹éƒ½ä¸€æ ·</p>
<p><code>sum</code>åºåˆ—æ±‚å’Œï¼Œè¦æ±‚ä¸èƒ½æœ‰éæ•°å­—</p>
<p><code>enumerate</code>è¿”å›å…ƒç´ ä¸º<code>å…ƒç»„(è®¡æ•°ï¼Œå…ƒç´ )</code> çš„è¿­ä»£å™¨</p>
<p><code>zip</code>æ‹¼æ¥å¤šä¸ªå¯¹è±¡<code>iter1ã€iter2â€¦</code>çš„å…ƒç´ ï¼Œ è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œå…¶å…ƒç´ ä¸ºå„å¯¹è±¡å…ƒç´ ç»„æˆçš„å…ƒç»„ã€‚</p>
<p><code>all</code>å’Œ<code>any</code>åˆ¤æ–­åºåˆ—çš„å…ƒç´ æ˜¯å¦å…¨éƒ¨å’Œéƒ¨åˆ†ä¸ºTrue</p>
</li>
<li><p>åºåˆ—ç±»å‹è½¬æ¢</p>
<p><code>str</code> <code>list</code> <code>tuple</code> <code>bytes</code> <code>bytearray</code>å¯ä»¥ä»å­—é¢æ„ä¹‰çœ‹å‡ºæ˜¯è½¬æˆä»€ä¹ˆç±»å‹ã€‚</p>
</li>
<li><p>çš„</p>
</li>
<li><p>åºåˆ—æ‹†åˆ†</p>
<p><code>å˜é‡1,å˜é‡2,â€¦,å˜é‡n = åºåˆ—</code>è¿™æ ·çš„èµ‹å€¼è¯­å¥ï¼Œå¯ä»¥æŠŠåºåˆ—ä¸­çš„å…ƒç´ æ‹†å¼€èµ‹å€¼ç»™å‰é¢çš„å˜é‡ï¼Œä¸è¿‡ç±»å‹è¦ç»Ÿä¸€ï¼Œæ¯”å¦‚åºåˆ—ä¸­æœ‰å…ƒç»„ï¼Œé‚£å‰é¢å¯¹åº”ä½ç½®çš„å˜é‡ä¹Ÿè¦å†™æˆå…ƒç»„çš„å½¢å¼ã€‚</p>
<p><code>*å˜é‡</code>çš„å½¢å¼ï¼Œå¯ä»¥æŠŠå¤šä¸ªå…ƒç´ æ‰“åŒ…èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œä½†æ˜¯åªèƒ½å‡ºç°ä¸€æ¬¡ã€‚</p>
<p>å¯ä»¥ç”¨ä¸´æ—¶å˜é‡<code>_</code>æ¥å ä½ä»è€Œå°†æŒ‡å®šä½ç½®çš„å…ƒç´ èµ‹å€¼ç»™æŸä¸ªå˜é‡ï¼Œä¾‹å¦‚<code>_, b, _ = (1, 2, 3)</code>å°±æ˜¯æŠŠ<code>2</code>èµ‹å€¼ç»™<code>b</code>ã€‚</p>
</li>
</ol>
<h5 id="åˆ—è¡¨"><a href="#åˆ—è¡¨" class="headerlink" title="åˆ—è¡¨"></a>åˆ—è¡¨</h5><ol>
<li><p><code>del</code>åˆ é™¤å…ƒç´ ï¼Œèµ‹å€¼ä¿®æ”¹å…ƒç´ </p>
</li>
<li><p><code>s.append(x)</code> æŠŠ<code>x</code>è¿½åŠ åˆ°<code>s</code>æœ«å°¾</p>
</li>
<li><p><code>s.clear()</code> åˆ é™¤æ‰€æœ‰å…ƒç´ </p>
</li>
<li><p><code>s.copy()</code> å¤åˆ¶</p>
</li>
<li><p><code>s.extend(t)</code> å’Œä¸Šé¢çš„<code>s.append(x)</code>æ˜¯ä¸€æ ·çš„ï¼ŒåŒºåˆ«åœ¨äºï¼Œ<code>append</code>æŠŠ<code>x</code>ä½œä¸ºä¸€ä¸ªæ•´ä½“åŠ åˆ°æœ«å°¾ï¼Œè€Œ<code>extend</code>æŠŠ<code>x</code>ä½œä¸ºä¸€ä¸ªæ–°çš„åˆ—è¡¨åˆå¹¶åˆ°<code>s</code>çš„æœ«å°¾ã€‚</p>
</li>
<li><p><code>s.insert(i,x)</code>æ’å…¥</p>
</li>
<li><p><code>s.pop([i])</code>è¿”å›å¹¶ç§»é™¤ä¸‹æ ‡ä¸º<code>i</code>çš„å…ƒç´ ï¼Œ<code>i</code>çœç•¥æ—¶é»˜è®¤ä¸ºæœ€åä¸€ä¸ªå…ƒç´ </p>
</li>
<li><p><code>s.remove(x)</code>ç§»é™¤åˆ—è¡¨ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„<code>x</code></p>
</li>
<li><p><code>s.reverse()</code>åˆ—è¡¨åè½¬</p>
</li>
<li><p><code>s.sort()</code>åˆ—è¡¨æ’åº</p>
</li>
<li><p>åˆ—è¡¨è§£æè¡¨è¾¾å¼ï¼šå¤„ç†å¯è¿­ä»£å¯¹è±¡å¹¶ç”Ÿæˆç»“æœåˆ—è¡¨ï¼Œå…·ä½“æ ¼å¼ä¸º<code>[express for i_1 in å¯è¿­ä»£å¯¹è±¡1â€¦for i_N in å¯è¿­ä»£å¯¹è±¡N [if condition] ]</code></p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>)]</span><br><span class="line">[i**<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>) <span class="keyword">if</span> i%<span class="number">2</span>==<span class="number">0</span>]</span><br><span class="line">[(x+y,x*y) <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">2</span>) <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">2</span>,<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ—è¡¨è§£æç”Ÿæˆå­—å…¸å’Œé›†åˆ</span></span><br><span class="line">a = [(<span class="string">'å°é»‘'</span>,<span class="string">'é¢†å¯¼'</span>,<span class="number">30000</span>),(<span class="string">'å°ç™½'</span>,<span class="string">'èŒå‘˜'</span>,<span class="number">10000</span>),(<span class="string">'å°è“'</span>,<span class="string">'èŒå‘˜'</span>,<span class="number">5000</span>)]</span><br><span class="line">&#123;i[<span class="number">0</span>]:i[<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> a&#125;</span><br><span class="line"><span class="comment"># output: &#123;'å°é»‘': 30000, 'å°ç™½': 10000, 'å°è“': 5000&#125;</span></span><br><span class="line">&#123;i[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> a <span class="keyword">if</span> i[<span class="number">2</span>]&gt;=<span class="number">10000</span>&#125;</span><br><span class="line"><span class="comment"># output: &#123;'å°ç™½', 'å°é»‘'&#125;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="è¯¾å ‚ç»ƒä¹ "><a href="#è¯¾å ‚ç»ƒä¹ " class="headerlink" title="è¯¾å ‚ç»ƒä¹ "></a>è¯¾å ‚ç»ƒä¹ </h3><ol>
<li><p>å·²çŸ¥ä¸€é€‰æ‰‹çš„å„è¯„å§”å¾—åˆ†<code>score = [95, 85, 89, 88, 86, 95, 89, 98, 85, 75, 80]</code>ï¼Œè¿ç”¨åºåˆ—çš„å„é¡¹æ“ä½œæ±‚è¯¥é€‰æ‰‹çš„å¾—åˆ†ï¼Œè®¡ç®—è§„åˆ™ï¼šå»æ‰ä¸€ä¸ªæœ€é«˜åˆ†å’Œä¸€ä¸ªæœ€ä½åˆ†ï¼Œå‰©ä¸‹çš„åˆ†æ•°è®¡ç®—å¹³å‡åˆ†ã€‚</p>
<p>æœ€ç›´æ¥çš„æ€è·¯å°±æ˜¯æ•´ä½“æ±‚å’Œç„¶åå‡å»æœ€å¤§çš„å’Œæœ€å°çš„å†ç®—å¹³å‡å€¼ï¼Œä¹Ÿå°±æ˜¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">score = [<span class="number">95</span>, <span class="number">85</span>, <span class="number">89</span>, <span class="number">88</span>, <span class="number">86</span>, <span class="number">95</span>, <span class="number">89</span>, <span class="number">98</span>, <span class="number">85</span>, <span class="number">75</span>, <span class="number">80</span>]</span><br><span class="line">s = (sum(score) - max(score) - min(score)) / (len(score) - <span class="number">2</span>)</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ˜¯å›æ–‡ä¸²ï¼š<code>a = &#39;abcdcba&#39;  b = &#39;abcdefg&#39;</code></p>
<p>è¿™ä¸ªé¢˜æœ‰å¾ˆå¤šæ€è·¯ï¼Œæœ€å¿«çš„åŠæ³•å°±æ˜¯ç”¨å‰é¢æåˆ°çš„<code>s[::-1]</code>æ¥å®ç°é€†åºï¼Œå³ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_palindromic4</span><span class="params">(num)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> num == num[::<span class="number">-1</span>]</span><br><span class="line">a = <span class="string">'abcdcba'</span></span><br><span class="line">b = <span class="string">'abcdefg'</span></span><br><span class="line">print(is_palindromic4(b))</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥é€‰æ‹©æŠŠå­—ç¬¦ä¸²è½¬æˆ<code>list</code>æˆ–è€…<code>tuple</code>ç„¶åä½¿ç”¨<code>reverse</code>å‡½æ•°æ¥å®ç°é€†åºã€‚å³ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">list(a)==list(reverse(a))</span><br><span class="line">tuple(a)==tuple(reverse(a))</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¸‹é¢ä»£ç æ‰§è¡Œåçš„<code>s</code>æ˜¯ï¼ˆï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = [<span class="string">'a'</span>, <span class="string">'b'</span>]</span><br><span class="line">s.append([<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">s.extend(<span class="string">'34'</span>)</span><br><span class="line">s.extend([<span class="number">5</span>, <span class="number">6</span>])</span><br><span class="line">s.insert(<span class="number">1</span>, <span class="number">7</span>)</span><br><span class="line">s.insert(<span class="number">10</span>, <span class="number">8</span>)</span><br><span class="line">s.pop(<span class="number">2</span>)</span><br><span class="line">s.remove(<span class="string">'a'</span>)</span><br><span class="line">s[<span class="number">4</span>:] = []</span><br><span class="line">s.reverse()</span><br></pre></td></tr></table></figure>

<p>å¯¹ç…§æ¯ä¸ªå‡½æ•°çš„ä½œç”¨å¯ä»¥å¾ˆå®¹æ˜“åˆ¤æ–­å‡ºæœ€åçš„ç»“æœæ˜¯<code>[&#39;4&#39;,&#39;3&#39;,[1,2],7]</code></p>
</li>
</ol>
<h3 id="ä½œä¸š"><a href="#ä½œä¸š" class="headerlink" title="ä½œä¸š"></a>ä½œä¸š</h3><ol>
<li><p>ä½¿ç”¨<code>+</code>,<code>-</code>,<code>*</code>,<code>/</code>,<code>**</code>è¿ç®—ç¬¦å’Œæ•°å­—<code>2</code>,<code>3</code>,<code>4</code>,<code>5</code>ï¼Œæ„é€ ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¯¥è¡¨è¾¾å¼ä¸­ä¸Šè¿°4ä¸ªæ•°å­—å’Œ3ç§ä¸åŒè¿ç®—ç¬¦å„ç”¨ä¸€æ¬¡ï¼Œä½¿å¾—è¡¨è¾¾å¼çš„ç»“æœä¸º24ï¼Œæ‰“å°å‡ºæ»¡è¶³æ¡ä»¶çš„è¡¨è¾¾å¼ã€‚</p>
<p>æç¤ºï¼š</p>
<p>(1)æ„å»ºè¡¨è¾¾å¼å­—ç¬¦ä¸²ï¼Œç„¶åç”¨å†…ç½®å‡½æ•°<code>eval</code>è®¡ç®—è¯¥å­—ç¬¦ä¸² ï¼Œä¾‹å¦‚<code>eval(&#39;3*4/2+5&#39;)</code>è¿”å›<code>11.0</code>ï¼› </p>
<p>(2)ä¸¤å­—ç¬¦ä¸²å¯é€šè¿‡â€+â€è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚<code>â€™heâ€™+â€™lloâ€™</code>ä¼š å¾—åˆ°<code>â€™helloâ€™</code>ï¼› </p>
<p>(3)æœ¬é¢˜å…³é”®åœ¨äºæ±‚æ’åˆ—ï¼Œæ’åˆ—æœ‰å¤šç§å®ç°æ–¹å¼ï¼Œä¾‹å¦‚å¾ªç¯ã€‚</p>
<p>æ ¹æ®æç¤ºå¾ˆå®¹æ˜“æƒ³åˆ°ä¸€ä¸ªæ€è·¯ï¼šæŠŠæ•°å­—çš„å…¨æ’åˆ—å’Œè¿ç®—ç¬¦çš„å–3ä¸ªæ’åˆ—åˆ†åˆ«åˆ—å‡ºæ¥ï¼Œç„¶åé€ä¸€ç»„åˆæˆå­—ç¬¦ä¸²ï¼Œä½¿ç”¨<code>eval</code>è®¡ç®—ç»“æœï¼Œå¦‚æœæ˜¯24ï¼Œå°±è¾“å‡ºã€‚æŸ¥æ‰¾èµ„æ–™åå‘ç°<code>python</code>æœ‰ä¸€ä¸ªç®—æ’åˆ—çš„åº“å‡½æ•°<code>itertools.permutations(s, n)</code>ï¼Œè¯¥å‡½æ•°è¿”å›åˆ—è¡¨<code>s</code>ä¸­å–<code>n</code>ä¸ªå…ƒç´ çš„æ’åˆ—ç»“æœï¼Œè¯¥ç»“æœä¹Ÿæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡è¯¥å‡½æ•°å¾—åˆ°æ•°å­—å’Œè¿ç®—ç¬¦çš„æ’åˆ—ç»“æœï¼Œå¹¶<code>for</code>å¾ªç¯éå†ï¼Œå°†å®ƒä»¬ç»„æˆè®¡ç®—è¡¨è¾¾å¼å¹¶æ±‚ç»“æœï¼Œç„¶åè¾“å‡ºã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line">op = [<span class="string">'+'</span>, <span class="string">'-'</span>, <span class="string">'*'</span>, <span class="string">'/'</span>, <span class="string">'**'</span>]</span><br><span class="line">num = [<span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> itertools.permutations(num, <span class="number">4</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> itertools.permutations(op, <span class="number">3</span>):</span><br><span class="line">        s = i[<span class="number">0</span>] + j[<span class="number">0</span>] + i[<span class="number">1</span>] + j[<span class="number">1</span>] + i[<span class="number">2</span>] + j[<span class="number">2</span>] + i[<span class="number">3</span>]</span><br><span class="line">        <span class="keyword">if</span> float(eval(s)) == <span class="number">24.0</span>:</span><br><span class="line">            print(s)</span><br></pre></td></tr></table></figure>

<p>æ­¤å¤–ï¼Œ<code>python</code>ä¸­å®Œæˆ24ç‚¹æ¸¸æˆçš„æ€è·¯è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šï¼Œå¤æ‚ä¸€äº›çš„åŠæ³•å¯ä»¥æ˜¯æ„é€ äºŒå‰æ ‘ï¼Œç„¶åéå†èŠ‚ç‚¹ã€‚</p>
</li>
<li><p>è¾“å…¥ä¸€ä¸ªåˆ—è¡¨ï¼Œç„¶ååˆ é™¤è¯¥åˆ—è¡¨ä¸­çš„é‡å¤çš„å…ƒç´ ï¼Œè¦æ±‚åˆ é™¤é‡å¤å…ƒç´ åè¿˜ä¿æŒåŸæ’åºï¼Œæœ€åè¾“å‡ºç»“æœã€‚ä¾‹å¦‚ï¼Œè¾“å…¥åˆ—è¡¨ <code>[0, 1, 1, 1, 3, 0, 3, 2]</code>ï¼Œè¾“å‡º <code>[0, 1, 3, 2]</code>ã€‚</p>
<p>è¿™ä¸ªé¢˜ä¹Ÿæœ‰å¾ˆå¤šæ€è·¯ï¼Œæ¯”å¦‚é€ä¸ªæ¯”è¾ƒç­‰ã€‚æœ‰ä¸€ç§å¾ˆä¾¿æ·çš„æ–¹æ³•æ˜¯ï¼Œå¯¹è¾“å…¥åˆ—è¡¨ç”Ÿæˆå­—å…¸ï¼Œè¿™æ ·å°±æŒ‰é¡ºåºå»æ‰äº†é‡å¤å…ƒç´ ï¼Œå†å°†å­—å…¸çš„<code>key</code>è½¬æˆåˆ—è¡¨å³å¯ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">list1 = eval(input(<span class="string">'è¯·è¾“å…¥ä¸€ä¸ªåˆ—è¡¨ï¼š'</span>))</span><br><span class="line">list2 = dict.fromkeys(list1)</span><br><span class="line">list3 = list(list2.keys())</span><br><span class="line">print(list3)</span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>è¯¾ç¨‹ç¬”è®°</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>Let-s-Build-A-Simple-Interpreterç¬”è®°-5</title>
    <url>/2020/03/09/Let-s-Build-A-Simple-Interpreter%E7%AC%94%E8%AE%B0-5/</url>
    <content><![CDATA[<h2 id="è¯¾ç¨‹æ–‡æ¡£"><a href="#è¯¾ç¨‹æ–‡æ¡£" class="headerlink" title="è¯¾ç¨‹æ–‡æ¡£"></a>è¯¾ç¨‹æ–‡æ¡£</h2><p><a href="https://ruslanspivak.com/lsbasi-part5/" target="_blank" rel="noopener">åŸæ–‡</a></p>
<p><a href="https://feng-qi.github.io/2018/01/30/lets-build-a-simple-interpreter-part-05/" target="_blank" rel="noopener">ç¿»è¯‘</a></p>
<a id="more"></a>

<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Token types</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># EOF (end-of-file) token is used to indicate that</span></span><br><span class="line"><span class="comment"># there is no more input left for lexical analysis</span></span><br><span class="line">INTEGER, PLUS, MINUS, MUL, DIV, EOF = (</span><br><span class="line">    <span class="string">'INTEGER'</span>, <span class="string">'PLUS'</span>, <span class="string">'MINUS'</span>, <span class="string">'MUL'</span>, <span class="string">'DIV'</span>, <span class="string">'EOF'</span></span><br><span class="line">)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Token</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, type, value)</span>:</span></span><br><span class="line">        <span class="comment"># token type: INTEGER, PLUS, MINUS, MUL, DIV, or EOF</span></span><br><span class="line">        self.type = type</span><br><span class="line">        <span class="comment"># token value: non-negative integer value, '+', '-', '*', '/', or None</span></span><br><span class="line">        self.value = value</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""String representation of the class instance.</span></span><br><span class="line"><span class="string">        Examples:</span></span><br><span class="line"><span class="string">            Token(INTEGER, 3)</span></span><br><span class="line"><span class="string">            Token(PLUS, '+')</span></span><br><span class="line"><span class="string">            Token(MUL, '*')</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">f'Token(<span class="subst">&#123;self.type&#125;</span>, <span class="subst">&#123;repr(self.value)&#125;</span>)'</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.__str__()</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Lexer</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, text)</span>:</span></span><br><span class="line">        <span class="comment"># client string input, e.g. "3 * 5", "12 / 3 * 4", etc</span></span><br><span class="line">        self.text = text</span><br><span class="line">        <span class="comment"># self.pos is an index into self.text</span></span><br><span class="line">        self.pos = <span class="number">0</span></span><br><span class="line">        self.current_char = self.text[self.pos]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">error</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">'Lexer error'</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">advance</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Advance the `pos` pointer and set the `current_char` variable."""</span></span><br><span class="line">        self.pos += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> self.pos &gt;= len(self.text):</span><br><span class="line">            self.current_char = <span class="literal">None</span>  <span class="comment"># Indicates end of input</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.current_char = self.text[self.pos]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">skip_whitespace</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">while</span> self.current_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> self.current_char.isspace():</span><br><span class="line">            self.advance()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">integer</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Return a (multidigit) integer consumed from the input."""</span></span><br><span class="line">        value = <span class="string">''</span></span><br><span class="line">        <span class="keyword">while</span> self.current_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> self.current_char.isdigit():</span><br><span class="line">            value += self.current_char</span><br><span class="line">            self.advance()</span><br><span class="line">        <span class="keyword">return</span> int(value)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_next_token</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Lexical analyzer (also known as scanner or tokenizer)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        This method is responsible for breaking a sentence</span></span><br><span class="line"><span class="string">        apart into tokens. One token at a time.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">while</span> self.current_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">if</span> self.current_char.isspace():</span><br><span class="line">                self.skip_whitespace()</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">elif</span> self.current_char.isdigit():</span><br><span class="line">                <span class="keyword">return</span> Token(INTEGER, self.integer())</span><br><span class="line">            <span class="keyword">elif</span> self.current_char == <span class="string">'*'</span>:</span><br><span class="line">                self.advance()</span><br><span class="line">                <span class="keyword">return</span> Token(MUL, <span class="string">'*'</span>)</span><br><span class="line">            <span class="keyword">elif</span> self.current_char == <span class="string">'/'</span>:</span><br><span class="line">                self.advance()</span><br><span class="line">                <span class="keyword">return</span> Token(DIV, <span class="string">'/'</span>)</span><br><span class="line">            <span class="keyword">elif</span> self.current_char == <span class="string">'+'</span>:</span><br><span class="line">                self.advance()</span><br><span class="line">                <span class="keyword">return</span> Token(PLUS, <span class="string">'+'</span>)</span><br><span class="line">            <span class="keyword">elif</span> self.current_char == <span class="string">'-'</span>:</span><br><span class="line">                self.advance()</span><br><span class="line">                <span class="keyword">return</span> Token(MINUS, <span class="string">'-'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.error()</span><br><span class="line">        <span class="keyword">return</span> Token(EOF, <span class="literal">None</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Interpreter</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, lexer)</span>:</span></span><br><span class="line">        self.lexer = lexer</span><br><span class="line">        <span class="comment"># set current token to the first token taken from the input</span></span><br><span class="line">        self.current_token = self.lexer.get_next_token()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">error</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">'Interpreter error'</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">eat</span><span class="params">(self, token_type)</span>:</span></span><br><span class="line">        <span class="comment"># compare the current token type with the passed token</span></span><br><span class="line">        <span class="comment"># type and if they match then "eat" the current token</span></span><br><span class="line">        <span class="comment"># and assign the next token to the self.current_token,</span></span><br><span class="line">        <span class="comment"># otherwise raise an exception.</span></span><br><span class="line">        <span class="keyword">if</span> self.current_token.type == token_type:</span><br><span class="line">            self.current_token = self.lexer.get_next_token()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.error()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">factor</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""factor : INTEGER"""</span></span><br><span class="line">        value = self.current_token.value</span><br><span class="line">        self.eat(INTEGER)</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">term</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""term : factor ((MUL | DIV) factor)*"""</span></span><br><span class="line">        value = self.factor()</span><br><span class="line">        <span class="keyword">while</span> self.current_token.type <span class="keyword">in</span> (MUL, DIV):</span><br><span class="line">            <span class="keyword">if</span> self.current_token.type == MUL:</span><br><span class="line">                self.eat(MUL)</span><br><span class="line">                value *= self.factor()</span><br><span class="line">            <span class="keyword">elif</span> self.current_token.type == DIV:</span><br><span class="line">                self.eat(DIV)</span><br><span class="line">                value /= self.factor()</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">expr</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Arithmetic expression parser / interpreter.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        calc&gt;  14 + 2 * 3 - 6 / 2</span></span><br><span class="line"><span class="string">        17</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        expr   : term ((PLUS | MINUS) term)*</span></span><br><span class="line"><span class="string">        term   : factor ((MUL | DIV) factor)*</span></span><br><span class="line"><span class="string">        factor : INTEGER</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        value = self.term()</span><br><span class="line">        <span class="keyword">while</span> self.current_token.type <span class="keyword">in</span> (PLUS, MINUS):</span><br><span class="line">            <span class="keyword">if</span> self.current_token.type == PLUS:</span><br><span class="line">                self.eat(PLUS)</span><br><span class="line">                value += self.term()</span><br><span class="line">            <span class="keyword">elif</span> self.current_token.type == MINUS:</span><br><span class="line">                self.eat(MINUS)</span><br><span class="line">                value -= self.term()</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.expr()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            text = input(<span class="string">'calc&gt; '</span>)</span><br><span class="line">        <span class="keyword">except</span> EOFError:</span><br><span class="line">            print()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> len(text.strip()):</span><br><span class="line">            interpreter = Interpreter(Lexer(text))</span><br><span class="line">            result = interpreter.parse()</span><br><span class="line">            print(result)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="ç¬”è®°"><a href="#ç¬”è®°" class="headerlink" title="ç¬”è®°"></a>ç¬”è®°</h2><p>è¿™ä¸€è¯¾è®²çš„æ˜¯è¿ç®—ç»“åˆæ€§å’Œä¼˜å…ˆçº§çš„å¤„ç†ã€‚</p>
<h4 id="ä»€ä¹ˆæ˜¯ç»“åˆæ€§"><a href="#ä»€ä¹ˆæ˜¯ç»“åˆæ€§" class="headerlink" title="ä»€ä¹ˆæ˜¯ç»“åˆæ€§"></a>ä»€ä¹ˆæ˜¯ç»“åˆæ€§</h4><p>å½“ä¸€ä¸ªæ“ä½œæ•°ï¼ˆæ¯”å¦‚ 7+3+1 ä¸­çš„ 3ï¼‰ä¸¤è¾¹éƒ½æœ‰åŠ å·æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªè§„åˆ™æ¥å†³å®šå“ªä¸ªè¿ç®—ç¬¦ä½œç”¨äº 3ï¼Œæ ¹æ®ç»éªŒï¼Œæ˜¯å·¦è¾¹çš„åŠ å·èµ·ä½œç”¨ï¼ˆä¹Ÿå°±æ˜¯å…ˆè®¡ç®—7+3ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬æŠŠåŠ å·çœ‹åšæ˜¯å·¦ç»“åˆçš„ã€‚ç±»ä¼¼åœ°ï¼Œå‡ã€ä¹˜ã€é™¤ä¹Ÿéƒ½æ˜¯å·¦ç»“åˆçš„ã€‚</p>
<h4 id="ä»€ä¹ˆæ˜¯ä¼˜å…ˆçº§"><a href="#ä»€ä¹ˆæ˜¯ä¼˜å…ˆçº§" class="headerlink" title="ä»€ä¹ˆæ˜¯ä¼˜å…ˆçº§"></a>ä»€ä¹ˆæ˜¯ä¼˜å…ˆçº§</h4><p>å½“ä¸€ä¸ªæ“ä½œæ•°ï¼ˆæ¯”å¦‚ 7 + 5 * 2 ä¸­çš„5ï¼‰ä¸¤è¾¹æœ‰ä¸åŒçš„è¿ç®—ç¬¦æ—¶ï¼Œå…ˆè¿›è¡Œè¿ç®—çš„é‚£ä¸ªè¿ç®—ç¬¦ä¼˜å…ˆçº§è¾ƒé«˜ï¼Œæ¯”å¦‚æˆ‘ä»¬è¯´è¿ç®—ç¬¦*æ¯”+å…ˆå–è¿ç®—ç¬¦ï¼Œ*å°±æœ‰è¾ƒé«˜çš„ä¼˜å…ˆçº§ã€‚</p>
<p>åœ¨ä¸€ä¸ªè¡¨è¾¾å¼ä¸­æœ‰ç›¸åŒä¼˜å…ˆçº§çš„è¿ç®—ç¬¦å‡ºç°æ—¶ï¼Œæˆ‘ä»¬å°±ä½¿ç”¨ç»“åˆæ€§æƒ¯ä¾‹ä»å·¦åˆ°å³æ‰§è¡Œã€‚</p>
<h4 id="æ„å»ºè¯­æ³•å’Œå†™è§£é‡Šå™¨"><a href="#æ„å»ºè¯­æ³•å’Œå†™è§£é‡Šå™¨" class="headerlink" title="æ„å»ºè¯­æ³•å’Œå†™è§£é‡Šå™¨"></a>æ„å»ºè¯­æ³•å’Œå†™è§£é‡Šå™¨</h4><p>ä»¥ç®—æœ¯è¡¨è¾¾å¼ä¸ºä¾‹ï¼Œä¼˜å…ˆçº§åˆ—è¡¨å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>ä¼˜å…ˆçº§</th>
<th>ç»“åˆæ€§</th>
<th>è¿ç®—ç¬¦</th>
</tr>
</thead>
<tbody><tr>
<td>2</td>
<td>å·¦ç»“åˆ</td>
<td>+, -</td>
</tr>
<tr>
<td>1</td>
<td>å·¦ç»“åˆ</td>
<td>*, /</td>
</tr>
</tbody></table>
<p>ä»ä¼˜å…ˆçº§è¡¨æ„å»ºè¯­æ³•ï¼š</p>
<ol>
<li>å¯¹äºæ¯ä¸€ä¸ªä¼˜å…ˆçº§å®šä¹‰ä¸€ä¸ªéç»ˆç»“ç¬¦ã€‚è¿™ä¸ªéç»ˆç»“ç¬¦çš„ç”Ÿæˆå¼çš„ body åº”è¯¥ç”±æœ¬ä¼˜å…ˆçº§çš„ç®—æœ¯è¿ç®—ç¬¦å’Œæ›´é«˜ä¼˜å…ˆçº§çš„éç»ˆç»“ç¬¦ç»„æˆã€‚</li>
<li>å¯¹è¡¨è¾¾å¼çš„åŸºæœ¬å•å…ƒ(åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯ INTEGER)æ–°å»ºä¸€ä¸ªé¢å¤–çš„éç»ˆç»“ç¬¦ <code>factor</code>. ä¸€èˆ¬åŸåˆ™å°±æ˜¯å¦‚æœä½ æœ‰ N çº§ä¼˜å…ˆçº§ï¼Œä½ ä¸€å…±ä¼šéœ€è¦ N+1 éç»ˆç»“ç¬¦ï¼šæ¯ä¸ªä¼˜å…ˆçº§ä¸€ä¸ªå† åŠ ä¸ŠåŸºæœ¬å•å…ƒçš„ä¸€ä¸ªã€‚</li>
</ol>
<p>å…·ä½“æ¥è¯´æˆ‘ä»¬ç°åœ¨æœ‰2ä¸ªä¼˜å…ˆçº§ï¼Œå› æ­¤ä¼šæœ‰3ä¸ªéç»ˆç»“ç¬¦ï¼Œä¼˜å…ˆçº§ä¸º2çš„å¯¹åº”<code>expr</code>ï¼Œä¼˜å…ˆçº§ä¸º1çš„å¯¹åº”<code>term</code>ï¼Œæœ€åæ˜¯<code>factor</code>ã€‚</p>
<p><code>expr</code>è¦è¡¨è¾¾åŒ…å«<code>term</code>çš„åŠ å‡è¿ç®—ï¼Œå³ï¼š<code>expr: term((PLUS|MINUS)term)*</code></p>
<p><code>term</code>åˆ™æ˜¯åŒ…å«<code>factor</code>çš„ä¹˜é™¤è¿ç®—ï¼Œå³ï¼š<code>termï¼› factor((MUL|DIV)factor)*</code></p>
<p>æœ€å<code>factor</code>æ˜¯åŸºæœ¬å•å…ƒï¼Œå³ï¼š<code>factor: INTEGER</code></p>
<p>ç„¶åå°±æ˜¯å’Œä¸Šä¸€è¯¾ä¸€æ ·çš„æ­¥éª¤å†™ä»£ç äº†ã€‚</p>
<p>ï¼ˆæ€»çš„æ¥è¯´è¿™ä¸€è¯¾æ²¡æœ‰ä»€ä¹ˆæ–°çŸ¥è¯†ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯ä¸èƒ½ä¸çœ‹æ•™ç¨‹è‡ªå·±å†™â€¦ï¼‰</p>
<h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><ol>
<li><p>æ ¹æ®æœ¬æ–‡çš„æè¿°å‡­è®°å¿†å†™å‡ºä¸€ä¸ªè§£é‡Šå™¨ï¼Œä¸è¦å‚è€ƒæ–‡ä¸­çš„ä»£ç ã€‚ä¸ºä½ çš„è§£é‡Šå™¨å†™ä¸€äº›æµ‹è¯•ï¼Œç¡®ä¿å®ƒä»¬å¯ä»¥é€šè¿‡ã€‚</p>
<p>æˆ‘å¤ªèœäº†æ‰€ä»¥å¹¶æ²¡æ³•å‡­è®°å¿†å†™ä¸€ä¸ªè§£é‡Šå™¨ï¼Œäºæ˜¯æˆ‘å¼€å§‹ç…§ç€ä»£ç æŠ„ä¸€ä¸‹ï¼Œå¹¶å¾ˆå¿«å‘ç°å°±ç®—æ˜¯ç…§æŠ„æˆ‘ä¹Ÿä¼šå‡ºé”™â€¦</p>
<p>ä¸»è¦é”™è¯¯å¦‚ä¸‹ï¼š</p>
<ol>
<li><code>else</code>åé¢å¿˜äº†åŠ <code>:</code>ï¼›</li>
<li>æŸä¸ªåœ°æ–¹çš„èµ‹å€¼(<code>=</code>)ä¸€ä¸ªä¸æ³¨æ„å°±å†™æˆäº†ç›¸ç­‰(<code>==</code>)ï¼›</li>
<li><code>while self.current_char is not None and self.current_char.isdigit():</code>ä»¥åŠå‰é¢åˆ¤æ–­ç©ºæ ¼çš„é‚£ä¸ªç±»ä¼¼çš„è¯­å¥ï¼Œ<code>is not None</code>ä¸€å®šè¦æ”¾å‰é¢ï¼Œå¦‚æœåè¿‡æ¥ï¼Œåœ¨å½“å‰å­—ç¬¦æ˜¯ç©ºçš„æ—¶å€™ï¼Œæ‰§è¡Œ<code>isdigit()</code>å’Œ<code>isspace()</code>å°±ä¼šæŠ¥é”™äº†ï¼Œæ‰€ä»¥è¦å…ˆåˆ¤å®šä¸ä¸ºç©ºã€‚</li>
</ol>
<p>æˆ‘å¥½èœå•Š.jpg</p>
</li>
<li><p>æ‰©å±•è¿™ä¸ªè§£é‡Šå™¨æ¥å¤„ç†åŒ…å«æ‹¬å·çš„ç®—æœ¯è¡¨è¾¾å¼ï¼Œä½¿å¾—ä½ çš„è§£é‡Šå™¨å¯ä»¥å¯¹åµŒå¥—å¾ˆæ·±å¾ˆæ·±çš„ç®—æœ¯è¡¨è¾¾å¼è¿›è¡Œæ±‚å€¼å¦‚ï¼š7 + 3 * (10 / (12 / (3 + 1) - 1))</p>
<p>è¿™ä¸ªæˆ‘çš„æƒ³æ³•æ˜¯è¦è®¾å®šä¸€ä¸‹æ‹¬å·çš„ç»“åˆæ€§ï¼Œå·¦æ‹¬å·æ˜¯å³ç»“åˆè€Œå³æ‹¬å·æ˜¯å·¦ç»“åˆï¼Œä½†æ˜¯ä¸ä¼šå†™ã€‚</p>
<p>çœ‹äº†ä¸‹ä¸€è¯¾å‘ç°æ˜¯è¦å†™é€’å½’è¯­æ³•åˆ†æï¼Œæ‰€ä»¥æ”¾ä¸‹ä¸€è¯¾æ¥å†™å§ã€‚</p>
</li>
</ol>
<h2 id="æ£€æŸ¥ç†è§£"><a href="#æ£€æŸ¥ç†è§£" class="headerlink" title="æ£€æŸ¥ç†è§£"></a>æ£€æŸ¥ç†è§£</h2><ol>
<li><p>ä¸€ä¸ªæ“ä½œç¬¦æ˜¯å·¦ç»“åˆçš„æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</p>
<p>æ˜¯æŒ‡å½“æ•°å­—å·¦å³ä¸¤è¾¹éƒ½æœ‰è¯¥è¿ç®—ç¬¦æ—¶ï¼Œæ•°å­—å–å·¦è¾¹çš„è¿ç®—ç¬¦ã€‚</p>
</li>
<li><p>æ“ä½œç¬¦åŠ å‡æ˜¯å·¦ç»“åˆçš„è¿˜æ˜¯å³ç»“åˆçš„ï¼Ÿä¹˜é™¤å‘¢ï¼Ÿ</p>
<p>éƒ½æ˜¯å·¦ç»“åˆã€‚</p>
</li>
<li><p>æ“ä½œç¬¦åŠ æ˜¯å¦æ¯”æ“ä½œç¬¦ä¹˜æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ï¼Ÿ</p>
<p>å¦ï¼Œä¹˜çš„ä¼˜å…ˆçº§æ›´é«˜ã€‚</p>
</li>
</ol>
]]></content>
      <categories>
        <category>Let&#39;s Build A Simple Interpreter</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>ç¼–è¯‘åŸç†</tag>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonè¯¾ç¨‹è®°å½•-2</title>
    <url>/2020/03/04/python%E8%AF%BE%E7%A8%8B%E8%AE%B0%E5%BD%95-2/</url>
    <content><![CDATA[<ol>
<li><p>ä¸‹é¢ç¨‹åºçš„è¿è¡Œç»“æœæ˜¯ï¼ˆ    ï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">		<span class="keyword">if</span> i == j == <span class="number">1</span>ï¼›</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			print(i, <span class="string">'----'</span>, j)</span><br></pre></td></tr></table></figure>

<p>A.    0 â€”- 0                B.    0 â€”- 0<br>â€‹        0 â€”- 1                       0 â€”- 1<br>â€‹        0 â€”- 2                       0 â€”- 2<br>â€‹        1 â€”- 0                       1 â€”- 0<br>â€‹        2 â€”- 0<br>â€‹        2 â€”- 1<br>â€‹        2 â€”- 2</p>
</li>
</ol>
<a id="more"></a>

<p>ç­”æ¡ˆï¼šAï¼ˆæˆ‘æ€€ç–‘è¿™é¢˜çš„é€‰é¡¹å¯¹é½åœ¨ç½‘é¡µä¸Šæ˜¾ç¤ºä¼šå‡ºé—®é¢˜ï¼Œä¸è¿‡æ‡’å¾—æ”¹äº†ï¼‰</p>
<p><code>break</code>çš„ä¸­æ–­åªä¼šæ–­ä¸€å±‚ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªä»£ç åœ¨<code>i=j=1</code>çš„æ—¶å€™ï¼Œå±äº<code>j</code>çš„å¾ªç¯ä¼šä¸­æ–­ï¼Œ<code>j=2</code>å’Œ<code>j=3</code>å°†è·³è¿‡ï¼Œç›´æ¥å¼€å§‹<code>i=2, j=0</code>ç„¶åç»§ç»­å¾ªç¯ï¼Œä¹Ÿå°±æ˜¯Aé€‰é¡¹ã€‚</p>
<ol start="2">
<li><p>ä¸‹é¢ç¨‹åºçš„è¿è¡Œç»“æœæ˜¯ï¼ˆ    ï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">		<span class="keyword">if</span> i == j == <span class="number">1</span>:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			print(i, <span class="string">'----'</span>, j)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>A.    0 â€”- 0                B.    0 â€”- 0<br>â€‹        0 â€”- 1                       0 â€”- 1<br>â€‹        0 â€”- 2                       0 â€”- 2<br>â€‹        1 â€”- 0                       1 â€”- 0<br>â€‹        2 â€”- 0<br>â€‹        2 â€”- 1<br>â€‹        2 â€”- 2</p>
</li>
</ol>
<p>ç­”æ¡ˆï¼šB</p>
<p>è¿™é‡Œé¦–å…ˆè¦å­¦ä¹ çš„æ˜¯<code>python</code>ä¸å…¶ä»–è¯­è¨€ä¸­ä¸å¤ªä¸€æ ·çš„<code>else</code>ç”¨æ³•ï¼Œåœ¨å…¶ä»–è¯­è¨€ä¸­ï¼Œ<code>else</code>åªæ­é…<code>if</code>æ¥åšæ¡ä»¶åˆ¤æ–­ï¼Œè€Œ<code>python</code>ä¸­æœ‰<code>for... else...</code>ã€<code>while...else...</code>å’Œ<code>try...else...</code>çš„ç”¨æ³•ï¼Œå…·ä½“æ¥è¯´ï¼Œåœ¨<code>for</code>å¾ªç¯ä¸­å¦‚æœæœ‰å¹¶è§¦å‘äº†<code>break</code>ï¼Œåˆ™<code>for</code>å¾ªç¯åçš„<code>else</code>è¯­å¥ä¸ä¼šè¢«æ‰§è¡Œï¼Œå¦‚æœæ²¡è§¦å‘æˆ–è€…æ²¡æœ‰ï¼Œåˆ™ä¼šæ‰§è¡Œ<code>else</code>åˆ†æ”¯çš„è¯­å¥ï¼›åœ¨<code>while</code>å¾ªç¯ä¸­ï¼Œä¹Ÿæ˜¯å¦‚æ­¤ï¼Œ<code>break</code>ä¸æ‰§è¡Œæˆ–ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œå°±ä¼šæ‰§è¡Œ<code>else</code>è¯­å¥ï¼Œè€Œå¦‚æœæ‰§è¡Œäº†<code>break</code>å°±ä¸ä¼šæ‰§è¡Œ<code>else</code>ï¼›<code>try</code>ä¸­çš„ç”¨æ³•åˆ™æ˜¯å½“<code>try</code>å—ä¸­çš„è¯­å¥æ­£å¸¸æ‰§è¡Œå®Œæ¯•å°±ä¼šæ‰§è¡Œ<code>else</code>åˆ†æ”¯ã€‚</p>
<p>å…¶æ¬¡ï¼Œ<code>continue</code>åœ¨å¾ªç¯ä¸­æ˜¯ç”¨æ¥è·³è¿‡è¿™æ¬¡å¾ªç¯å¹¶å¼€å§‹ä¸‹ä¸€æ¬¡å¾ªç¯ï¼Œæ¯”å¦‚åœ¨<code>j=1</code>çš„æ—¶å€™<code>continue</code>ï¼Œåˆ™<code>j=1</code>ä¸­å‰©ä¸‹çš„è¯­å¥ä¸æ‰§è¡Œï¼Œä½†æ˜¯ä¼šå¼€å§‹æ‰§è¡Œ<code>j=2</code>ï¼Œè€Œä¸æ˜¯åƒ<code>break</code>é‚£æ ·è·³å‡º<code>j</code>çš„å¾ªç¯å»æ‰§è¡Œ<code>i</code>çš„å¾ªç¯ã€‚</p>
<p>åˆ†æè¿™ä¸ªä»£ç ï¼Œè¿™ä¸ª<code>else</code>åˆ†æ”¯æ˜¯<code>j</code>çš„å¾ªç¯å¯¹åº”çš„ï¼Œä¹Ÿå°±æ˜¯è¯´<code>i=0,j=x</code>æ—¶ï¼Œæ²¡è§¦å‘<code>break</code>ï¼Œæ¯æ¬¡éƒ½ä¼šæ‰§è¡Œ<code>else</code>ä¸­çš„<code>continue</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æ­¤æ—¶æœ€åä¸€è¡Œçš„æ‰“æ–­<code>i</code>çš„å¾ªç¯çš„<code>break</code>ä¸ä¼šæ‰§è¡Œï¼›åœ¨<code>i=j=1</code>çš„æ—¶å€™<code>j</code>çš„å¾ªç¯<code>break</code>äº†ï¼Œé‚£ä¹ˆ<code>else</code>åˆ†æ”¯ä¸ä¼šæ‰§è¡Œï¼Œå°±ä¼šæ‰§è¡Œåˆ°æœ€åä¸€è¡Œçš„<code>break</code>ï¼Œä»è€Œæ‰“æ–­<code>i</code>çš„å¾ªç¯ï¼Œç¨‹åºç›´æ¥ç»“æŸï¼Œä¹Ÿå°±æ˜¯Bé€‰é¡¹ã€‚</p>
<p>è¯¾åä½œä¸šï¼š</p>
<ol>
<li>åˆ©ç”¨randomåº“ï¼Œéšæœºå‡º100é“ä¸¤ä¸ªæ•°çš„åŠ ã€å‡å£ç®—é¢˜ã€‚è¦æ±‚ ï¼š (1)a+bæˆ–è€…a-bï¼Œaã€bå’Œå¾—æ•°èŒƒå›´å‡ä¸º[0,100]ï¼›(2)å¦‚æœæ˜¯åŠ æ³•è¿ç®—ï¼Œè¦æ±‚æœ‰è¿›ä½ï¼›å¦‚æœæ˜¯å‡æ³•è¿ç®—ï¼Œè¦æ±‚æœ‰é€€ä½ï¼›(3)åœ¨å±å¹•ä¸Šæ‰“å°å‡ºç»“æœï¼Œæ¯ä¸€è¡Œæ˜¾ç¤º4é“é¢˜ï¼Œæ³¨æ„å¯¹é½ã€‚ç¤ºä¾‹å¦‚ä¸‹ã€‚ï¼ˆç¤ºä¾‹å°±ä¸æ”¾äº†æ€»ä¹‹å°±æ˜¯100ä¸ªåŠ å‡æ³•è¿ç®—é¢˜ï¼ŒåŠ æ³•æœ‰è¿›ä½å‡æ³•æœ‰å€Ÿä½ï¼Œè¾“å‡ºæ˜¯æ ¼å¼åŒ–çš„ï¼‰</li>
</ol>
<p>è¿™ä¸ªæœ¬æ¥æ˜¯ä¸éš¾çš„ï¼Œéšæœºç”Ÿæˆä¸¤ä¸ª100ä»¥å†…çš„æ•°å­—ç„¶åéšæœºå†³å®šåŠ å‡æ³•å°±è¡Œï¼Œä½†æ˜¯è¿˜å¿…é¡»æœ‰è¿›ä½å’Œé€€ä½ã€‚</p>
<p>ä¸€å¼€å§‹çš„æ€è·¯æ˜¯ï¼Œå…ˆéšæœºç”Ÿæˆç¬¬ä¸€ä¸ªæ•°å­—<code>a</code>ï¼Œç„¶åå†éšæœºç”Ÿæˆ<code>0</code>å’Œ<code>1</code>æ¥å†³å®šåŠ å‡æ³•ï¼Œæ¥ä¸‹æ¥å¦‚æœæ˜¯åŠ æ³•ï¼Œå°±ç”Ÿæˆä¸€ä¸ªåœ¨<code>a</code>åˆ°<code>100-a</code>ä¹‹é—´çš„æ•°å­—<code>b</code>ï¼Œå¦‚æœæ˜¯å‡æ³•ï¼Œå°±ç”Ÿæˆä¸€ä¸ªåœ¨<code>1</code>åˆ°<code>a</code>ä¹‹é—´çš„æ•°å­—<code>b</code>ï¼Œè¿™ä¸¤ä¸ªåˆ†æ”¯ä¸­ï¼Œå¦‚æœ<code>b</code>ä¸ç¬¦åˆè¿›ä½æˆ–è€…é€€ä½ï¼Œå°±é‡æ–°ç”Ÿæˆï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª<code>while</code>å¾ªç¯ã€‚</p>
<p>æŒ‰è¿™ä¸ªæ€è·¯å†™å¥½è¿è¡Œä»¥åå°±å‘ç°äº†é—®é¢˜ï¼Œé‚£ä¸ª<code>while</code>å¾ªç¯æœ‰æ—¶å€™ä¼šä¸€ç›´å¾ªç¯ä¸‹å»å°±æ˜¯æ‰¾ä¸åˆ°ç¬¦åˆè¿›ä½æˆ–é€€ä½çš„æ•°å­—<code>b</code>ï¼Œè¿™æ˜¯å› ä¸ºä¸€å¼€å§‹çš„æ•°å­—<code>a</code>å¦‚æœä¸åˆé€‚ï¼Œé‚£ä»€ä¹ˆæ•°å­—ä¹Ÿæ²¡æ³•å®ç°è¿›ä½æˆ–è€…é€€ä½ï¼Œæ¯”å¦‚åŠ æ³•ä¸­ï¼Œä¸ªä½æ•°å¦‚æœæ˜¯<code>0</code>ï¼Œè¿™ä¸ªæ•°å­—è¿˜ä¸æ˜¯<code>90</code>ï¼Œåˆ™æ— è®ºå¦‚ä½•ä¹Ÿä¸ä¼šé‡åˆ°è¿›ä½ï¼›è€Œå‡æ³•ä¸­ï¼Œè¿™ä¸ªæ•°å­—å¦‚æœä¸ªä½æ˜¯<code>9</code>ï¼Œé¢˜ç›®åˆè¦æ±‚ä¸ä¼šå‡ºç°è´Ÿæ•°çš„å‡æ³•ï¼Œé‚£æ— è®ºå¦‚ä½•éƒ½ä¸å¯èƒ½æœ‰å€Ÿä½è¿ç®—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…ˆå†³å®šåŠ å‡æ³•ï¼Œå†ç”Ÿæˆä¸€ä¸ªæ°å½“çš„æ•°å­—<code>a</code>ï¼Œå®ƒè¦ç¬¦åˆä¸€äº›æ¡ä»¶ï¼Œæ¥ç€ç”Ÿæˆä¸€ä¸ªæ°å½“çš„æ•°å­—<code>b</code>ï¼Œä¹Ÿè¦ç¬¦åˆä¸€äº›æ¡ä»¶ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œæ•°å­—<code>a</code>è¦ç¬¦åˆï¼š<br>        1. å¦‚æœæ˜¯åŠ æ³•ï¼Œåˆ™ä¸ªä½æ•°ä¸æ˜¯0ï¼Œæˆ–è¿™ä¸ªæ•°ä¸æ˜¯90ï¼Œä¸”èŒƒå›´åœ¨1åˆ°90ä¹‹é—´ï¼›<br>         2. å¦‚æœæ˜¯å‡æ³•ï¼Œåˆ™ä¸ªä½æ•°ä¸æ˜¯9ï¼Œä¸”èŒƒå›´åœ¨10åˆ°100ä¹‹é—´ã€‚<br>æ•°å­—<code>b</code>è¦ç¬¦åˆï¼š<br>        1. å¦‚æœæ˜¯åŠ æ³•ï¼Œåˆ™å°äº<code>100-a</code>ï¼Œä¸”ä¸ªä½æ•°ä¹‹å’Œå¤§äº10ï¼Œæˆ–åä½æ•°ä¹‹å’Œå¤§äº10ï¼›<br>        2. å¦‚æœæ˜¯å‡æ³•ï¼Œåˆ™å°äº<code>a</code>ï¼Œä¸”ä¸ªä½æ•°æ¯”<code>a</code>çš„ä¸ªä½æ•°å¤§ï¼Œæˆ–åä½æ•°æ¯”<code>a</code>çš„åä½æ•°å¤§ã€‚</p>
<p>æœ€åå°±æ˜¯æ ¼å¼åŒ–è¾“å‡ºï¼Œç„¶åå°±ç»“æŸäº†ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">100</span>):</span><br><span class="line">    bool = random.randint(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> bool == <span class="number">0</span>:</span><br><span class="line">        a = random.randint(<span class="number">1</span>, <span class="number">90</span>)</span><br><span class="line">        <span class="keyword">while</span> a != <span class="number">90</span> <span class="keyword">and</span> a % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">            a = random.randint(<span class="number">1</span>, <span class="number">90</span>)</span><br><span class="line">        b = random.randint(<span class="number">1</span>, <span class="number">100</span> - a)</span><br><span class="line">        <span class="keyword">while</span> ((a % <span class="number">10</span> + b % <span class="number">10</span>) &lt; <span class="number">10</span>) <span class="keyword">and</span> ((a // <span class="number">10</span> + b // <span class="number">10</span>) &lt; <span class="number">10</span>):</span><br><span class="line">            b = random.randint(<span class="number">1</span>, <span class="number">100</span> - a)</span><br><span class="line">        print(<span class="string">'&#123;:&lt;2&#125; + &#123;:&lt;2&#125;='</span>.format(a, b), end=<span class="string">"\t\t"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        a = random.randint(<span class="number">10</span>, <span class="number">100</span>)</span><br><span class="line">        <span class="keyword">while</span> a % <span class="number">10</span> == <span class="number">9</span>:</span><br><span class="line">            a = random.randint(<span class="number">10</span>, <span class="number">100</span>)</span><br><span class="line">        b = random.randint(<span class="number">1</span>, a)</span><br><span class="line">        <span class="keyword">while</span> ((b % <span class="number">10</span>) &lt;= (a % <span class="number">10</span>)) <span class="keyword">and</span> ((b % <span class="number">100</span>) &lt;= (a % <span class="number">100</span>)):</span><br><span class="line">            b = random.randint(<span class="number">1</span>, a)</span><br><span class="line">        print(<span class="string">'&#123;:&lt;2&#125; - &#123;:&lt;2&#125;='</span>.format(a, b), end=<span class="string">"\t\t"</span>)</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">4</span> == <span class="number">3</span>:</span><br><span class="line">        print(<span class="string">'\n'</span>)</span><br></pre></td></tr></table></figure>

<p>è¡¥å……ä¸€ä¸‹å…³äº<code>print</code>æ ¼å¼åŒ–è¾“å‡ºçš„å†…å®¹ï¼š</p>
<p><code>python</code>ä¸­çš„<code>print</code>å‡½æ•°æœ‰ä¸€ä¸ª<code>end</code>å‚æ•°ï¼Œå½“ç›´æ¥<code>print</code>è€Œæ²¡æœ‰<code>end</code>æ—¶ï¼Œé»˜è®¤æ¢è¡Œï¼›å½“<code>end=&quot;&quot;</code>æ—¶ï¼Œå°±ä¸è‡ªåŠ¨æ¢è¡Œäº†ï¼›å½“<code>end=XXX</code>æ—¶ï¼Œåœ¨<code>print</code>åï¼Œä¼šæ¥ç€æœ‰<code>XXX</code>ï¼Œæ¯”å¦‚ä¸Šé¢ä»£ç çš„<code>\t\t</code>ï¼Œä¹Ÿä¸è‡ªåŠ¨æ¢è¡Œã€‚</p>
<p>åœ¨<code>C</code>è¯­è¨€ä¸­ï¼Œå¯ä»¥é€šè¿‡<code>prints(&quot;%d, %d&quot;, a, b)</code>æ¥å®ç°è¾“å‡º<code>a, b</code>ï¼Œå¹¶é€šè¿‡<code>%x.yd</code>ï¼ˆæ¯”å¦‚<code>%5.3d</code>)æ¥æ§åˆ¶è¾“å‡ºé•¿åº¦å’Œç²¾åº¦ï¼Œè€Œ<code>python</code>ä¸­æœ‰ç±»ä¼¼çš„ç”¨æ³•ï¼Œå³<code>str.format()</code>ï¼Œå…¶åŸºæœ¬è¯­æ³•æ˜¯é€šè¿‡<code>{}</code>å’Œ<code>:</code>æ¥ä»£æ›¿<code>%</code>ã€‚<code>&#39;{:&lt;2} - {:&lt;2}=&#39;.format(a, b)</code>è¿™æ ·çš„è¯­å¥å«ä¹‰æ˜¯ï¼šæŠŠ<code>a</code>å’Œ<code>b</code>æŒ‰é»˜è®¤é¡ºåºå¡«å…¥å‰é¢çš„èŠ±æ‹¬å·ï¼Œå¹¶æŠŠé•¿åº¦æ§åˆ¶ä¸º2ä¸ªå­—ç¬¦ä¸”å·¦å¯¹é½ã€‚</p>
<p><code>format()</code>çš„ç”¨æ³•å¾ˆå¤šã€‚</p>
<p>å¯ä»¥æ¥å—ä¸é™ä¸ªæ•°å’Œé¡ºåºçš„å‚æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt;<span class="string">"&#123;&#125; &#123;&#125;"</span>.format(<span class="string">"hello"</span>, <span class="string">"world"</span>)    <span class="comment"># ä¸è®¾ç½®æŒ‡å®šä½ç½®ï¼ŒæŒ‰é»˜è®¤é¡ºåº</span></span><br><span class="line"><span class="string">'hello world'</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;0&#125; &#123;1&#125;"</span>.format(<span class="string">"hello"</span>, <span class="string">"world"</span>)  <span class="comment"># è®¾ç½®æŒ‡å®šä½ç½®</span></span><br><span class="line"><span class="string">'hello world'</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;1&#125; &#123;0&#125; &#123;1&#125;"</span>.format(<span class="string">"hello"</span>, <span class="string">"world"</span>)  <span class="comment"># è®¾ç½®æŒ‡å®šä½ç½®</span></span><br><span class="line"><span class="string">'world hello world'</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥æŒ‡æ˜å‚æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">print(<span class="string">"ç½‘ç«™åï¼š&#123;name&#125;, åœ°å€ &#123;url&#125;"</span>.format(name=<span class="string">"èœé¸Ÿæ•™ç¨‹"</span>, url=<span class="string">"www.runoob.com"</span>))</span><br><span class="line"> </span><br><span class="line"><span class="comment"># é€šè¿‡å­—å…¸è®¾ç½®å‚æ•°</span></span><br><span class="line">site = &#123;<span class="string">"name"</span>: <span class="string">"èœé¸Ÿæ•™ç¨‹"</span>, <span class="string">"url"</span>: <span class="string">"www.runoob.com"</span>&#125;</span><br><span class="line">print(<span class="string">"ç½‘ç«™åï¼š&#123;name&#125;, åœ°å€ &#123;url&#125;"</span>.format(**site))</span><br><span class="line"> </span><br><span class="line"><span class="comment"># é€šè¿‡åˆ—è¡¨ç´¢å¼•è®¾ç½®å‚æ•°</span></span><br><span class="line">my_list = [<span class="string">'èœé¸Ÿæ•™ç¨‹'</span>, <span class="string">'www.runoob.com'</span>]</span><br><span class="line">print(<span class="string">"ç½‘ç«™åï¼š&#123;0[0]&#125;, åœ°å€ &#123;0[1]&#125;"</span>.format(my_list))  <span class="comment"># "0" æ˜¯å¿…é¡»çš„</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘<code>format</code>ä¼ å…¥å¯¹è±¡ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AssignValue</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        self.value = value</span><br><span class="line">my_value = AssignValue(<span class="number">6</span>)</span><br><span class="line">print(<span class="string">'value ä¸º: &#123;0.value&#125;'</span>.format(my_value))  <span class="comment"># "0" æ˜¯å¯é€‰çš„</span></span><br></pre></td></tr></table></figure>

<p>æ•°å­—æ ¼å¼åŒ–è¾“å‡ºçš„å®Œæ•´å½¢å¼å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>æ•°å­—</th>
<th>æ ¼å¼</th>
<th>è¾“å‡º</th>
<th>è§£é‡Š</th>
</tr>
</thead>
<tbody><tr>
<td>3.1415926</td>
<td>{:.2f}</td>
<td>3.14</td>
<td>ä¿ç•™å°æ•°ç‚¹åä¸¤ä½</td>
</tr>
<tr>
<td>3.1415926</td>
<td>{:+.2f}</td>
<td>+3.14</td>
<td>å¸¦ç¬¦å·ä¿ç•™å°æ•°ç‚¹åä¸¤ä½</td>
</tr>
<tr>
<td>-1</td>
<td>{:+.2f}</td>
<td>-1.00</td>
<td>å¸¦ç¬¦å·ä¿ç•™å°æ•°ç‚¹åä¸¤ä½</td>
</tr>
<tr>
<td>2.71828</td>
<td>{:.0f}</td>
<td>3</td>
<td>ä¸å¸¦å°æ•°</td>
</tr>
<tr>
<td>5</td>
<td>{:0&gt;2d}</td>
<td>05</td>
<td>æ•°å­—è¡¥é›¶ (å¡«å……å·¦è¾¹, å®½åº¦ä¸º2)</td>
</tr>
<tr>
<td>5</td>
<td>{:x&lt;4d}</td>
<td>5xxx</td>
<td>æ•°å­—è¡¥x (å¡«å……å³è¾¹, å®½åº¦ä¸º4)</td>
</tr>
<tr>
<td>10</td>
<td>{:x&lt;4d}</td>
<td>10xx</td>
<td>æ•°å­—è¡¥x (å¡«å……å³è¾¹, å®½åº¦ä¸º4)</td>
</tr>
<tr>
<td>1000000</td>
<td>{:,}</td>
<td>1,000,000</td>
<td>ä»¥é€—å·åˆ†éš”çš„æ•°å­—æ ¼å¼</td>
</tr>
<tr>
<td>0.25</td>
<td>{:.2%}</td>
<td>25.00%</td>
<td>ç™¾åˆ†æ¯”æ ¼å¼</td>
</tr>
<tr>
<td>1000000000</td>
<td>{:.2e}</td>
<td>1.00e+09</td>
<td>æŒ‡æ•°è®°æ³•</td>
</tr>
<tr>
<td>13</td>
<td>{:&gt;10d}</td>
<td>13</td>
<td>å³å¯¹é½ (é»˜è®¤, å®½åº¦ä¸º10)</td>
</tr>
<tr>
<td>13</td>
<td>{:&lt;10d}</td>
<td>13</td>
<td>å·¦å¯¹é½ (å®½åº¦ä¸º10)</td>
</tr>
<tr>
<td>13</td>
<td>{:^10d}</td>
<td>13</td>
<td>ä¸­é—´å¯¹é½ (å®½åº¦ä¸º10)</td>
</tr>
</tbody></table>
<p><code>^</code>,<code>&lt;</code>, <code>&gt;</code> åˆ†åˆ«æ˜¯å±…ä¸­ã€å·¦å¯¹é½ã€å³å¯¹é½ï¼Œåé¢å¸¦å®½åº¦ï¼Œ <code>:</code> å·åé¢å¸¦å¡«å……çš„å­—ç¬¦ï¼Œåªèƒ½æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Œä¸æŒ‡å®šåˆ™é»˜è®¤æ˜¯ç”¨ç©ºæ ¼å¡«å……ã€‚<code>+</code> è¡¨ç¤ºåœ¨æ­£æ•°å‰æ˜¾ç¤º <code>+</code>ï¼Œè´Ÿæ•°å‰æ˜¾ç¤º <code>-</code>ï¼› ï¼ˆç©ºæ ¼ï¼‰è¡¨ç¤ºåœ¨æ­£æ•°å‰åŠ ç©ºæ ¼ã€‚</p>
<p>æ­¤å¤–ï¼Œè¿˜å¯ä»¥è½¬è¿›åˆ¶è¾“å‡ºï¼Œ<code>b</code>ã€<code>d</code>ã€<code>o</code>ã€<code>x</code> åˆ†åˆ«æ˜¯äºŒè¿›åˆ¶ã€åè¿›åˆ¶ã€å…«è¿›åˆ¶ã€åå…­è¿›åˆ¶ã€‚</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">'&#123;:b&#125;'.format(11) --&gt; 1011</span><br><span class="line">'&#123;:d&#125;'.format(11) --&gt; 11</span><br><span class="line">'&#123;:o&#125;'.format(11) --&gt; 13</span><br><span class="line">'&#123;:x&#125;'.format(11) --&gt; b</span><br><span class="line">'&#123;:#x&#125;'.format(11) --&gt; 0xb</span><br><span class="line">'&#123;:#X&#125;'.format(11) --&gt; 0XB</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>ç¼–å†™ç¨‹åºï¼Œæ±‚è§£æ‰€æœ‰ç”±ä¸¤ä¸ªå››ä½æ•°ç»„æˆçš„äº²å’Œæ•°ã€‚ï¼ˆå¦‚æœä¸¤ä¸ªæ­£æ•´æ•°aå’Œbæ»¡è¶³ï¼šaçš„æ‰€æœ‰çœŸå› æ•°ï¼ˆé™¤æœ¬èº«ä»¥å¤–çš„å› æ•°ï¼‰ä¹‹å’Œç­‰äºbï¼ŒåŒæ—¶bçš„æ‰€æœ‰çœŸå› æ•°ä¹‹å’Œç­‰äºaï¼Œåˆ™ç§°aï¼Œbæ˜¯ä¸€å¯¹äº²å’Œæ•° ã€‚ï¼‰</li>
</ol>
<p>æ€è·¯æ˜¯å…ˆå†™ä¸€ä¸ªç®—çœŸå› æ•°ä¹‹å’Œçš„å‡½æ•°ï¼Œæ¥ç€å†™ä¸¤å±‚å¾ªç¯ï¼Œç¬¬ä¸€å±‚<code>a</code>æ˜¯1000åˆ°9999ï¼Œç¬¬äºŒå±‚<code>b</code>æ˜¯1000åˆ°<code>a</code>ï¼Œç„¶åè°ƒç”¨å‡½æ•°åˆ¤æ–­<code>a</code>å’Œ<code>b</code>çš„çœŸå› æ•°ä¹‹å’Œæ˜¯å¦ç¬¦åˆæ¡ä»¶ã€‚ä¸€ä¸ªæ•´æ•°<code>n</code>çš„çœŸå› æ•°ä¹‹å’Œæ˜¯å¾ˆå¥½è®¡ç®—çš„ï¼Œåªéœ€è¦éå†1åˆ°<code>n//2+1</code>çœ‹æ˜¯å¦æ•´é™¤<code>n</code>ï¼Œç„¶åæŠŠæ•´é™¤çš„ç´¯åŠ ä¸€ä¸‹ï¼Œå°±å¯ä»¥äº†ã€‚</p>
<p>ä½†æ˜¯å®é™…è¿è¡Œçš„æ—¶å€™ï¼Œå‘ç°è¿™æ ·æçœŸçš„å¾ˆæ…¢ï¼Œè¦ç­‰å¥½ä¹…æ‰ä¼šå‡ºç»“æœï¼Œè¿™æ˜¯å› ä¸ºä¸¤å±‚<code>for</code>å¾ªç¯ï¼Œæ¯æ¬¡éƒ½è¦ç®—ä¸¤ä¸ªçœŸå› æ•°çš„å’Œï¼Œè€Œè¿™ä¹Ÿæ˜¯ä¸€å±‚å¾ªç¯ï¼Œå†åŠ ä¸Š<code>python</code>æœ¬èº«å°±æ•ˆç‡å¾ˆä½ï¼Œé€Ÿåº¦å°±æ ¼å¤–æ…¢äº†ï¼Œå› æ­¤æœ€å¥½çš„åŠæ³•æ˜¯èƒ½å»æ‰ä¸€å±‚å¾ªç¯ï¼Œæˆ–è€…æœ‰ä»€ä¹ˆåº“å¯ä»¥é£å¿«åœ°è®¡ç®—çœŸå› æ•°ä¹‹å’Œã€‚</p>
<p>ç„¶ååœ¨æŸ¥èµ„æ–™çš„è¿‡ç¨‹ä¸­ï¼Œçœ‹åˆ°äº†å¦ä¸€ç§äº²å’Œæ•°çš„å®šä¹‰ï¼šå…ˆæ±‚å‡ºæ•°å­—<code>n</code>æ‰€æœ‰çœŸå› æ•°ä¹‹å’Œ<code>a</code>ï¼Œç„¶åå†æ±‚å‡ºæ•°å­—<code>a</code>æ‰€æœ‰çœŸå› æ•°ä¹‹å’Œ<code>b</code>ã€‚å¦‚æœ<code>a!= b</code> ä¸”<code>n==b</code>ï¼Œåˆ™<code>a</code>ã€<code>b</code>ã€<code>n</code>éƒ½æ˜¯äº²å’Œæ•°ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥åªå†™ä¸€å±‚å¾ªç¯<code>a</code>ï¼Œè®¡ç®—<code>a</code>çš„çœŸå› æ•°ä¹‹å’Œ<code>b</code>ï¼Œå†è®¡ç®—<code>b</code>çš„çœŸå› æ•°ä¹‹å’Œ<code>sum_b</code>ï¼Œå¦‚æœ<code>a=sum_b</code>ï¼Œåˆ™ç¬¦åˆæ¡ä»¶è¾“å‡ºä¸€ä¸‹ï¼Œåä¹‹å°±ç›´æ¥ç»§ç»­ä¸‹ä¸€æ¬¡å¾ªç¯ï¼Œç®—çœŸå› æ•°ä¹‹å’Œçš„éƒ¨åˆ†æ²¡æœ‰å˜åŒ–ã€‚è¿™æ ·å¾ªç¯å°‘äº†ä¸€å±‚ï¼Œè¿ç®—é€Ÿåº¦å¿«äº†å¥½å¤šã€‚</p>
<p>æ­¤å¤–ï¼Œçœ‹åˆ°ä¸€ä¸ªä¸æ˜¯ç”¨å–ä½™ï¼Œè€Œæ˜¯ç”¨é™¤æ³•å’Œæ•´é™¤ç»“æœæ¥åˆ¤æ–­æ˜¯å¦æ˜¯å› æ•°çš„ä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">d</span><span class="params">(n)</span>:</span>  <span class="comment">#è®¡ç®—æ•°å­—næ‰€æœ‰çœŸå› æ•°ä¹‹å’Œ</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n//<span class="number">2</span>+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> n/i == float(n//i):</span><br><span class="line">            res += i</span><br><span class="line">    <span class="keyword">return</span>(res)</span><br></pre></td></tr></table></figure>

<p>çŒœæµ‹<code>python</code>ä¸­çš„é™¤æ³•ã€æ•´é™¤ã€å–ä½™å¯èƒ½æœ‰è¿ç®—æ—¶é—´çš„å·®åˆ«ï¼Œä¸è¿‡åº”è¯¥ä¸å¤§ã€‚</p>
<p>æœ€åä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è®¡ç®—ä¸€ä¸ªæ•°çš„çœŸå› æ•°å’Œ</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum_of_factor</span><span class="params">(n)</span>:</span></span><br><span class="line">    sum = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n // <span class="number">2</span> + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> n % i == <span class="number">0</span>:</span><br><span class="line">            sum += i</span><br><span class="line">    <span class="keyword">return</span> sum</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> range(<span class="number">1000</span>, <span class="number">9999</span>):</span><br><span class="line">    b = sum_of_factor(a)</span><br><span class="line">    <span class="keyword">if</span> b &lt;= a:</span><br><span class="line">        sum_b = sum_of_factor(b)</span><br><span class="line">        <span class="keyword">if</span> sum_b == a:</span><br><span class="line">            print(a, b)</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>è¯¾ç¨‹ç¬”è®°</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>Let&#39;s Build A Simple Interpreterç¬”è®°[4]</title>
    <url>/2020/02/28/Let-s-Build-A-Simple-Interpreter%E7%AC%94%E8%AE%B0-4/</url>
    <content><![CDATA[<h2 id="è¯¾ç¨‹æ–‡æ¡£"><a href="#è¯¾ç¨‹æ–‡æ¡£" class="headerlink" title="è¯¾ç¨‹æ–‡æ¡£"></a>è¯¾ç¨‹æ–‡æ¡£</h2><p><a href="https://ruslanspivak.com/lsbasi-part4/" target="_blank" rel="noopener">åŸæ–‡</a></p>
<p><a href="https://feng-qi.github.io/2018/01/28/lets-build-a-simple-interpreter-part-04/" target="_blank" rel="noopener">ç¿»è¯‘</a></p>
<p>(è¿™ä¸ªç¿»è¯‘é‡Œæœ‰ä¸ªåˆ«åœ°æ–¹ç¿»è¯‘é”™äº†â€¦â€¦)</p>
<a id="more"></a>

<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Token types</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># EOF (end-of-file) token is used to indicate that</span></span><br><span class="line"><span class="comment"># there is no more input left for lexical analysis</span></span><br><span class="line">INTEGER, MUL, DIV, EOF = <span class="string">'INTEGER'</span>, <span class="string">'MUL'</span>, <span class="string">'DIV'</span>, <span class="string">'EOF'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Token</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, type, value)</span>:</span></span><br><span class="line">        <span class="comment"># token type: INTEGER, MUL, DIV, or EOF</span></span><br><span class="line">        self.type = type</span><br><span class="line">        <span class="comment"># token value: non-negative integer value, '*', '/', or None</span></span><br><span class="line">        self.value = value</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""String representation of the class instance.</span></span><br><span class="line"><span class="string">        Examples:</span></span><br><span class="line"><span class="string">            Token(INTEGER, 3)</span></span><br><span class="line"><span class="string">            Token(MUL, '*')</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'Token(&#123;type&#125;, &#123;value&#125;)'</span>.format(</span><br><span class="line">            type=self.type,</span><br><span class="line">            value=repr(self.value)</span><br><span class="line">        )</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.__str__()</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Lexer</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, text)</span>:</span></span><br><span class="line">        <span class="comment"># client string input, e.g. "3 * 5", "12 / 3 * 4", etc</span></span><br><span class="line">        self.text = text</span><br><span class="line">        <span class="comment"># self.pos is an index into self.text</span></span><br><span class="line">        self.pos = <span class="number">0</span></span><br><span class="line">        self.current_char = self.text[self.pos]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">error</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">'Invalid character'</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">advance</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Advance the `pos` pointer and set the `current_char` variable."""</span></span><br><span class="line">        self.pos += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> self.pos &gt; len(self.text) - <span class="number">1</span>:</span><br><span class="line">            self.current_char = <span class="literal">None</span>  <span class="comment"># Indicates end of input</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.current_char = self.text[self.pos]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">skip_whitespace</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">while</span> self.current_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> self.current_char.isspace():</span><br><span class="line">            self.advance()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">integer</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Return a (multidigit) integer consumed from the input."""</span></span><br><span class="line">        result = <span class="string">''</span></span><br><span class="line">        <span class="keyword">while</span> self.current_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> self.current_char.isdigit():</span><br><span class="line">            result += self.current_char</span><br><span class="line">            self.advance()</span><br><span class="line">        <span class="keyword">return</span> int(result)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_next_token</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Lexical analyzer (also known as scanner or tokenizer)</span></span><br><span class="line"><span class="string">        This method is responsible for breaking a sentence</span></span><br><span class="line"><span class="string">        apart into tokens. One token at a time.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">while</span> self.current_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">if</span> self.current_char.isspace():</span><br><span class="line">                self.skip_whitespace()</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> self.current_char.isdigit():</span><br><span class="line">                <span class="keyword">return</span> Token(INTEGER, self.integer())</span><br><span class="line">            <span class="keyword">if</span> self.current_char == <span class="string">'*'</span>:</span><br><span class="line">                self.advance()</span><br><span class="line">                <span class="keyword">return</span> Token(MUL, <span class="string">'*'</span>)</span><br><span class="line">            <span class="keyword">if</span> self.current_char == <span class="string">'/'</span>:</span><br><span class="line">                self.advance()</span><br><span class="line">                <span class="keyword">return</span> Token(DIV, <span class="string">'/'</span>)</span><br><span class="line">            self.error()</span><br><span class="line">        <span class="keyword">return</span> Token(EOF, <span class="literal">None</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Interpreter</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, lexer)</span>:</span></span><br><span class="line">        self.lexer = lexer</span><br><span class="line">        <span class="comment"># set current token to the first token taken from the input</span></span><br><span class="line">        self.current_token = self.lexer.get_next_token()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">error</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">'Invalid syntax'</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">eat</span><span class="params">(self, token_type)</span>:</span></span><br><span class="line">        <span class="comment"># compare the current token type with the passed token</span></span><br><span class="line">        <span class="comment"># type and if they match then "eat" the current token</span></span><br><span class="line">        <span class="comment"># and assign the next token to the self.current_token,</span></span><br><span class="line">        <span class="comment"># otherwise raise an exception.</span></span><br><span class="line">        <span class="keyword">if</span> self.current_token.type == token_type:</span><br><span class="line">            self.current_token = self.lexer.get_next_token()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.error()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">factor</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Return an INTEGER token value.</span></span><br><span class="line"><span class="string">        factor : INTEGER</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        token = self.current_token</span><br><span class="line">        self.eat(INTEGER)</span><br><span class="line">        <span class="keyword">return</span> token.value</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">expr</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Arithmetic expression parser / interpreter.</span></span><br><span class="line"><span class="string">        expr   : factor ((MUL | DIV) factor)*</span></span><br><span class="line"><span class="string">        factor : INTEGER</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        result = self.factor()</span><br><span class="line">        <span class="keyword">while</span> self.current_token.type <span class="keyword">in</span> (MUL, DIV):</span><br><span class="line">            token = self.current_token</span><br><span class="line">            <span class="keyword">if</span> token.type == MUL:</span><br><span class="line">                self.eat(MUL)</span><br><span class="line">                result = result * self.factor()</span><br><span class="line">            <span class="keyword">elif</span> token.type == DIV:</span><br><span class="line">                self.eat(DIV)</span><br><span class="line">                result = result // self.factor()</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            text = input(<span class="string">'calc&gt; '</span>)</span><br><span class="line">        <span class="keyword">except</span> EOFError:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> text:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        lexer = Lexer(text)</span><br><span class="line">        interpreter = Interpreter(lexer)</span><br><span class="line">        result = interpreter.expr()</span><br><span class="line">        print(result)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="ç¬”è®°"><a href="#ç¬”è®°" class="headerlink" title="ç¬”è®°"></a>ç¬”è®°</h2><h4 id="æ­£åˆ™è¡¨è¾¾"><a href="#æ­£åˆ™è¡¨è¾¾" class="headerlink" title="æ­£åˆ™è¡¨è¾¾"></a>æ­£åˆ™è¡¨è¾¾</h4><p>è™½ç„¶è¯¾ç¨‹å†…å®¹é‡Œæ²¡æœ‰è¿‡å¤šæ¶‰åŠè¿™éƒ¨åˆ†ï¼Œä½†è¿˜æ˜¯å¤ä¹ ä¸€ä¸‹ã€‚ä»<a href="https://www.runoob.com/regexp/regexp-syntax.html" target="_blank" rel="noopener">è¿™é‡Œ</a>å¤åˆ¶çš„</p>
<h5 id="éæ‰“å°å­—ç¬¦"><a href="#éæ‰“å°å­—ç¬¦" class="headerlink" title="éæ‰“å°å­—ç¬¦"></a>éæ‰“å°å­—ç¬¦</h5><p>æŒ‡ä¸ä¼šæ˜¾ç¤ºåœ¨æ–‡æœ¬ä¸­çš„å­—ç¬¦ï¼Œä¸»è¦ç”¨äºæ§åˆ¶æ–‡æœ¬æ˜¾ç¤ºæ ¼å¼ï¼Œä¾‹å¦‚æ¢è¡Œã€åˆ†é¡µç­‰ã€‚</p>
<table>
<thead>
<tr>
<th>å­—ç¬¦</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>\cx</td>
<td>åŒ¹é…ç”±xæŒ‡æ˜çš„æ§åˆ¶å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ \cM åŒ¹é…ä¸€ä¸ª Control-M æˆ–å›è½¦ç¬¦ã€‚x çš„å€¼å¿…é¡»ä¸º A-Z æˆ– a-z ä¹‹ä¸€ã€‚å¦åˆ™ï¼Œå°† c è§†ä¸ºä¸€ä¸ªåŸä¹‰çš„ â€˜câ€™ å­—ç¬¦ã€‚</td>
</tr>
<tr>
<td>\f</td>
<td>åŒ¹é…ä¸€ä¸ªæ¢é¡µç¬¦ã€‚ç­‰ä»·äº \x0c å’Œ \cLã€‚</td>
</tr>
<tr>
<td>\n</td>
<td>åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚ç­‰ä»·äº \x0a å’Œ \cJã€‚</td>
</tr>
<tr>
<td>\r</td>
<td>åŒ¹é…ä¸€ä¸ªå›è½¦ç¬¦ã€‚ç­‰ä»·äº \x0d å’Œ \cMã€‚</td>
</tr>
<tr>
<td>\s</td>
<td>åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ã€‚ç­‰ä»·äº [ \f\n\r\t\v]ã€‚æ³¨æ„ Unicode æ­£åˆ™è¡¨è¾¾å¼ä¼šåŒ¹é…å…¨è§’ç©ºæ ¼ç¬¦ã€‚</td>
</tr>
<tr>
<td>\S</td>
<td>åŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦ã€‚ç­‰ä»·äº [^ \f\n\r\t\v]ã€‚</td>
</tr>
<tr>
<td>\t</td>
<td>åŒ¹é…ä¸€ä¸ªåˆ¶è¡¨ç¬¦ã€‚ç­‰ä»·äº \x09 å’Œ \cIã€‚</td>
</tr>
<tr>
<td>\v</td>
<td>åŒ¹é…ä¸€ä¸ªå‚ç›´åˆ¶è¡¨ç¬¦ã€‚ç­‰ä»·äº \x0b å’Œ \cKã€‚</td>
</tr>
</tbody></table>
<h5 id="ç‰¹æ®Šå­—ç¬¦"><a href="#ç‰¹æ®Šå­—ç¬¦" class="headerlink" title="ç‰¹æ®Šå­—ç¬¦"></a>ç‰¹æ®Šå­—ç¬¦</h5><p>æŒ‡æ­£åˆ™åŒ¹é…è§„åˆ™ä¸­æ¯”è¾ƒç‰¹æ®Šçš„ä¸€äº›æ ‡è®°ã€‚</p>
<table>
<thead>
<tr>
<th>å­—ç¬¦</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>$</td>
<td>åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“å°¾ä½ç½®ã€‚å¦‚æœè®¾ç½®äº† RegExp å¯¹è±¡çš„ Multiline å±æ€§ï¼Œåˆ™ $ ä¹ŸåŒ¹é… â€˜\nâ€™ æˆ– â€˜\râ€™ã€‚</td>
</tr>
<tr>
<td>( )</td>
<td>æ ‡è®°ä¸€ä¸ªå­è¡¨è¾¾å¼çš„å¼€å§‹å’Œç»“æŸä½ç½®ã€‚å­è¡¨è¾¾å¼å¯ä»¥è·å–ä¾›ä»¥åä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td>.</td>
<td>åŒ¹é…é™¤æ¢è¡Œç¬¦ \n ä¹‹å¤–çš„ä»»ä½•å•å­—ç¬¦ã€‚</td>
</tr>
<tr>
<td>[</td>
<td>æ ‡è®°ä¸€ä¸ªä¸­æ‹¬å·è¡¨è¾¾å¼çš„å¼€å§‹ã€‚</td>
</tr>
<tr>
<td>\</td>
<td>å°†ä¸‹ä¸€ä¸ªå­—ç¬¦æ ‡è®°ä¸ºæˆ–ç‰¹æ®Šå­—ç¬¦ã€æˆ–åŸä¹‰å­—ç¬¦ã€æˆ–å‘åå¼•ç”¨ã€æˆ–å…«è¿›åˆ¶è½¬ä¹‰ç¬¦ã€‚</td>
</tr>
<tr>
<td>^</td>
<td>åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ï¼Œé™¤éåœ¨æ–¹æ‹¬å·è¡¨è¾¾å¼ä¸­ä½¿ç”¨ï¼Œå½“è¯¥ç¬¦å·åœ¨æ–¹æ‹¬å·è¡¨è¾¾å¼ä¸­ä½¿ç”¨æ—¶ï¼Œè¡¨ç¤ºä¸æ¥å—è¯¥æ–¹æ‹¬å·è¡¨è¾¾å¼ä¸­çš„å­—ç¬¦é›†åˆã€‚</td>
</tr>
<tr>
<td>{</td>
<td>æ ‡è®°é™å®šç¬¦è¡¨è¾¾å¼çš„å¼€å§‹ã€‚</td>
</tr>
<tr>
<td>|</td>
<td>æŒ‡æ˜ä¸¤é¡¹ä¹‹é—´çš„ä¸€ä¸ªé€‰æ‹©ã€‚</td>
</tr>
</tbody></table>
<h5 id="é™å®šç¬¦"><a href="#é™å®šç¬¦" class="headerlink" title="é™å®šç¬¦"></a>é™å®šç¬¦</h5><p>æŒ‡é™å®šè¡¨è¾¾å¼åŒ¹é…æ¬¡æ•°çš„ç¬¦å·ã€‚</p>
<table>
<thead>
<tr>
<th>å­—ç¬¦</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>*</td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä»»æ„æ¬¡ï¼Œå¯ä»¥æ˜¯é›¶æ¬¡ã€‚ä¾‹å¦‚ï¼Œzo* èƒ½åŒ¹é… â€œzâ€ ä»¥åŠ â€œzooâ€ã€‚* ç­‰ä»·äº{0,}ã€‚</td>
</tr>
<tr>
<td>+</td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€™zo+â€™ èƒ½åŒ¹é… â€œzoâ€ ä»¥åŠ â€œzooâ€ï¼Œä½†ä¸èƒ½åŒ¹é… â€œzâ€ã€‚+ ç­‰ä»·äº {1,}ã€‚</td>
</tr>
<tr>
<td>?</td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€do(es)?â€ å¯ä»¥åŒ¹é… â€œdoâ€ ã€ â€œdoesâ€ ä¸­çš„ â€œdoesâ€ ã€ â€œdoxyâ€ ä¸­çš„ â€œdoâ€ ã€‚? ç­‰ä»·äº {0,1}ã€‚</td>
</tr>
<tr>
<td>{n}</td>
<td>n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚åŒ¹é…ç¡®å®šçš„ n æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€™o{2}â€™ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œä½†æ˜¯èƒ½åŒ¹é… â€œfoodâ€ ä¸­çš„ä¸¤ä¸ª oã€‚</td>
</tr>
<tr>
<td>{n,}</td>
<td>n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚è‡³å°‘åŒ¹é…n æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€™o{2,}â€™ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œä½†èƒ½åŒ¹é… â€œfooooodâ€ ä¸­çš„æ‰€æœ‰ oã€‚â€™o{1,}â€™ ç­‰ä»·äº â€˜o+â€™ã€‚â€™o{0,}â€™ åˆ™ç­‰ä»·äº â€˜o*â€™ã€‚</td>
</tr>
<tr>
<td>{n,m}</td>
<td>m å’Œ n å‡ä¸ºéè´Ÿæ•´æ•°ï¼Œå…¶ä¸­n &lt;= mã€‚æœ€å°‘åŒ¹é… n æ¬¡ä¸”æœ€å¤šåŒ¹é… m æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€o{1,3}â€ å°†åŒ¹é… â€œfoooooodâ€ ä¸­çš„å‰ä¸‰ä¸ª oã€‚â€™o{0,1}â€™ ç­‰ä»·äº â€˜o?â€™ã€‚è¯·æ³¨æ„åœ¨é€—å·å’Œä¸¤ä¸ªæ•°ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼ã€‚</td>
</tr>
</tbody></table>
<p>ä¾‹å¦‚ï¼š<code>/[1-9][0-9]*/</code>æ˜¯æŒ‡ç¬¬ä¸€ä½æ˜¯1-9çš„æŸä¸ªæ•°å­—ï¼Œåé¢æœ‰ä»»æ„å¤šä¸ª0-9çš„æ•°å­—ï¼Œä¹Ÿå°±æ˜¯æ­£æ•´æ•°ã€‚</p>
<h4 id="ä¸Šä¸‹æ–‡æ— å…³è¯­æ³•-BNF"><a href="#ä¸Šä¸‹æ–‡æ— å…³è¯­æ³•-BNF" class="headerlink" title="ä¸Šä¸‹æ–‡æ— å…³è¯­æ³•/BNF"></a>ä¸Šä¸‹æ–‡æ— å…³è¯­æ³•/BNF</h4><ol>
<li><p>ç”±ä¸€ç³»åˆ—è§„åˆ™ç»„æˆï¼Œè¢«ç§°ä¸ºäº§ç”Ÿå¼ï¼›</p>
</li>
<li><p>ä¸€æ¡è§„åˆ™ç”±ä¸€ä¸ªéç»ˆç»“ç¬¦(å«åš <strong>head</strong> æˆ– ç”Ÿæˆå¼çš„ <strong>å·¦è¾¹</strong>)ï¼Œä¸€ä¸ªåˆ†å·ï¼Œå’Œä¸€ç³»åˆ—ç»ˆç»“ ç¬¦å’Œ/æˆ–éç»ˆç»“ç¬¦(å«åš <strong>body</strong> æˆ– <strong>å³è¾¹</strong>)ç»„æˆï¼›</p>
</li>
<li><p>ç¬¬ä¸€æ¡è§„åˆ™å·¦è¾¹çš„éç»ˆç»“ç¬¦è¢«å«åš <strong>å¼€å§‹ç¬¦å·</strong>ï¼›</p>
</li>
<li><p>é€šè¿‡è¯­æ³•æ´¾ç”Ÿå‡ºç®—æœ¯è¡¨è¾¾å¼çš„æ–¹å¼ ä¸ºï¼šé¦–å…ˆä»å¼€å§‹ç¬¦å·å¼€å§‹ï¼Œç„¶ååå¤åœ°ä½¿ç”¨æ‰€åŒ…å«çš„éç»ˆç»“ç¬¦çš„è§„åˆ™æ›¿æ¢è¯¥ç»ˆç»“ç¬¦ï¼Œ ç›´åˆ°ç”Ÿæˆä¸€ä¸ªåªåŒ…å«ç»ˆç»“ç¬¦çš„å¥å­ã€‚è¯­æ³•èƒ½ç»„æˆçš„å¥å­æ„æˆäº†ä¸€é—¨è¯­è¨€ã€‚</p>
<p>ä¾‹å¦‚ï¼šä¸€ä¸ªåªæœ‰ä¹˜é™¤æ³•çš„è®¡ç®—è¡¨è¾¾å¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">expr   : factor ((MUL|DIV) factor)*</span><br><span class="line">factor : INTEGER</span><br></pre></td></tr></table></figure>

<p>æœ‰ä¸¤æ¡è§„åˆ™ï¼Œå…¶ä¸­ï¼Œ<code>expr</code>æ˜¯å¼€å§‹ç¬¦å·ï¼Œ<code>expr</code>å’Œ<code>factor</code>è¿™æ ·çš„å˜é‡æ˜¯éç»ˆç»“ç¬¦ï¼Œ<code>MUL</code>ã€<code>DIV</code>ã€<code>INTEGER</code>è¿™æ ·çš„<code>token</code>æ˜¯ç»ˆç»“ç¬¦ã€‚</p>
<p>è§£è¯»è¯¥è¯­æ³•ï¼š</p>
<ol>
<li><code>expr</code> æ˜¯ä¸€ä¸ª<code>factor</code>åé¢å¯é€‰åœ°è·Ÿä¸€ä¸ªä¹˜æˆ–é™¤è¿ç®—ç¬¦å†è·Ÿå¦ä¸€ä¸ª<code>factor</code>ï¼Œåé¢ä¹Ÿç›¸åº”å¯é€‰åœ°è·Ÿä¸€ä¸ªä¹˜æˆ–é™¤è¿ç®—ç¬¦å†è·Ÿå¦ä¸€ä¸ª<code>factor</code>ï¼Œå¦‚æ­¤é‡å¤ã€‚</li>
<li><code>factor</code>æ˜¯ä¸€ä¸ªæ•´æ•°ã€‚</li>
</ol>
</li>
</ol>
<h4 id="è¯­æ³•è½¬ä»£ç çš„è§„åˆ™"><a href="#è¯­æ³•è½¬ä»£ç çš„è§„åˆ™" class="headerlink" title="è¯­æ³•è½¬ä»£ç çš„è§„åˆ™"></a>è¯­æ³•è½¬ä»£ç çš„è§„åˆ™</h4><ol>
<li><p>å¯¹äºè¯­æ³•ä¸­å®šä¹‰çš„æ¯ä¸ªè§„åˆ™<code>R</code>ï¼Œå°†å®ƒåšæˆä¸€ä¸ªæœ‰ç›¸åŒåå­—çš„æ–¹æ³•ï¼Œå¯¹è¯¥è§„åˆ™çš„å¼•ç”¨å°±å˜æˆäº†ä¸€ä¸ªæ–¹æ³•è°ƒç”¨ï¼š<code>R()</code>ã€‚è¯¥æ–¹æ³•çš„æ–¹æ³•ä½“éµå¾ªè¯¥è§„åˆ™çš„æ­¥éª¤ï¼Œè¿‡ç¨‹ä¸­ä½¿ç”¨ç›¸åŒçš„å‡†åˆ™ã€‚</p>
</li>
<li><p>å¤šé€‰ä¸€ <code>(a1|a2|aN)</code> å˜æˆ <code>if-elif-else</code>è¯­å¥ã€‚</p>
</li>
<li><p>å¯é€‰ç»„ <code>(...)*</code> å˜æˆä¸€ä¸ªå¯ä»¥æ‰§è¡Œ 0 æˆ–å¤šæ¬¡çš„<code>while</code>å¾ªç¯ã€‚</p>
</li>
<li><p>æ¯ä¸ª<code>Token</code>æŒ‡é’ˆ<code>T</code>å˜æˆä¸€ä¸ª <code>eat</code> æ–¹æ³•è°ƒç”¨: <code>eat(T)</code>ã€‚<code>eat</code> æ–¹æ³•çš„å·¥ä½œæ˜¯ï¼šå½“å®ƒåŒ¹é…åˆ°å½“å‰çš„ <code>lookahead</code> å°±æ¶ˆè€—æ‰å®ƒï¼Œç„¶åä»<code>lexer</code>ä¸­å¾—åˆ°ä¸€ä¸ªæ–°<code>token</code>å¹¶å°†å®ƒèµ‹å€¼ç»™å†…éƒ¨å˜é‡ <code>current_token</code>ã€‚</p>
<p><img src="https://github.com/kun-bin/image/blob/master/lsbasi_part4_rules.png" alt="è¯­æ³•è½¬æ¢ä»£ç ç¤ºä¾‹"></p>
<p>ä»¥ä¸Šé¢çš„è¯­æ³•ä¸ºä¾‹ï¼š</p>
<ol>
<li><p><code>factor</code>åªæœ‰ä¸€ä¸ªç»ˆç»“ç¬¦ï¼Œæ‰€ä»¥ç›´æ¥<code>eat()</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factor</span><span class="params">(self)</span>:</span></span><br><span class="line">    self.eat(INTEGER)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>expr</code>è§„åˆ™ä½“å¼€å§‹çš„ <code>factor</code> å¼•ç”¨ å˜æˆäº†å¯¹ <code>factor()</code> æ–¹æ³•çš„è°ƒç”¨ã€‚å¯è¡Œç»„ <code>(...)*</code> å˜æˆäº†ä¸€ä¸ª <code>while</code> å¾ªç¯ï¼Œå¤šé€‰ä¸€ <code>(MUL|DIV)</code> å˜æˆäº†ä¸€ä¸ª <code>if-elif-else</code> è¯­å¥ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">expr</span><span class="params">(self)</span>:</span></span><br><span class="line">    self.factor()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> self.current_token.type <span class="keyword">in</span> (MUL, DIV):</span><br><span class="line">		token = self.current_token</span><br><span class="line">		<span class="keyword">if</span> token.type == MUL:</span><br><span class="line">	    	self.eat(MUL)</span><br><span class="line">	    	self.factor()</span><br><span class="line">		<span class="keyword">elif</span> token.type == DIV:</span><br><span class="line">	    	self.eat(DIV)</span><br><span class="line">	    	self.factor()</span><br></pre></td></tr></table></figure>

</li>
</ol>
</li>
</ol>
<p>ç°åœ¨çš„ä»£ç æ•´ä½“æ˜¯è¿™æ ·çš„ï¼šåˆ†ä¸ºä¸‰ä¸ª<code>class</code>ï¼Œç¬¬ä¸€ä¸ª<code>Token()</code>æ¥å®šä¹‰ç¬¦å·ç±»å‹ï¼Œç¬¬äºŒä¸ª<code>Lexer()</code>æ˜¯è¯æ³•åˆ†æå™¨ï¼Œç”¨æ¥æŠŠå­—ç¬¦ä¸²åˆ†å‰²æˆç¬¦åˆè¯æ³•è§„åˆ™çš„è¯æ³•å•å…ƒå¹¶è¿”å›ï¼Œæ¯”å¦‚è·³è¿‡ç©ºæ ¼ã€æŠŠè¿ç»­çš„æ•°å­—æ‹¼å‡‘æˆä¸€ä¸ªæ•´æ•°ç­‰ï¼Œç¬¬ä¸‰ä¸ª<code>Interpreter()</code>æ˜¯è¯­æ³•è§£é‡Šå™¨ï¼ŒæŒ‰é¡ºåºè¯»å…¥è¯æ³•å•å…ƒå¹¶æŒ‰è¯­æ³•è§„åˆ™å®Œæˆè¿ç®—ã€‚</p>
<h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><ol>
<li><p>å†™ä¸€ä¸ªè¯­æ³•æ¥æè¿°åŒ…å«ä»»æ„æ•°é‡çš„ <code>+</code>,<code>-</code>, <code>*</code>, æˆ–<code>/</code>æ“ä½œç¬¦çš„ç®—æœ¯è¡¨è¾¾å¼ã€‚è¿™ä¸ªè¯­æ³•éœ€è¦èƒ½å¤Ÿæ´¾ç”Ÿå‡ºåƒ  <code>2 + 7 * 4</code>, <code>7 - 8 / 4</code>, <code>14 + 2 * 3 - 6 / 2</code> ç­‰ç­‰è¿™æ ·çš„è¡¨è¾¾å¼ã€‚</p>
<p>è¿™é‡Œè¦è€ƒè™‘è¿ç®—ä¼˜å…ˆçº§çš„é—®é¢˜ï¼Œæ‰€ä»¥æŠŠä¹˜é™¤æ³•ä½œä¸ºä¸€ä¸ªå•å…ƒï¼ŒåŠ å‡æ³•ä½œä¸ºå¦ä¸€ä¸ªå•å…ƒï¼ŒåŠ å‡æ³•æ˜¯é«˜ä¸€çº§çš„ï¼Œè¿™æ ·ä¹˜é™¤æ³•ä¼šè¢«ä½œä¸ºä¸€ä¸ªæ•´ä½“æ¥ä¼˜å…ˆè¿ç®—ï¼Œè¯­æ³•è§„åˆ™å¦‚ä¸‹ï¼šï¼ˆå…¶å®è¿™é‡Œå·çœ‹äº†ä¸‹ä¸€ç« çš„ç­”æ¡ˆï¼‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">expr: term((ADD|MINUS)term)*</span><br><span class="line">term: factor((MUL|DIV)factor)*</span><br><span class="line">factor: INTEGER</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨è¿™ä¸ªè¯­æ³•ï¼Œå†™ä¸€ä¸ªå¯ä»¥å¯¹åŒ…å«ä»»æ„æ•°é‡çš„ <code>+</code>,<code>-</code>, <code>*</code>, æˆ–<code>/</code>æ“ä½œç¬¦çš„ç®—æœ¯è¡¨è¾¾å¼æ±‚å€¼çš„è§£é‡Šå™¨ã€‚ä½ ä»¬è§£é‡Šå™¨éœ€è¦èƒ½å¤Ÿå¤„ç†åƒ <code>2 + 7 * 4</code>, <code>7 - 8 / 4</code>, <code>14 + 2 * 3 - 6 / 2</code> ç­‰ç­‰è¿™æ ·çš„è¡¨è¾¾å¼ã€‚</p>
<p>é¦–å…ˆåœ¨æ·»åŠ åŠ æ³•å’Œå‡æ³•çš„ç¬¦å·å®šä¹‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åœ¨å¼€å¤´æ·»åŠ å®šä¹‰</span></span><br><span class="line">INTEGER, MUL, DIV, EOF, ADD, MINUS = <span class="string">'INTEGER'</span>, <span class="string">'MUL'</span>, <span class="string">'DIV'</span>, <span class="string">'EOF'</span>, <span class="string">'ADD'</span>, <span class="string">'MINUS'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨Lexer()çš„get_next_token()æ·»åŠ è¯æ³•åˆ¤æ–­</span></span><br><span class="line"><span class="keyword">if</span> self.current_char == <span class="string">'+'</span>:</span><br><span class="line">	self.advance()</span><br><span class="line">	<span class="keyword">return</span> Token(ADD, <span class="string">'+'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> self.current_char == <span class="string">'-'</span>:</span><br><span class="line">	self.advance()</span><br><span class="line">	<span class="keyword">return</span> Token(MINUS, <span class="string">'-'</span>)</span><br></pre></td></tr></table></figure>

<p>æ¥ç€æŠŠä¸Šä¸€é¢˜å†™çš„è¯­æ³•è§„åˆ™è½¬æˆä»£ç è¡¨è¾¾ï¼Œå’Œè¯¾ç¨‹å†…å®¹ç±»ä¼¼ï¼Œ<code>factor()</code>éƒ¨åˆ†ä¸å˜ï¼Œ<code>term()</code>éƒ¨åˆ†æ˜¯è¯¾ç¨‹ä¸­çš„<code>expr()</code>ï¼Œ<code>expr()</code>éƒ¨åˆ†å®é™…ä¸Šæ˜¯æŠŠä¹˜é™¤æ”¹æˆåŠ å‡çš„<code>term()</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factor</span><span class="params">(self)</span>:</span></span><br><span class="line">    self.eat(INTEGER)</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">term</span><span class="params">(self)</span>:</span></span><br><span class="line">    self.factor()</span><br><span class="line">    <span class="keyword">while</span> self.current_token.type <span class="keyword">in</span> (MUL, DIV):</span><br><span class="line">		token = self.current_token</span><br><span class="line">		<span class="keyword">if</span> token.type == MUL:</span><br><span class="line">	    	self.eat(MUL)</span><br><span class="line">	    	self.factor()</span><br><span class="line">		<span class="keyword">elif</span> token.type == DIV:</span><br><span class="line">	    	self.eat(DIV)</span><br><span class="line">	    	self.factor()</span><br><span class="line">	    	</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">expr</span><span class="params">(self)</span>:</span></span><br><span class="line">    self.term()</span><br><span class="line">    <span class="keyword">while</span> self.current_token.type <span class="keyword">in</span> (ADD, MINUS):</span><br><span class="line">		token = self.current_token</span><br><span class="line">		<span class="keyword">if</span> token.type == ADD:</span><br><span class="line">	    	self.eat(ADD)</span><br><span class="line">	    	self.term()</span><br><span class="line">		<span class="keyword">elif</span> token.type == MINUS:</span><br><span class="line">	    	self.eat(MINUS)</span><br><span class="line">	    	self.term()</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥å°±æ˜¯æŠŠè¯¾ç¨‹ç¤ºä¾‹ä»£ç ä¸­çš„<code>expr()</code>æ”¹æˆ<code>term()</code>ï¼Œç„¶åä»¿ç…§ç€å†™æ–°çš„<code>expr()</code>äº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ–°çš„expr()</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">expr</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="string">"""Arithmetic expression parser / interpreter.</span></span><br><span class="line"><span class="string">    expr   : term   ((ADD | MINUS) term)*</span></span><br><span class="line"><span class="string">    term   : factor ((MUL | DIV) factor)*</span></span><br><span class="line"><span class="string">    factor : INTEGER</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    result = self.term()</span><br><span class="line">    <span class="keyword">while</span> self.current_token.type <span class="keyword">in</span> (ADD, MINUS):</span><br><span class="line">        token = self.current_token</span><br><span class="line">        <span class="keyword">if</span> token.type == ADD:</span><br><span class="line">            self.eat(ADD)</span><br><span class="line">            result = result + self.term()</span><br><span class="line">        <span class="keyword">elif</span> token.type == MINUS:</span><br><span class="line">            self.eat(MINUS)</span><br><span class="line">            result = result - self.term()</span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>

<p>æ„Ÿå—æ˜¯è¯­æ³•è§„åˆ™å†™å‡ºæ¥ä»¥åä»£ç å°±å¾ˆå¥½å†™äº†ã€‚</p>
</li>
</ol>
<h2 id="æ£€æŸ¥ç†è§£"><a href="#æ£€æŸ¥ç†è§£" class="headerlink" title="æ£€æŸ¥ç†è§£"></a>æ£€æŸ¥ç†è§£</h2><ol>
<li><p>ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡æ— å…³è¯­æ³•ï¼ˆè¯­æ³•ï¼‰ï¼Ÿ</p>
<p>ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•ï¼ˆè‹±è¯­ï¼šcontext-free grammarï¼Œç¼©å†™ä¸ºCFGï¼‰ï¼Œåœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œè‹¥ä¸€ä¸ªå½¢å¼æ–‡æ³•<code>G = (N, Î£, P, S)</code> çš„äº§ç”Ÿå¼è§„åˆ™éƒ½å–å¦‚ä¸‹çš„å½¢å¼ï¼š<code>V-&gt;w</code>ï¼Œåˆ™è°“ä¹‹ã€‚å…¶ä¸­ <code>VâˆˆN, wâˆˆ(NâˆªÎ£)*</code> ã€‚ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•å–åä¸ºâ€œä¸Šä¸‹æ–‡æ— å…³â€çš„åŸå› å°±æ˜¯å› ä¸ºå­—ç¬¦ V æ€»å¯ä»¥è¢«å­—ä¸² w è‡ªç”±æ›¿æ¢ï¼Œè€Œæ— éœ€è€ƒè™‘å­—ç¬¦ V å‡ºç°çš„ä¸Šä¸‹æ–‡ã€‚ä¸€ä¸ªå½¢å¼è¯­è¨€æ˜¯ä¸Šä¸‹æ–‡æ— å…³çš„ï¼Œå¦‚æœå®ƒæ˜¯ç”±ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•ç”Ÿæˆçš„ã€‚</p>
<p>ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•é‡è¦çš„åŸå› åœ¨äºå®ƒä»¬æ‹¥æœ‰è¶³å¤Ÿå¼ºçš„è¡¨è¾¾åŠ›æ¥è¡¨ç¤ºå¤§å¤šæ•°ç¨‹åºè®¾è®¡è¯­è¨€çš„è¯­æ³•ï¼›å®é™…ä¸Šï¼Œå‡ ä¹æ‰€æœ‰ç¨‹åºè®¾è®¡è¯­è¨€éƒ½æ˜¯é€šè¿‡ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•æ¥å®šä¹‰çš„ã€‚å¦ä¸€æ–¹é¢ï¼Œä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•åˆè¶³å¤Ÿç®€å•ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥æ„é€ æœ‰æ•ˆçš„åˆ†æç®—æ³•æ¥æ£€éªŒä¸€ä¸ªç»™å®šå­—ä¸²æ˜¯å¦æ˜¯ç”±æŸä¸ªä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•äº§ç”Ÿçš„ã€‚ä¾‹å­å¯ä»¥å‚è§LR åˆ†æå™¨å’ŒLL åˆ†æå™¨ã€‚</p>
<p>BNFï¼ˆå·´å…‹æ–¯-è¯ºå°”èŒƒå¼ï¼‰ç»å¸¸ç”¨æ¥è¡¨è¾¾ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•ã€‚</p>
<p>ï¼ˆç™¾åº¦ç™¾ç§‘å¤åˆ¶çš„ï¼‰</p>
</li>
<li><p>è¿™ä¸ªè¯­æ³•æœ‰å‡ æ¡è§„åˆ™/ç”Ÿæˆå¼ï¼Ÿï¼ˆæŒ‡ä¾‹å­é‡Œçš„é‚£ä¸ªä¹˜é™¤æ³•çš„å›¾ï¼‰</p>
<p>2æ¡ã€‚</p>
</li>
<li><p>ä»€ä¹ˆæ˜¯ç»ˆç»“ç¬¦ï¼Ÿï¼ˆæŒ‡å‡ºå›¾ç‰‡ä¸­çš„æ‰€æœ‰ç»ˆç»“ç¬¦ï¼‰</p>
<p><code>INTEGER</code>è¿™ç§çš„</p>
</li>
<li><p>ä»€ä¹ˆæ˜¯éç»ˆç»“ç¬¦ï¼Ÿï¼ˆæŒ‡å‡ºå›¾ç‰‡ä¸­çš„æ‰€æœ‰éç»ˆç»“ç¬¦ï¼‰</p>
<p><code>expr</code>è¿™ç§çš„</p>
</li>
<li><p>ä»€ä¹ˆæ˜¯ä¸€æ¡è§„åˆ™çš„ headï¼Ÿï¼ˆæŒ‡å‡ºå›¾ç‰‡ä¸­æ‰€æœ‰çš„ head/å·¦è¾¹ï¼‰</p>
<p>æœ€å·¦è¾¹çš„</p>
</li>
<li><p>ä»€ä¹ˆæ˜¯ä¸€æ¡è§„åˆ™çš„ bodyï¼Ÿï¼ˆæŒ‡å‡ºå›¾ç‰‡ä¸­æ‰€æœ‰çš„ body/å³è¾¹ï¼‰</p>
<p>å³è¾¹çš„éƒ¨åˆ†</p>
</li>
<li><p>ä»€ä¹ˆæ˜¯ä¸€ä¸ªè¯­æ³•çš„å¼€å§‹ç¬¦å·ï¼Ÿ</p>
<p>æœ€ä¸€å¼€å§‹é‚£ä¸ª</p>
</li>
</ol>
<p>ï¼ˆ2.12å¼€å§‹å†™çš„æ–‡æ¡£ï¼Œ2.28æ‰å†™å®Œâ€¦â€¦ï¼‰</p>
]]></content>
      <categories>
        <category>Let&#39;s Build A Simple Interpreter</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>ç¼–è¯‘åŸç†</tag>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonè¯¾ç¨‹è®°å½•-1</title>
    <url>/2020/02/26/python%E8%AF%BE%E7%A8%8B%E8%AE%B0%E5%BD%95-1/</url>
    <content><![CDATA[<ol>
<li><p>ä¸ºäº†ç»™å˜é‡x, y, z èµ‹åˆå€¼5ï¼Œä¸‹é¢æ­£ç¡®çš„èµ‹å€¼è¯­å¥æ˜¯ï¼ˆï¼‰<br>A. xyz=5                    B. x=5 y=5 z=5<br>C. x=5, y=5, z=5        D. x=5;y=5;z=5<br>E. x=y=z=5                 F. x,y,z=5<br>G. x,y,z=5,5,5</p>
<p> [DEG]<br> æ²¡ä»€ä¹ˆè¯´çš„ï¼Œè¿è¡Œä¸€ä¸‹å°±çŸ¥é“å“ªä¸ªå¯¹å“ªä¸ªé”™äº†ã€‚</p>
</li>
<li><p>xæ˜¯ä¸€ä¸ªä¸¤ä½æ•°çš„æ•´æ•°ï¼Œç°å°†è¯¥ä¸¤ä½æ•°çš„ä¸ªä½å’Œåä½æ•°å­—äº¤æ¢ï¼Œä¾‹å¦‚13å˜æˆ31ï¼Œæ­£ç¡®çš„è¡¨è¾¾å¼æ˜¯ï¼ˆï¼‰<br>A. (x%10)*10+x/10           B. (x%10)//10+x/10<br>C. (x/10)%10+x//10          D. (x%10)*10+x//10</p>
<p> [D]<br> è¿™é‡Œè¦åŒºåˆ†â€œ/â€å’Œâ€œ//â€ï¼Œå‰è€…æ˜¯ä¸å–æ•´æ•°çš„é™¤æ³•ï¼Œåè€…æ˜¯å–æ•´ï¼Œä¾‹å¦‚7/3=2.333ï¼Œè€Œ7//3=2ã€‚</p>
</li>
</ol>
<a id="more"></a>

<p>è¯¾åç»ƒä¹ ï¼š</p>
<ol>
<li>ç¼–å†™ç¨‹åº1ï¼šæç¤ºè¾“å…¥å§“åå’Œå‡ºç”Ÿå¹´ä»½ï¼Œè¾“å‡ºå§“åå’Œå¹´é¾„ã€‚è¿è¡Œ ç»“æœå¦‚ï¼š<br>â€‹        è¯·è¾“å…¥ä½ çš„å§“åï¼š<strong><em>å¼ ä¸‰</em></strong><br>â€‹        ä½ å¥½ï¼Œå¼ ä¸‰<br>â€‹        è¯·è¾“å…¥ä½ çš„å‡ºç”Ÿå¹´ä»½ï¼š<strong><em>1999</em></strong><br>â€‹        ä½ å¥½ï¼Œå¼ ä¸‰ï¼Œä½ ä»Šå¹´19å²äº†ã€‚</li>
</ol>
<p>è¿™ä¸ªå¾ˆç®€å•äº†ï¼Œå°±æ˜¯æ™®é€šçš„è¾“å…¥è¾“å‡ºã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = input(<span class="string">"è¯·è¾“å…¥ä½ çš„å§“åï¼š"</span>)</span><br><span class="line">print(<span class="string">"ä½ å¥½ï¼Œ"</span>, name)</span><br><span class="line">age = input(<span class="string">"è¯·è¾“å…¥ä½ çš„å‡ºç”Ÿå¹´ä»½ï¼š"</span>)</span><br><span class="line">print(<span class="string">"ä½ å¥½ï¼Œ"</span>, name, <span class="string">"ä½ ä»Šå¹´"</span>, <span class="number">2020</span>-int(age), <span class="string">"å²äº†"</span>)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>ç¼–å†™ç¨‹åº2ï¼š ä¸‰è§’å½¢çš„ä¸‰æ¡è¾¹é•¿ä¸º3ã€7ã€9ï¼Œè®¡ç®—ä¸‰è§’å½¢çš„ä¸‰ä¸ªè§’ï¼ˆæç¤ºï¼šä½™å¼¦å®šç†ï¼‰</li>
</ol>
<p>è¿™ä¸ªä¹Ÿè¿˜æ˜¯å¾ˆç®€å•ï¼Œè™½ç„¶æˆ‘å¿˜äº†ä¸‰è§’å½¢çš„è¾¹è§’å…³ç³»å…¬å¼ï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œç™¾åº¦æœ‰ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line">a = <span class="number">3</span></span><br><span class="line">b = <span class="number">7</span></span><br><span class="line">c = <span class="number">9</span></span><br><span class="line">A = math.acos((math.pow(c, <span class="number">2</span>) + math.pow(b, <span class="number">2</span>) - math.pow(a, <span class="number">2</span>)) / (<span class="number">2</span> * b * c))</span><br><span class="line">B = math.acos((math.pow(c, <span class="number">2</span>) + math.pow(a, <span class="number">2</span>) - math.pow(b, <span class="number">2</span>)) / (<span class="number">2</span> * a * c))</span><br><span class="line">C = math.acos((math.pow(a, <span class="number">2</span>) + math.pow(b, <span class="number">2</span>) - math.pow(c, <span class="number">2</span>)) / (<span class="number">2</span> * b * a))</span><br><span class="line">print(<span class="string">"å¼§åº¦å€¼ï¼š"</span>, A, B, C)</span><br><span class="line">print(<span class="string">"è§’åº¦å€¼ï¼š"</span>, math.degrees(A), math.degrees(B), math.degrees(C))</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>ç¼–å†™ç¨‹åº3ï¼šå¯¹çŒœæ•°å­—æ¸¸æˆçš„ç¨‹åºè¿›è¡Œå¦‚ä¸‹ä¿®æ”¹ï¼š</p>
<ol>
<li>ç”±ç”¨æˆ·é”®ç›˜è¾“å…¥ç§˜å¯†æ•°çš„ä¸Šé™å’Œä¸‹é™ã€‚</li>
<li>ç°æœ‰çš„ç¨‹åºæ¯æ¬¡åªèƒ½ç©ä¸€å±€ï¼Œå¯¹æ­¤è¿›è¡Œä¿®æ”¹ï¼Œç©å®Œä¸€å±€åè‡ªåŠ¨è¿›å…¥ä¸‹ä¸€å±€ã€‚</li>
<li>é€€å‡ºæ¸¸æˆæ—¶æ‰“å°ç”¨æˆ·æ€»å…±ç©çš„å±€æ•°ï¼ˆæ²¡ç©å®Œçš„å±€ä¸ç®—ï¼‰ï¼Œå¦‚æœå±€æ•°ä¸ä¸º0ï¼Œåˆ™è¿˜éœ€æ‰“å°æ¯ä¸€å±€çš„çŒœæµ‹æ¬¡æ•°ã€‚</li>
</ol>
</li>
</ol>
<p>è¿™ä¸ªçœ‹èµ·æ¥å¤æ‚ï¼Œä½†å°±æ˜¯æ¡ä»¶è¯´çš„ä¸æ¸…æ¥šè€Œå·²ï¼Œæ€»çš„æ¥è¯´è¦æ±‚æ˜¯ç”¨æˆ·è¾“å…¥æ•°å­—çš„æ—¶å€™ç©çŒœæ•°å­—ï¼Œåä¹‹ç»“æŸæ¸¸æˆï¼Œç„¶åè¾“å‡ºä¸€ä¸‹ç»Ÿè®¡ç»“æœã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import random</span><br><span class="line">count &#x3D; 0</span><br><span class="line">number &#x3D; []</span><br><span class="line">a &#x3D; input(&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ä¸‹é™ï¼š&quot;)</span><br><span class="line">while a.isdigit():</span><br><span class="line">    b &#x3D; input(&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ä¸Šé™ï¼š&quot;)</span><br><span class="line">    secret &#x3D; random.randint(int(a), int(b))</span><br><span class="line">    print(&quot;æˆ‘æœ‰ä¸€ä¸ª&quot;, a, &quot;-&quot;, b, &quot;çš„ç§˜å¯†æ•°ï¼Œæƒ³è¦çŒœå‡ºå®ƒï¼Ÿè¯·æŒ‰æ•°å­—é”®å¹¶å›è½¦ï¼›å¦‚æœä¸æƒ³çŒœäº†ï¼Œå¯æŒ‰éæ•°å­—é”®å¹¶å›è½¦æˆ–ç›´æ¥å›è½¦ã€‚&quot;)</span><br><span class="line">    inputStr &#x3D; input(&quot;ä½ çŒœæ˜¯ï¼Ÿ&quot;)</span><br><span class="line">    number.append(0)</span><br><span class="line">    while inputStr.isdigit():</span><br><span class="line">        guess &#x3D; int(inputStr)</span><br><span class="line">        number[count] +&#x3D; 1</span><br><span class="line">        if guess &lt; secret:</span><br><span class="line">            print(&quot;å°äº†&quot;)</span><br><span class="line">        elif guess &gt; secret:</span><br><span class="line">            print(&quot;å¤§äº†&quot;)</span><br><span class="line">        else:</span><br><span class="line">            print(&quot;Bingo! ä½ çŒœå¯¹å•¦ï¼è¿™ä¸ªæ•°å°±æ˜¯&quot;, secret)</span><br><span class="line">            print(&quot;ç»§ç»­ç©ä¸‹ä¸€å±€ï¼&quot;)</span><br><span class="line">            count +&#x3D; 1</span><br><span class="line">            break</span><br><span class="line">        inputStr &#x3D; input(&quot;ä½ çŒœæ˜¯ï¼Ÿ&quot;)</span><br><span class="line">    a &#x3D; input(&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ä¸‹é™ï¼š&quot;)</span><br><span class="line">print(&quot;å†è§ï¼Œä¸‹æ¬¡ç©ï¼&quot;)</span><br><span class="line">print(&quot;ä½ ä¸€å…±ç©äº†&quot;, count, &quot;å±€&quot;)</span><br><span class="line">for i in range(0, count):</span><br><span class="line">    print(&quot;ç¬¬&quot;, i + 1, &quot;å±€çŒœæµ‹æ¬¡æ•°ä¸º&quot;, number[i])</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>è¯¾ç¨‹ç¬”è®°</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>Let&#39;s Build A Simple Interpreterç¬”è®°[3]</title>
    <url>/2020/02/01/Let-s-Build-A-Simple-Interpreter%E7%AC%94%E8%AE%B0-3/</url>
    <content><![CDATA[<h2 id="è¯¾ç¨‹æ–‡æ¡£"><a href="#è¯¾ç¨‹æ–‡æ¡£" class="headerlink" title="è¯¾ç¨‹æ–‡æ¡£"></a>è¯¾ç¨‹æ–‡æ¡£</h2><p><a href="https://ruslanspivak.com/lsbasi-part3/" target="_blank" rel="noopener">åŸæ–‡</a></p>
<p><a href="https://feng-qi.github.io/2018/01/26/lets-build-a-simple-interpreter-part-03/" target="_blank" rel="noopener">ç¿»è¯‘</a></p>
<a id="more"></a>

<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Token types</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># EOF (end-of-file) token is used to indicate that</span></span><br><span class="line"><span class="comment"># there is no more input left for lexical analysis</span></span><br><span class="line">INTEGER, PLUS, MINUS, EOF = <span class="string">'INTEGER'</span>, <span class="string">'PLUS'</span>, <span class="string">'MINUS'</span>, <span class="string">'EOF'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Token</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, type, value)</span>:</span></span><br><span class="line">        <span class="comment"># token type: INTEGER, PLUS, MINUX, or EOF</span></span><br><span class="line">        self.type = type</span><br><span class="line">        <span class="comment"># token value: non-negative integer value, '+', '-', or None</span></span><br><span class="line">        self.value = value</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""String representation of the class instance.</span></span><br><span class="line"><span class="string">        Examples:</span></span><br><span class="line"><span class="string">        Token(INTEGER, 3)</span></span><br><span class="line"><span class="string">        Token(PLUS, '+')</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">f'Token(<span class="subst">&#123;self.type&#125;</span>, <span class="subst">&#123;repr(self.value)&#125;</span>)'</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.__str__()</span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Interpreter</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, text)</span>:</span></span><br><span class="line">        <span class="comment"># client string input, e.g. "3 + 5", "12 - 5 + 3", etc</span></span><br><span class="line">        self.text = text</span><br><span class="line">        <span class="comment"># self.pos is an index into self.text</span></span><br><span class="line">        self.pos = <span class="number">0</span></span><br><span class="line">        <span class="comment"># current token instance</span></span><br><span class="line">        self.current_token = <span class="literal">None</span></span><br><span class="line">        self.current_char = self.text[self.pos]</span><br><span class="line">    <span class="comment">##########################################################</span></span><br><span class="line">    <span class="comment"># Lexer code                                             #</span></span><br><span class="line">    <span class="comment">##########################################################</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">error</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">'Invalid syntax'</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">advance</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Advance the 'pos' pointer and set the 'current_char' variable."""</span></span><br><span class="line">        self.pos += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> self.pos &gt;= len(self.text):</span><br><span class="line">            self.current_char = <span class="literal">None</span>  <span class="comment"># Indicates end of input</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.current_char = self.text[self.pos]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">skip_whitespace</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">while</span> self.current_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> self.current_char.isspace():</span><br><span class="line">            self.advance()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">integer</span><span class="params">(self)</span>:</span></span><br><span class="line">        value = <span class="string">''</span></span><br><span class="line">        <span class="keyword">while</span> self.current_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> self.current_char.isdigit():</span><br><span class="line">            value += self.current_char</span><br><span class="line">            self.advance()</span><br><span class="line">        <span class="keyword">return</span> int(value)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_next_token</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Lexical analyzer (also known as scanner or tokenizer)</span></span><br><span class="line"><span class="string">        This method is responsible for breaking a sentence</span></span><br><span class="line"><span class="string">        apart into tokens. One token at a time.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">while</span> self.current_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">if</span> self.current_char.isspace():</span><br><span class="line">                self.skip_whitespace()</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">elif</span> self.current_char.isdigit():</span><br><span class="line">                <span class="keyword">return</span> Token(INTEGER, self.integer())</span><br><span class="line">            <span class="keyword">elif</span> self.current_char == <span class="string">'+'</span>:</span><br><span class="line">                self.advance()</span><br><span class="line">                <span class="keyword">return</span> Token(PLUS, <span class="string">'+'</span>)</span><br><span class="line">            <span class="keyword">elif</span> self.current_char == <span class="string">'-'</span>:</span><br><span class="line">                self.advance()</span><br><span class="line">                <span class="keyword">return</span> Token(MINUS, <span class="string">'-'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.error()</span><br><span class="line">        <span class="keyword">return</span> Token(EOF, <span class="literal">None</span>)</span><br><span class="line">    <span class="comment">##########################################################</span></span><br><span class="line">    <span class="comment"># Parser / Interpreter code                              #</span></span><br><span class="line">    <span class="comment">##########################################################</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">eat</span><span class="params">(self, token_type)</span>:</span></span><br><span class="line">        <span class="comment"># compare the current token type with the passed token</span></span><br><span class="line">        <span class="comment"># type and if they match then "eat" the current token</span></span><br><span class="line">        <span class="comment"># and assign the next token to the self.current_token,</span></span><br><span class="line">        <span class="comment"># otherwise raise an exception.</span></span><br><span class="line">        <span class="keyword">if</span> self.current_token.type == token_type:</span><br><span class="line">            self.current_token = self.get_next_token()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.error()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">term</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Return an INTEGER token value."""</span></span><br><span class="line">        token = self.current_token</span><br><span class="line">        self.eat(INTEGER)</span><br><span class="line">        <span class="keyword">return</span> token.value</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">expr</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Arithmetic expression parser / interpreter."""</span></span><br><span class="line">        <span class="comment"># set current token to the first token taken from the input</span></span><br><span class="line">        self.current_token = self.get_next_token()</span><br><span class="line">        result = self.term()</span><br><span class="line">        <span class="keyword">while</span> self.current_token.type <span class="keyword">in</span> (PLUS, MINUS):</span><br><span class="line">            token = self.current_token</span><br><span class="line">            <span class="keyword">if</span> token.type == PLUS:</span><br><span class="line">                self.eat(PLUS)</span><br><span class="line">                result += self.term()</span><br><span class="line">            <span class="keyword">elif</span> token.type == MINUS:</span><br><span class="line">                self.eat(MINUS)</span><br><span class="line">                result -= self.term()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.error()</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            text = input(<span class="string">'calc&gt; '</span>)</span><br><span class="line">        <span class="keyword">except</span> EOFError:</span><br><span class="line">            print()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> text:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        interpreter = Interpreter(text)</span><br><span class="line">        result = interpreter.expr()</span><br><span class="line">        print(result)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="ç¬”è®°"><a href="#ç¬”è®°" class="headerlink" title="ç¬”è®°"></a>ç¬”è®°</h2><p>è¿™ä¸€è¯¾å®ç°äº†å¤šä¸ªæ•°å­—çš„åŠ å‡æ“ä½œï¼Œæ€è·¯å¤§è‡´å’Œæˆ‘æƒ³çš„å·®ä¸å¤šï¼Œä¸è¿‡å¾ªç¯æ¡ä»¶æ˜¯â€œå½“å‰å­—ç¬¦æ˜¯åŠ å·æˆ–å‡å·â€ã€‚</p>
<p>å¼•å…¥äº†å¥æ³•å›¾çš„ä½¿ç”¨å’Œå¥æ³•åˆ†æçš„æ¦‚å¿µã€‚</p>
<blockquote>
<p>parser åªæ˜¯è¯†åˆ«å‡ºç»“æ„å¹¶ä¿è¯å®ƒç¬¦åˆæŸäº›è§„èŒƒï¼Œinterpreter åœ¨ parser æˆåŠŸè¯†åˆ«åå¯¹è¡¨è¾¾å¼è¿›è¡Œæ±‚å€¼ã€‚</p>
</blockquote>
<h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><ol>
<li><p>ç”»ä¸€å¼ åªåŒ…å«ä¹˜é™¤æ³•çš„ç®—æœ¯è¡¨è¾¾å¼å¥æ³•å›¾ï¼Œä¾‹å¦‚â€œ7 * 4 / 2 * 3â€ã€‚ä¸å¼€ç©ç¬‘ï¼Œæ‹¿åªé’¢ç¬” æˆ–é“…ç¬”è¯•è¯•ã€‚</p>
<p>å’ŒåŠ å‡æ³•çš„å¥æ³•å›¾ä¸€æ ·ã€‚</p>
</li>
<li><p>ä¿®æ”¹è®¡ç®—å™¨çš„æºä»£ç ä½¿å®ƒè§£é‡ŠåªåŒ…å«ä¹˜é™¤æ³•çš„ç®—æœ¯è¡¨è¾¾å¼ï¼Œå¦‚â€œ7 * 4 / 2 * 3â€ã€‚</p>
<p>æŠŠä»£ç é‡Œçš„åŠ å‡æ¢æˆä¹˜é™¤å°±è¡Œã€‚</p>
</li>
<li><p>ä»å¤´å†™ä¸€ä¸ªå¯ä»¥å¤„ç†å¦‚â€œ7 - 3 + 2 - 1â€è¿™æ ·ç®—æœ¯è¡¨è¾¾å¼çš„è§£é‡Šå™¨ã€‚ä½¿ç”¨ä»»ä½•ä½ å–œæ¬¢çš„è¯­ è¨€éƒ½å¯ä»¥ï¼Œåªé è‡ªå·±ï¼Œä¸è¦å‚è€ƒä¾‹å­ã€‚åšè¿™ä»¶äº‹æ—¶ï¼Œæƒ³æƒ³éƒ½éœ€è¦åŒ…å«çš„ç»„ä»¶ï¼šlexer è·å– è¾“å…¥å¹¶æŠŠå®ƒè½¬åŒ–ä¸º token æµï¼Œparser ä» lexer æä¾›çš„ token æµä¸­è¯†åˆ«ç»“æ„ï¼Œ interpreter åœ¨ parser æˆåŠŸè¯†åˆ«åˆ°ä¸€ä¸ªåˆæ³•çš„ç®—æœ¯è¡¨è¾¾å¼ä¹‹åæ±‚å¾—å…¶ç»“æœã€‚æŠŠè¿™äº›è¿èµ· æ¥ã€‚èŠ±ç‚¹æ—¶é—´æŠŠä½ å­¦åˆ°çš„çŸ¥è¯†è½¬åŒ–ä¸ºä¸€ä¸ªå¯ä»¥è¿è¡Œçš„ç®—æœ¯è¡¨è¾¾å¼è§£é‡Šå™¨ã€‚</p>
<p>å› ä¸ºæˆ‘åˆ«çš„è¯­è¨€éƒ½ä¸å¤ªä¼šï¼Œæ‰€ä»¥å†³å®šç”¨Cè¯­è¨€ã€‚æœ¬ä»¥ä¸ºï¼Œè¿™æ˜¯ä¸ªéå¸¸ç®€å•çš„äº‹æƒ…ï¼Œæ²¡æƒ³åˆ°å†™äº†ä¸¤å¤©ï¼Œæˆ‘å¥½éš¾è¿‡å•ŠT_T</p>
<p>ç¬¬ä¸€å¤©å‘ç°æ ¹æœ¬æ²¡æ³•ä¸çœ‹pythonä»£ç ç›´æ¥å†™ï¼Œè¿™è¯´æ˜æˆ‘å¯¹æ•´ä¸ªç®—æ³•æµç¨‹éƒ½è¿˜ä¸ç†Ÿæ‚‰ï¼ŒåªçŸ¥é“å¤§æ¦‚åŸç†ï¼Œæ²¡æ³•è‡ªå·±å®ç°ï¼Œç„¶åå¼€å§‹ç…§ç€pythonä»£ç å†™ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­è¿˜å‘ç°æˆ‘å¯¹Cè¯­è¨€ä¹Ÿä¸å¤ªç†Ÿæ‚‰ï¼Œå¾ˆå¤šä¸œè¥¿éƒ½è®°ä¸æ¸…äº†ï¼Œå°¤å…¶æ˜¯å­—ç¬¦ä¸²æ•°ç»„å’ŒæŒ‡é’ˆï¼Œå®é™…ä¸Šæˆ‘åˆ°ç°åœ¨ä¹Ÿæ²¡ææ˜ç™½<code>char *str</code>å’Œ<code>char str[]</code>ä»€ä¹ˆæ—¶å€™ç”¨å“ªä¸ªã€æ€ä¹ˆç”¨ã€‚</p>
<p>ç¬¬äºŒå¤©ï¼Œä¹Ÿå°±æ˜¯ä»Šå¤©ï¼ˆ20200202ï¼‰ï¼Œæˆ‘å†³å®šå…¨ç”¨<code>char str[100]</code>è¿™ç§ï¼Œä½†è¿˜æ˜¯æœ‰å„ç§å„æ ·çš„é—®é¢˜ï¼Œä¸è¿‡éƒ½æ¸æ¸è§£å†³äº†ã€‚ç„¶åèŠ±äº†ä¸€ä¸ªå¤šå°æ—¶ï¼Œæ‰å‘ç°æœ€å¤§çš„é—®é¢˜åœ¨äºCè¯­è¨€çš„å­—ç¬¦ä¸²æ“ä½œå®Œå…¨ä¸èƒ½ç›´æ¥ç”¨<code>=</code>ä¹‹ç±»çš„æ–¹å¼æï¼Œè¦ç”¨<code>strcpy</code>å’Œ<code>strcmp</code>ï¼Œç„¶ååˆæ˜¯ä¸€ä¸ªå¤šå°æ—¶ï¼Œæ‰å‘ç°æˆ‘æŠŠ<code>strcpy(new,old)</code>å†™æˆäº†<code>strcpy(old,new)</code>ï¼Œç„¶åç¬¬ä¸‰ä¸ªä¸€å°æ—¶ï¼Œå‘ç°æˆ‘ä¸Šä¸€æ­¥æœ‰ä¸¤ä¸ªç”¨äº†<code>strcpy</code>çš„æ²¡æ”¹è¿‡æ¥ï¼Œè¿˜æŠŠä¸€ä¸ª<code>while</code>é‡Œçš„<code>==</code>å†™æˆäº†<code>=</code>ã€‚æˆ‘æ€•æ˜¯ä¸ªå‚»å­å§â€¦â€¦</p>
<p>æ€»ä¹‹ï¼Œç°åœ¨å†™å®Œäº†ï¼Œèƒ½æ­£å¸¸è¿è¡Œå‡ºç»“æœã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include&lt;assert.h&gt;</span><br><span class="line">#include&lt;stdbool.h&gt;</span><br><span class="line">#define SWAP(a,b) (a)^&#x3D;(b);(b)^&#x3D;(a);(a)^&#x3D;(b)</span><br><span class="line"></span><br><span class="line">char INTEGER[100]&#x3D;&quot;INTEGER&quot;;</span><br><span class="line">char PLUS[100]&#x3D;&quot;PLUS&quot;;</span><br><span class="line">char MINUS[100]&#x3D;&quot;MINUS&quot;;</span><br><span class="line">char END[100]&#x3D;&quot;EOF&quot;;</span><br><span class="line">int i&#x3D;1;</span><br><span class="line"></span><br><span class="line">struct Token		&#x2F;&#x2F;è¯æ³•å•å…ƒ</span><br><span class="line">&#123;</span><br><span class="line">	char type[100];	&#x2F;&#x2F;ç±»å‹ï¼Œå¯ä»¥æ˜¯integerã€plusã€minuså’Œend</span><br><span class="line">	char value[100];	&#x2F;&#x2F;å€¼ï¼Œå¯ä»¥æ˜¯æ•°å­—ï¼Œ+ï¼Œ-ï¼Œeof</span><br><span class="line">&#125;;</span><br><span class="line">struct Intepreter		&#x2F;&#x2F;è§£é‡Šå™¨</span><br><span class="line">&#123;</span><br><span class="line">	int pos;			&#x2F;&#x2F;ç´¢å¼•</span><br><span class="line">	char current_char;	&#x2F;&#x2F;å½“å‰å­—ç¬¦</span><br><span class="line">	char text[100];		&#x2F;&#x2F;è¾“å…¥çš„å­—ç¬¦ä¸²</span><br><span class="line">	Token token;		&#x2F;&#x2F;å½“å‰è¯æ³•å•å…ƒ</span><br><span class="line">&#125;;</span><br><span class="line">Intepreter intepreter;</span><br><span class="line">int error()			&#x2F;&#x2F;è¾“é”™ç¬¦å·çš„æŠ¥é”™</span><br><span class="line">&#123;</span><br><span class="line">	printf(&quot;Invalid syntax&quot;);</span><br><span class="line">	exit(100);</span><br><span class="line">&#125;</span><br><span class="line">Intepreter init(char text[100])	&#x2F;&#x2F;åˆå§‹åŒ–è§£é‡Šå™¨</span><br><span class="line">&#123;</span><br><span class="line">	Token tmp;</span><br><span class="line">	tmp.type[100]&#x3D;&#123;&#125;;</span><br><span class="line">	tmp.value[100]&#x3D;&#123;&#125;;</span><br><span class="line">	Intepreter intepreter;</span><br><span class="line">	strcpy(intepreter.text,text);</span><br><span class="line">	intepreter.pos&#x3D;0;</span><br><span class="line">	intepreter.current_char&#x3D;text[intepreter.pos];</span><br><span class="line">	strcpy(intepreter.token.type,tmp.type);</span><br><span class="line">	strcpy(intepreter.token.value,tmp.value);</span><br><span class="line">	return intepreter;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;ç´¢å¼•åç§»ä¸€ä½æ”¹å˜å½“å‰å­—ç¬¦</span><br><span class="line">Intepreter advance()</span><br><span class="line">&#123;</span><br><span class="line">	intepreter.pos+&#x3D;1;</span><br><span class="line">	if (intepreter.pos&gt;&#x3D;strlen(intepreter.text))</span><br><span class="line">	&#123;</span><br><span class="line">		intepreter.current_char&#x3D;&#39;\0&#39;;</span><br><span class="line">	&#125;</span><br><span class="line">	else</span><br><span class="line">	&#123;</span><br><span class="line">		intepreter.current_char&#x3D;intepreter.text[intepreter.pos];</span><br><span class="line">	&#125;</span><br><span class="line">	return intepreter;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;è·³è¿‡ç©ºæ ¼</span><br><span class="line">void skip_whitespace()</span><br><span class="line">&#123;</span><br><span class="line"> 	while(intepreter.current_char&#x3D;&#x3D;&#39; &#39;)</span><br><span class="line">    &#123;</span><br><span class="line">        intepreter&#x3D;advance();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> &#x2F;&#x2F;è¿”å›æ•´æ•°è¯æ³•å•å…ƒ</span><br><span class="line">int integer()</span><br><span class="line">&#123;</span><br><span class="line"> 	int result&#x3D;0;</span><br><span class="line"> 	while (intepreter.current_char&gt;&#x3D;&#39;0&#39; &amp;&amp; intepreter.current_char&lt;&#x3D;&#39;9&#39;)</span><br><span class="line"> 	&#123;</span><br><span class="line"> 		result&#x3D;result*10+(intepreter.current_char-&#39;0&#39;);</span><br><span class="line"> 		intepreter&#x3D;advance();</span><br><span class="line">	&#125;</span><br><span class="line">	return result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;ç”¨æ¥å–è¯æ³•å•å…ƒ</span><br><span class="line">Token get_next_token()</span><br><span class="line">&#123;</span><br><span class="line">	Token token;</span><br><span class="line">	while(intepreter.current_char!&#x3D;&#39;\0&#39;)</span><br><span class="line">	&#123;</span><br><span class="line">		if(intepreter.current_char&#x3D;&#x3D;&#39; &#39;)</span><br><span class="line">		&#123;</span><br><span class="line">			skip_whitespace();</span><br><span class="line">			continue;</span><br><span class="line">		&#125;</span><br><span class="line">		else if(intepreter.current_char&gt;&#x3D;&#39;0&#39; &amp;&amp; intepreter.current_char&lt;&#x3D;&#39;9&#39;)</span><br><span class="line">		&#123;</span><br><span class="line">			strcpy(token.type,INTEGER);</span><br><span class="line">			itoa(integer(),token.value,10);</span><br><span class="line">			return token;</span><br><span class="line">		&#125;</span><br><span class="line">		else if(intepreter.current_char&#x3D;&#x3D;&#39;+&#39;)</span><br><span class="line">		&#123;</span><br><span class="line">			intepreter&#x3D;advance();</span><br><span class="line">			strcpy(token.type,PLUS);</span><br><span class="line">			strcpy(token.value,&quot;+&quot;);</span><br><span class="line">			return token;</span><br><span class="line">		&#125;</span><br><span class="line">		else if(intepreter.current_char&#x3D;&#x3D;&#39;-&#39;)</span><br><span class="line">		&#123;</span><br><span class="line">			intepreter&#x3D;advance();</span><br><span class="line">			strcpy(token.type,MINUS);</span><br><span class="line">			strcpy(token.value,&quot;-&quot;);</span><br><span class="line">			return token;</span><br><span class="line">		&#125;</span><br><span class="line">		else</span><br><span class="line">		&#123;</span><br><span class="line">			error();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	strcpy(token.type,END);</span><br><span class="line">	strcpy(token.value,&quot;EOF&quot;);</span><br><span class="line">	return token;</span><br><span class="line">&#125;</span><br><span class="line">void eat(char type[100])</span><br><span class="line">&#123;</span><br><span class="line">	if (strcmp(intepreter.token.type,type)&#x3D;&#x3D;0)</span><br><span class="line">	&#123;</span><br><span class="line">		intepreter.token &#x3D; get_next_token();</span><br><span class="line">	&#125;</span><br><span class="line">	else</span><br><span class="line">	&#123;</span><br><span class="line">		int a &#x3D; error();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">int term()</span><br><span class="line">&#123;</span><br><span class="line">    Token token;</span><br><span class="line">    strcpy(token.type,intepreter.token.type);</span><br><span class="line">    strcpy(token.value,intepreter.token.value);</span><br><span class="line">    eat(INTEGER);</span><br><span class="line">    return atoi(token.value);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;ç”¨æ¥ç®—è¡¨è¾¾å¼</span><br><span class="line">int expr()</span><br><span class="line">&#123;</span><br><span class="line">	int result&#x3D;0;</span><br><span class="line">	Token token;</span><br><span class="line">	intepreter.token&#x3D;get_next_token();</span><br><span class="line">    result&#x3D;term();</span><br><span class="line">    while ((strcmp(intepreter.token.type,PLUS)&#x3D;&#x3D;0)||(strcmp(intepreter.token.type,MINUS)&#x3D;&#x3D;0))</span><br><span class="line">    &#123;</span><br><span class="line">        strcpy(token.type,intepreter.token.type);</span><br><span class="line">        strcpy(token.value,intepreter.token.value);</span><br><span class="line">        if (strcmp(token.type,PLUS)&#x3D;&#x3D;0)</span><br><span class="line">        &#123;</span><br><span class="line">            eat(PLUS);</span><br><span class="line">            result&#x3D;result+term();</span><br><span class="line">        &#125;</span><br><span class="line">        else if (strcmp(token.type,MINUS)&#x3D;&#x3D;0)</span><br><span class="line">        &#123;</span><br><span class="line">            eat(MINUS);</span><br><span class="line">            result-&#x3D;term();</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            error();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	return result;</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	char text[100];</span><br><span class="line">	printf(&quot;calc&gt;&quot;);</span><br><span class="line">	scanf(&quot;%s&quot;, &amp;text);</span><br><span class="line">	intepreter&#x3D;init(text);</span><br><span class="line">	int result&#x3D;expr();</span><br><span class="line">	printf(&quot;result is %d\n&quot;,result);</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="æ£€æŸ¥ç†è§£"><a href="#æ£€æŸ¥ç†è§£" class="headerlink" title="æ£€æŸ¥ç†è§£"></a>æ£€æŸ¥ç†è§£</h2><ol>
<li><p>ä»€ä¹ˆæ˜¯å¥æ³•å›¾ï¼Ÿ</p>
<p><strong>å¥æ³•å›¾</strong> å°±æ˜¯ç¨‹åºè¯­è¨€å¥æ³•è§„åˆ™çš„å›¾å½¢è¡¨ç¤ºã€‚åŸºæœ¬ä¸Šï¼Œå¥æ³•å›¾ä»è§†è§‰ä¸Šå‘ ä½ å±•ç¤ºäº†åœ¨ä½ çš„ç¨‹åºè¯­è¨€ä¸­å“ªäº›è¯­å¥æ˜¯å…è®¸çš„å“ªäº›æ˜¯ä¸å…è®¸çš„ã€‚</p>
</li>
<li><p>ä»€ä¹ˆæ˜¯å¥æ³•åˆ†æï¼Ÿ</p>
<p>ä» token æµä¸­è¯†åˆ«ç»„åˆçš„è¿‡ç¨‹å« <strong>parsing</strong>ã€‚</p>
</li>
<li><p>ä»€ä¹ˆæ˜¯å¥æ³•åˆ†æå™¨ï¼Ÿ</p>
<p>è§£é‡Šå™¨æˆ–ç¼–è¯‘å™¨ä¸­æ‰§è¡Œparsingçš„éƒ¨åˆ†å« <strong>parser</strong>ã€‚</p>
</li>
</ol>
]]></content>
      <categories>
        <category>Let&#39;s Build A Simple Interpreter</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>ç¼–è¯‘åŸç†</tag>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>å„ç§å¹³å°é‡åˆ°è¿‡çš„errorå¤„ç†æ–¹å¼</title>
    <url>/2020/01/31/%E5%90%84%E7%A7%8D%E5%B9%B3%E5%8F%B0%E9%81%87%E5%88%B0%E8%BF%87%E7%9A%84error%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[<p>è®°å½•ä¸€ä¸‹ä¹‹å‰çš„ä¸€äº›é—®é¢˜ã€‚</p>
<a id="more"></a>

<ol>
<li><p>å¹³å°ï¼švisiual studio<br>error LNK2026: æ¨¡å—å¯¹äº SAFESEH æ˜ åƒæ˜¯ä¸å®‰å…¨çš„<br>è§£å†³æ–¹æ³•ï¼šå±æ€§ - &gt; é“¾æ¥å™¨ - &gt; é™„åŠ é€‰é¡¹è¾“å…¥ /SAFESEH:NO - &gt; åº”ç”¨</p>
</li>
<li><p>å¹³å°ï¼švisiual studio<br>error C4996: â€˜fopenâ€™: This function or variable may be unsafe. Consider using fopen_sinstead. To disable deprecation, use _CRT_SECURE_NO_WARNINGS. See online help   for details.<br>1&gt;f:\program files (x86)\microsoft visual studio 12.0\vc\include\stdio.h(211) : å‚è§â€œfopenâ€çš„å£°æ˜<br>è§£å†³æ–¹æ³•ï¼šé¢„å¤„ç†å™¨åŠ å…¥_CRT_SECURE_NO_WARNINGS</p>
</li>
<li><p>å¹³å°ï¼švisiual studio<br>error C2664: â€œint MessageBoxW(HWND,LPCWSTR,LPCWSTR,UINT)â€: æ— æ³•å°†å‚æ•° 2 ä»â€œconst char [17]â€è½¬æ¢ä¸ºâ€œLPCWSTRâ€<br>è§£å†³æ–¹æ³•ï¼šé¡¹ç›®èœå•-&gt;å±æ€§-&gt;é…ç½®å±æ€§-&gt;å¸¸è§„-&gt;é¡¹ç›®é»˜è®¤å€¼-&gt;å­—ç¬¦é›†ä»unicodeæ”¹ä¸ºæœªè®¾ç½®</p>
</li>
<li><p>å¹³å°ï¼švisiual studio<br>error LNK2019: æ— æ³•è§£æçš„å¤–éƒ¨ç¬¦å· _mainï¼Œè¯¥ç¬¦å·åœ¨å‡½æ•° ___tmainCRTStartup ä¸­è¢«å¼•ç”¨<br>è§£å†³æ–¹æ³•ï¼šå³å‡»é¡¹ç›®ï¼Œæ‰“å¼€â€œå±æ€§â€é¡µï¼Œé“¾æ¥å™¨-&gt;ç³»ç»Ÿ-&gt;å­ç³»ç»Ÿ-&gt;/subsystem:windowsã€‚å¦‚æœæ˜¯åˆšå¼€å§‹é»˜è®¤çš„æ˜¯/subsystem:windowsåˆ™æ”¹ä¸º/subsytem:console</p>
</li>
<li><p>å¹³å°ï¼švisiual studio<br>error LNK2019: æ— æ³•è§£æçš„å¤–éƒ¨ç¬¦å· <strong>imp</strong>timeGetTime@0ï¼Œè¯¥ç¬¦å·åœ¨å‡½æ•° â€œvoid __cdecl TimerInit(void)â€ (?TimerInit@@YAX<br>è§£å†³æ–¹æ³•ï¼šå°†winmm.libæ‰“å…¥â€œé™„åŠ ä¾èµ–é¡¹â€</p>
</li>
<li><p>å¹³å°ï¼švisiual studio<br>fatal error LNK1123: è½¬æ¢åˆ° COFF æœŸé—´å¤±è´¥: æ–‡ä»¶æ— æ•ˆæˆ–æŸå<br>è§£å†³æ–¹æ³•ï¼šå³é”®-&gt;å·¥ç¨‹å±æ€§-&gt;é…ç½®å±æ€§-&gt; æ¸…å•å·¥å…·-&gt;è¾“å…¥å’Œè¾“å‡º-&gt;åµŒå…¥æ¸…å•ï¼Œé€‰æ‹©[å¦]</p>
</li>
<li><p>çªç„¶å‘ç°githubä¸Šçš„å›¾ç‰‡æ‰“ä¸å¼€ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯åšå®¢é‡Œæ’å…¥äº†ä¸Šä¼ åˆ°githubçš„å›¾ï¼Œä½†æ˜¯åŠ è½½ä¸å‡ºï¼Œè¿™æ—¶éœ€è¦ä¿®æ”¹hostsæ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š</p>
<p>æ‰“å¼€è·¯å¾„C:\Windows\System32\drivers\etcä¸‹çš„hostsæ–‡ä»¶ï¼Œåœ¨æœ€ååŠ ä¸Š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># GitHub Start </span><br><span class="line">192.30.253.112    github.com </span><br><span class="line">192.30.253.119    gist.github.com</span><br><span class="line">151.101.184.133    assets-cdn.github.com</span><br><span class="line">151.101.184.133    raw.githubusercontent.com</span><br><span class="line">151.101.184.133    gist.githubusercontent.com</span><br><span class="line">151.101.184.133    cloud.githubusercontent.com</span><br><span class="line">151.101.184.133    camo.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars0.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars1.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars2.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars3.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars4.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars5.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars6.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars7.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars8.githubusercontent.com </span><br><span class="line"> # GitHub End</span><br></pre></td></tr></table></figure>
</li>
<li><p>opencvè¯»å–å›¾åƒé‡Šæ”¾èµ„æºæ—¶æŠ¥é”™ï¼š</p>
<p><code>[ WARN:1] global C:\projects\opencv-python\opencv\modules\videoio\src\cap_msmf.cpp (674) SourceReaderCB::~SourceReaderCB terminating async callback</code></p>
<p>ä¿®æ”¹ä»£ç å¦‚ä¸‹ï¼š<code>cap = cv2.VideoCapture(0, cv2.CAP_DSHOW)</code></p>
</li>
<li><p>pycharmæ›´æ–°äº†ä¸€ä¸‹ï¼Œç„¶åå¯¼å…¥åŒ…çš„æ—¶å€™ä¼šæœ‰<code>unresolved reference issue</code>çš„æç¤ºï¼Œä½†æ˜¯èƒ½æ­£å¸¸è¿è¡Œï¼Œå°±åªæ˜¯çœ‹èµ·æ¥ä¸å¥½çœ‹ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼š<del><a href="https://www.jianshu.com/p/9555310f1920" target="_blank" rel="noopener">æœ‰ä¸€ä¸ª</a>è¯´<code>File</code> â†’ <code>Settings</code> â†’ <code>Editor</code> â†’ <code>File Types</code> â†’ <code>Ignore files and folders</code>ï¼Œå¹²æ‰æ¡†æ¡†ä¸­çš„ï¼š<code>__init__.py;</code>ï¼Œç„¶åï¼š<code>OK</code>ç­‰å¾…é‡æ–°æ–‡ä»¶æ‰«æã€‚ä½†æ˜¯æˆ‘æ‰“å¼€çœ‹äº†ä»¥åå‘ç°æˆ‘çš„æ¡†é‡Œå¹¶æ²¡æœ‰<code>__init__.py</code>ã€‚äºæ˜¯å°±<code>File</code> â†’ <code>Invalidate Caches / Restart</code>ï¼Œé€‰æ‹©<code>Invalidate and Restart</code>ï¼Œç­‰å¾…é‡æ–°æ‰«æåº“æ–‡ä»¶ã€‚è¿™ä¹‹åå°±å¥½äº†ã€‚</del>å¹¶æ²¡æœ‰è§£å†³é—®é¢˜ï¼Œç®—äº†åæ­£ä¸å½±å“è¿è¡Œï¼Œå°±è¿™æ ·å§ã€‚</p>
</li>
</ol>
]]></content>
      <categories>
        <category>æ— åˆ†ç±»é¡¹</category>
      </categories>
      <tags>
        <tag>error</tag>
      </tags>
  </entry>
  <entry>
    <title>Let&#39;s Build A Simple Interpreterç¬”è®°[2]</title>
    <url>/2020/01/31/Let-s-Build-A-Simple-Interpreter%E7%AC%94%E8%AE%B0-2/</url>
    <content><![CDATA[<h2 id="è¯¾ç¨‹æ–‡æ¡£"><a href="#è¯¾ç¨‹æ–‡æ¡£" class="headerlink" title="è¯¾ç¨‹æ–‡æ¡£"></a>è¯¾ç¨‹æ–‡æ¡£</h2><p><a href="https://ruslanspivak.com/lsbasi-part2/" target="_blank" rel="noopener">åŸæ–‡</a></p>
<p><a href="https://feng-qi.github.io/2018/01/25/lets-build-a-simple-interpreter-part-02/" target="_blank" rel="noopener">ç¿»è¯‘</a></p>
<a id="more"></a>

<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Token types</span></span><br><span class="line"><span class="comment"># EOF (end-of-file) token is used to indicate that</span></span><br><span class="line"><span class="comment"># there is no more input left for lexical analysis</span></span><br><span class="line">INTEGER, PLUS, MINUS, EOF = <span class="string">'INTEGER'</span>, <span class="string">'PLUS'</span>, <span class="string">'MINUS'</span>, <span class="string">'EOF'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Token</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, type, value)</span>:</span></span><br><span class="line">        <span class="comment"># token type: 'INTEGER', 'PLUS', 'MINUS', or 'EOF'</span></span><br><span class="line">        self.type = type</span><br><span class="line">        <span class="comment"># token value: non-negative integer value, '+', '-', or None</span></span><br><span class="line">        self.value = value</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""String representation of class instance</span></span><br><span class="line"><span class="string">        Examples:</span></span><br><span class="line"><span class="string">            Token(INTEGER, 3)</span></span><br><span class="line"><span class="string">            Token(PLUS, '+')</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">f'Token(<span class="subst">&#123;self.type&#125;</span>, <span class="subst">&#123;self.value&#125;</span>)'</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.__str__()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Interpreter</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, text)</span>:</span></span><br><span class="line">        <span class="comment"># client string input, e.g. "3 + 5", "12 - 5", etc</span></span><br><span class="line">        self.text = text</span><br><span class="line">        <span class="comment"># self.pos is an index into self.text</span></span><br><span class="line">        self.pos = <span class="number">0</span></span><br><span class="line">        <span class="comment"># current token instance</span></span><br><span class="line">        self.current_token = <span class="literal">None</span></span><br><span class="line">        self.current_char = self.text[self.pos]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">error</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">'Error parsing input'</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">advance</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Advance the 'pos' pointer and set the 'current_char' variable."""</span></span><br><span class="line">        self.pos += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> self.pos &gt;= len(self.text):</span><br><span class="line">            self.current_char = <span class="literal">None</span>  <span class="comment"># Indicates end of input</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.current_char = self.text[self.pos]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">skip_whitespace</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">while</span> self.current_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> self.current_char.isspace():</span><br><span class="line">            self.advance()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">integer</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Return a (multidigit) integer consumed from the input."""</span></span><br><span class="line">        result = <span class="string">''</span></span><br><span class="line">        <span class="keyword">while</span> self.current_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> self.current_char.isdigit():</span><br><span class="line">            result += self.current_char</span><br><span class="line">            self.advance()</span><br><span class="line">        <span class="keyword">return</span> int(result)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_next_token</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Lexical analyzer (also known as scanner or tokenizer)</span></span><br><span class="line"><span class="string">        This method is responsible for breaking a sentence</span></span><br><span class="line"><span class="string">        apart into tokens.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">while</span> self.current_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">if</span> self.current_char.isspace():</span><br><span class="line">                self.skip_whitespace()</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> self.current_char.isdigit():</span><br><span class="line">                <span class="keyword">return</span> Token(INTEGER, self.integer())</span><br><span class="line">            <span class="keyword">if</span> self.current_char == <span class="string">'+'</span>:</span><br><span class="line">                self.advance()</span><br><span class="line">                <span class="keyword">return</span> Token(PLUS, <span class="string">'+'</span>)</span><br><span class="line">            <span class="keyword">if</span> self.current_char == <span class="string">'-'</span>:</span><br><span class="line">                self.advance()</span><br><span class="line">                <span class="keyword">return</span> Token(MINUS, <span class="string">'-'</span>)</span><br><span class="line">            self.error()</span><br><span class="line">        <span class="keyword">return</span> Token(EOF, <span class="literal">None</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">eat</span><span class="params">(self, token_type)</span>:</span></span><br><span class="line">        <span class="comment"># compare the current token type with the passed token</span></span><br><span class="line">        <span class="comment"># type and if they match then "eat" the current token</span></span><br><span class="line">        <span class="comment"># and assign the next token to the self.current_token,</span></span><br><span class="line">        <span class="comment"># otherwise raise an exception.</span></span><br><span class="line">        <span class="keyword">if</span> self.current_token.type == token_type:</span><br><span class="line">            self.current_token = self.get_next_token()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.error()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">expr</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Parser / Interpreter</span></span><br><span class="line"><span class="string">        expr -&gt; INTEGER PLUS INTEGER</span></span><br><span class="line"><span class="string">        expr -&gt; INTEGER MINUS INTEGER</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="comment"># set current token to the first token from the input</span></span><br><span class="line">        self.current_token = self.get_next_token()</span><br><span class="line">        <span class="comment"># we expect the current token to be an integer</span></span><br><span class="line">        left = self.current_token</span><br><span class="line">        self.eat(INTEGER)</span><br><span class="line">        <span class="comment"># we expect the current token to be either a '+' or '-'</span></span><br><span class="line">        op = self.current_token</span><br><span class="line">        <span class="keyword">if</span> op.type == PLUS:</span><br><span class="line">            self.eat(PLUS)</span><br><span class="line">        <span class="keyword">elif</span> op.type == MINUS:</span><br><span class="line">            self.eat(MINUS)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.error()</span><br><span class="line">        <span class="comment"># we expect the current token to be an integer</span></span><br><span class="line">        right = self.current_token</span><br><span class="line">        self.eat(INTEGER)</span><br><span class="line">        <span class="comment"># after the above call the self.current_token is set to</span></span><br><span class="line">        <span class="comment"># EOF token</span></span><br><span class="line">        <span class="comment"># at this point either the INTEGER PLUS INTEGER or</span></span><br><span class="line">        <span class="comment"># the INTEGER MINUS INTEGER sequence of tokens</span></span><br><span class="line">        <span class="comment"># has been successfully found and the method can just</span></span><br><span class="line">        <span class="comment"># return the result of adding or subtracting two integers,</span></span><br><span class="line">        <span class="comment"># thus effectively interpreting client input</span></span><br><span class="line">        <span class="keyword">if</span> op.type == PLUS:</span><br><span class="line">            result = left.value + right.value</span><br><span class="line">        <span class="keyword">elif</span> op.type == MINUS:</span><br><span class="line">            result = left.value - right.value</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.error()</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># To run under Python3 replace 'raw_input' call with 'input'</span></span><br><span class="line">            text = input(<span class="string">'calc&gt; '</span>)</span><br><span class="line">        <span class="keyword">except</span> EOFError:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> text:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        interpreter = Interpreter(text)</span><br><span class="line">        result = interpreter.expr()</span><br><span class="line">        print(result)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="ç¬”è®°"><a href="#ç¬”è®°" class="headerlink" title="ç¬”è®°"></a>ç¬”è®°</h2><p>è¿™ä¸ªå¤„ç†æ–¹å¼å’Œæˆ‘æƒ³çš„ä¸å¤ªä¸€æ ·â€¦</p>
<p>æ•´ä½“é€»è¾‘æ˜¯ï¼š</p>
<ol>
<li><code>get_next_token</code>æ˜¯è¯æ³•åˆ†æå™¨ï¼Œè¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé€ä¸€è¾“å‡ºè¯æ³•å•å…ƒï¼Œæ¯”å¦‚è¾“å…¥<code>32 + 5</code>ï¼Œè¾“å‡ºçš„æµåº”è¯¥æ˜¯<code>Token(INTEGER, 32) -&gt; Token(PLUS, +) -&gt; Token(INTEGER, 5)</code>ã€‚<br>è¿™ä¸ªè¯æ³•åˆ†æå™¨ç”¨åˆ°çš„è¾…åŠ©å‡½æ•°ä¸º<code>advance()</code>ï¼Œ<code>skip_whitespace()</code>å’Œ<code>interger()</code>ï¼Œå…¶ä¸­<code>advance()</code>è®©ç´¢å¼•åç§»ä¸€ä½ï¼Œ<code>skip_whitespace()</code>è·³è¿‡ç©ºæ ¼ï¼Œ<code>interger()</code>æŠŠè¿ç»­çš„æ•°å­—å˜æˆä¸€ä¸ªå®Œæ•´çš„æ•°å­—ã€‚æ³¨æ„è¿™é‡Œå¦‚æœæ˜¯å¤šä½æ•°ä¸­é—´æœ‰ç©ºæ ¼ï¼Œå¤šä½æ•°ä¼šè¢«æ‹†æˆä¸¤ä¸ªæ•°å­—ï¼Œæ¯”å¦‚<code>32 3</code>ä¼šè¢«åˆ¤æ–­ä¸º<code>32</code>å’Œ<code>3</code>ï¼Œè€Œä¸æ˜¯<code>323</code>ã€‚<br>è¯æ³•åˆ†æè¿‡ç¨‹ä¸­ä¼šé‡åˆ°ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š(1)ç©ºæ ¼ï¼Œè¦è·³è¿‡ç©ºæ ¼ï¼Œå¾ªç¯ç»§ç»­è¿è¡Œï¼Œåˆ†æä¸‹ä¸€ä¸ªå­—ç¬¦ï¼›(2)ç»“æŸç¬¦ï¼Œç›´æ¥è¿”å›<code>EOF</code>å¯¹åº”çš„<code>token</code>ï¼›(3)æ•°å­—ï¼Œå¾ªç¯ç»ˆæ­¢ï¼Œè¿åé¢çš„å‡ ä½æ•°å­—å­—ç¬¦ä¸€èµ·å˜æˆä¸€ä¸ªæ•°å­—ï¼Œè¿”å›å¯¹åº”çš„<code>token</code>ï¼›(4)æ˜¯<code>+</code>æˆ–è€…<code>-</code>ï¼Œç´¢å¼•ç§»åˆ°ä¸‹ä¸€ä½ï¼Œå¾ªç¯ç»ˆæ­¢ï¼Œè¿”å›è¿ç®—ç¬¦å¯¹åº”çš„<code>token</code>ã€‚<br>åˆ†æå‡ ä¸ªè¾…åŠ©å‡½æ•°ï¼š<ol>
<li><code>advance()</code>ï¼Œç´¢å¼•<code>pos</code>åç§»ä¸€ä½ï¼Œå½“å‰å­—ç¬¦<code>current.char</code>çš„å€¼å˜ä¸ºæ–°ç´¢å¼•å¯¹åº”çš„å­—ç¬¦ã€‚</li>
<li><code>skip_whitespace()</code>ï¼Œå¾ªç¯è°ƒç”¨<code>advance()</code>ç›´åˆ°å½“å‰å­—ç¬¦ä¸æ˜¯ç©ºæ ¼ã€‚</li>
<li><code>integer()</code>ï¼Œå…ˆå£°æ˜ä¸€ä¸ªåˆå§‹ä¸ºç©ºå­—ç¬¦ä¸²çš„<code>result</code>ï¼Œç„¶åå¾ªç¯æŠŠ<code>current.char</code>åŠ åˆ°<code>result</code>è¿™ä¸ªå­—ç¬¦ä¸²é‡Œï¼Œæ¥ç€<code>advance()</code>ç§»åŠ¨åˆ°ä¸‹ä¸€ä½ï¼Œç›´åˆ°å½“å‰å­—ç¬¦ä¸æ˜¯æ•°å­—ã€‚</li>
</ol>
</li>
<li><code>expr()</code>æ˜¯ç”¨æ¥è®¡ç®—è¡¨è¾¾å¼çš„ï¼Œåˆ¤æ–­è¯æ³•åˆ†æåçš„è¯æ³•å•å…ƒæ˜¯å¦ç¬¦åˆè§„åˆ™ï¼Œç„¶åæ ¹æ®è§„åˆ™æ¥è®¡ç®—ç»“æœã€‚è¾…åŠ©å‡½æ•°ä¸º<code>eat()</code>ï¼Œç”¨æ¥åˆ¤æ–­å½“å‰è¯æ³•å•å…ƒæ˜¯å¦ç¬¦åˆè§„åˆ™ã€‚</li>
</ol>
<p>ä»¥è¾“å…¥<code>32 + 5</code>ä¸ºä¾‹åˆ†ææ•´ä¸ªæµç¨‹ï¼š</p>
<ol>
<li><p>é¦–å…ˆè¿è¡Œçš„æ˜¯<code>main()</code>ï¼Œè·å–è¾“å…¥å­—ç¬¦ä¸²ï¼Œå­˜åˆ°<code>text</code>ä¸­ï¼ˆ<code>line116</code>)ï¼Œå¹¶ç”¨<code>text</code>åˆå§‹åŒ–<code>interpreter</code>è¿™ä¸ªè§£é‡Šå™¨ç±»(<code>line121</code>)ï¼Œæ­¤æ—¶ï¼Œ<code>interpreter.text</code>å°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œ<code>interpreter.pos</code>æ˜¯åˆå§‹å€¼<code>0</code>ï¼Œ<code>self.current_token</code>æ˜¯åˆå§‹å€¼<code>None</code>ï¼Œ<code>self.current_char</code>æ˜¯<code>interpreter.text</code>è¿™ä¸ªå­—ç¬¦ä¸²æ•°ç»„ä¸‹æ ‡ä¸º<code>pos=0</code>å¯¹åº”çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯<code>3</code>ã€‚</p>
</li>
<li><p>æ¥ä¸‹æ¥<code>line122</code>è°ƒç”¨äº†è¡¨è¾¾å¼è®¡ç®—å™¨<code>expr()</code>ï¼Œè€Œ<code>expr()</code>çš„ç¬¬ä¸€è¡Œè°ƒç”¨äº†è¯æ³•åˆ†æå™¨<code>get_next_token()</code>ï¼Œå› ä¸ºå­—ç¬¦3æ˜¯æ•°å­—ï¼Œæ‰€ä»¥è¦å»è°ƒç”¨<code>integer()</code>å‡½æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªç±»å‹ä¸º<code>INTEGER</code>ã€å€¼ä¸ºå‡½æ•°ç»“æœçš„<code>TOKEN</code>ã€‚<br>åœ¨æ‰§è¡Œå®Œ<code>integer()</code>å¹¶è¿”å›ä¹‹å‰ï¼Œ<code>pos=0</code>ï¼Œ<code>current_token=None</code>ï¼Œ<code>current_char=3</code>ã€‚</p>
</li>
<li><p>è¿›å…¥<code>integer()</code>å‡½æ•°ï¼Œæœ€åˆ<code>result</code>æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œ<code>current_char=3</code>ç¬¦åˆå¾ªç¯æ¡ä»¶ï¼Œè¿›å…¥<code>while</code>å¾ªç¯ï¼Œ<code>result</code>å˜æˆ<code>3</code>ï¼ˆæ˜¯å­—ç¬¦ä¸²æ ¼å¼ï¼‰,è°ƒç”¨<code>advance()</code>ï¼Œæ¥ä¸‹æ¥å…ˆè®©ç´¢å¼•åç§»ï¼Œå³<code>pos=1</code>ï¼Œæ­¤æ—¶è¿˜æ²¡ç§»åˆ°æœ€åä¸€ä½ï¼Œæ›´æ–°<code>current_char=text[pos]=text[1]=2</code>ã€‚æ­¤æ—¶è¿˜ç¬¦åˆå¾ªç¯æ¡ä»¶ï¼Œ<code>result</code>æŠŠæ–°çš„<code>current_char</code>åŠ ä¸Šï¼Œå˜æˆ<code>32</code>ï¼ˆå­—ç¬¦ä¸²æ ¼å¼ï¼‰ï¼Œå†æ¬¡<code>advance()</code>ï¼Œè°ƒç”¨å®Œåï¼Œ<code>pos=2</code>ï¼Œä¾æ—§æ²¡ç§»åˆ°æœ€åä¸€ä½ï¼Œ<code>current_char=text[2]=ç©ºæ ¼</code>ã€‚è¿™æ—¶ä¸æ»¡è¶³å¾ªç¯æ¡ä»¶äº†ï¼Œå¾ªç¯ç»“æŸï¼Œè¿”å›å­—ç¬¦ä¸²<code>result</code>å¯¹åº”çš„æ•°å­—ä¹Ÿå°±æ˜¯32ã€‚</p>
</li>
<li><p>ç„¶åå›åˆ°<code>get_next_token()</code>ï¼Œå®ƒå·²ç»æœ‰è¿”å›å€¼äº†ï¼Œè¿”å›ç»™ä¹‹å‰çš„<code>expr()</code>ä¸­çš„<code>self.current_token</code>ï¼Œè¿™æ˜¯æˆ‘ä»¬å¾—åˆ°çš„ç¬¬ä¸€ä¸ªè¯æ³•å•å…ƒï¼Œæ˜¯æˆ‘ä»¬è¦è®¡ç®—çš„è¡¨è¾¾å¼çš„å·¦å€¼ï¼Œå°†å®ƒå­˜åˆ°<code>left</code>ä¸­ï¼Œä¹‹åå¯ä»¥ä½¿ç”¨<code>left.value</code>æ¥è®¿é—®å®ƒçš„å€¼ï¼Œè¿™ä¹‹åå°±è°ƒç”¨<code>eat()</code>çœ‹è¯¥å€¼æ˜¯ä¸æ˜¯ä¸€ä¸ª<code>INTEGER</code>ï¼Œå¦‚æœæ˜¯ï¼Œå°±å†æ¬¡è°ƒç”¨<code>get_next_token()</code>ç»§ç»­åˆ†æä¸‹ä¸€ä¸ªå•å…ƒï¼Œåä¹‹åˆ™æŠ¥é”™ã€‚å¾ˆæ˜¾ç„¶æ­¤æ—¶<code>current_token</code>æ˜¯<code>(INTEGER,32)</code>ï¼Œç¬¦åˆè¦æ±‚ï¼Œè¿›å…¥<code>get_next_token()</code>ã€‚</p>
</li>
<li><p><code>get_next_token()</code>åˆ¤æ–­æ­¤æ—¶<code>current_char</code>æ˜¯ç©ºæ ¼ï¼Œå› æ­¤æ‰§è¡Œ<code>skip_whitespace()</code>ã€‚</p>
</li>
<li><p>åœ¨<code>skip_whitespace()</code>ä¸­ï¼Œ<code>current_char</code>æ»¡è¶³å¾ªç¯æ¡ä»¶ï¼Œè¿›å…¥å¾ªç¯ä½“ï¼Œè°ƒç”¨<code>advance()</code>ï¼Œ<code>pos=3</code>ï¼Œ<code>current_char=text[3]=+</code>ï¼Œå¾ªç¯ç»“æŸï¼Œå›åˆ°<code>get_next_token()</code>ï¼Œæ‰§è¡Œ<code>continue</code>ï¼Œä¹Ÿå°±æ˜¯ç»§ç»­è¿›è¡Œè¯æ³•åˆ¤æ–­ã€‚</p>
</li>
<li><p>ç”±äº<code>current_char</code>æ˜¯<code>+</code>ï¼Œåœ¨å¯¹åº”çš„<code>if</code>åˆ†æ”¯ä¸­ï¼Œæ‰§è¡Œ<code>advance()</code>ï¼Œ<code>pos=4</code>,<code>current_char=text[4]=ç©ºæ ¼</code>ï¼Œç„¶åæŠŠ<code>+</code>å¯¹åº”çš„<code>token</code>è¿”å›åˆ°<code>expr()</code>ä¸­ã€‚</p>
</li>
<li><p><code>expr()</code>æŠŠæ–°å¾—åˆ°çš„<code>token</code>å­˜å…¥<code>op</code>ï¼Œå¹¶é€šè¿‡<code>eat()</code>åˆ¤æ–­è¯¥<code>token</code>æ˜¯å¦æ˜¯ä¸€ä¸ªåŠ å·æˆ–è€…å‡å·ã€‚æ­¤æ—¶æ˜¯åŠ å·ï¼Œåˆå¼€å§‹äº†<code>get_next_token()</code>ã€‚</p>
</li>
<li><p>è¿™æ¬¡<code>get_next_token()</code>é¦–å…ˆè¿›å…¥ç©ºæ ¼åˆ†æ”¯ï¼Œè·³è¿‡ç©ºæ ¼åï¼Œ<code>pos=5</code>ï¼Œ<code>current_char=5</code>ï¼Œè¿›å…¥æ•°å­—åˆ†æ”¯ï¼Œæ‰§è¡Œ<code>integer()</code>ã€‚<code>integer()</code>ä¸­å’Œç¬¬ä¸‰æ­¥ä¸€æ ·ï¼Œæœ€ç»ˆè¿”å›æ•°å­—5ï¼Œå†å›åˆ°<code>get_next_token()</code>ï¼Œè¿”å›5å¯¹åº”çš„<code>token</code>ç»™<code>expr()</code>ï¼Œå­˜åœ¨<code>right</code>ä¸­ã€‚</p>
</li>
<li><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†è¯æ³•åˆ†æï¼Œå¾—åˆ°äº†<code>(INTEGER, 32) -&gt; (PLUS, &#39;+&#39;) -&gt; (INTEGER, 5)</code>çš„è¯æ³•ç»“æ„ã€‚ç”±äº<code>OP</code>å¯¹åº”çš„ç±»å‹æ˜¯<code>PLUS</code>ï¼Œå¯¹<code>left.value</code>å’Œ<code>right.value</code>æ‰§è¡ŒåŠ æ³•ï¼Œå­˜å…¥<code>result</code>å¹¶è¿”å›ã€‚</p>
</li>
<li><p>å†å›åˆ°<code>line122</code>ï¼Œ<code>result</code>å·²ç»å¾—åˆ°äº†ç»“æœï¼Œ<code>line123</code>è¾“å‡ºè¯¥ç»“æœï¼Œç¨‹åºè¿è¡Œç»“æŸã€‚</p>
</li>
</ol>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è®¡ç®—è¡¨è¾¾å¼ç»“æœçš„å‡½æ•°ä¸­è°ƒç”¨è¯æ³•åˆ†æå™¨ï¼Œåˆ¤æ–­è¯æ³•åˆ†æçš„ç»“æœæ˜¯å¦ç¬¦åˆè§„åˆ™ï¼Œå¦‚æœç¬¦åˆè§„åˆ™ï¼Œå°±æŒ‰è§„åˆ™ç»§ç»­è¿è¡Œã€‚åœ¨è®¡ç®—å™¨å‡½æ•°ä¸­ï¼Œåªä¼šå‡ºç°<code>token</code>ç±»å‹çš„å˜é‡ï¼Œè€Œè¯æ³•åˆ†æå‡½æ•°ä¼šè´Ÿè´£æŠŠè¯æ³•å•å…ƒæ‰“åŒ…æˆ<code>token</code>äº¤ç»™è®¡ç®—å™¨ã€‚</p>
<blockquote>
<p>åœ¨è§£é‡Šä¸€ä¸ªè¡¨è¾¾å¼ä¹‹å‰ï¼Œä½ éœ€è¦çŸ¥é“å®ƒæ˜¯å“ªç§ç»„åˆï¼Œæ¯”å¦‚ç›¸åŠ æˆ–ç›¸å‡ã€‚è¿™æ˜¯ <code>expr</code> æ–¹æ³•æœ¬è´¨ä¸Šåšçš„äº‹ï¼š å®ƒä» <code>get_next_token</code> æ–¹æ³•å¾—åˆ°çš„ token æµä¸­æ‰¾åˆ°ç»“æ„ï¼Œç„¶åè§£é‡Šå®ƒè¯†åˆ«å‡ºçš„ç»„åˆï¼Œäº§ ç”Ÿç®—æœ¯è¡¨è¾¾å¼çš„ç»“æœã€‚<br>ä» token æµä¸­æŸ¥æ‰¾ç»“æ„ï¼Œæˆ–è€…è¯´ä» token æµä¸­è¯†åˆ«ç»„åˆï¼Œçš„è¿‡ç¨‹å«åš <strong>parsing</strong>. è§£é‡Šå™¨ æˆ–ç¼–è¯‘å™¨ä¸­æ‰§è¡Œè¿™éƒ¨åˆ†ä»»åŠ¡çš„å« <strong>parser</strong>.<br>ç°åœ¨ä½ çŸ¥é“è§£é‡Šå™¨çš„ <strong>parsing</strong> å’Œ <strong>è§£é‡Š</strong> éƒ½åœ¨ <code>expr</code> æ–¹æ³•ä¸­äº†â”€â”€ <code>expr</code> æ–¹æ³•é¦–å…ˆå° è¯•ä» token æµä¸­è¯†åˆ«ï¼ˆå³parseï¼‰ INTEGER -&gt; PLUS -&gt; INTEGER æˆ– the INTEGER -&gt; MINUS -&gt; INTEGER ç»„åˆï¼Œåœ¨æˆåŠŸè¯†åˆ«åˆ°ï¼ˆå³parsedï¼‰å…¶ä¸­ä¸€ä¸ªç»„åˆæ—¶ï¼Œè¯¥æ–¹æ³•å°±è§£é‡Šæ‰§è¡Œ å®ƒå¹¶è¿”å›ç»™è°ƒç”¨è€…ä¸¤ä¸ªæ•´æ•°ç›¸åŠ æˆ–ç›¸å‡çš„ç»“æœã€‚</p>
</blockquote>
<h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><ol>
<li><p>æ‰©å±•è®¡ç®—å™¨ä»¥å¤„ç†ä¸¤ä¸ªæ•´æ•°ç›¸ä¹˜</p>
</li>
<li><p>æ‰©å±•è®¡ç®—å™¨ä»¥å¤„ç†ä¸¤ä¸ªæ•´æ•°ç›¸é™¤</p>
<p>å‰ä¸¤ä¸ªéƒ½å¾ˆç®€å•ï¼Œä»¿ç…§åŠ æ³•å‡æ³•çš„ä»£ç å¤åˆ¶æ”¹å†™å°±è¡Œã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¿ç®—ç¬¦å£°æ˜</span></span><br><span class="line">INTEGER, PLUS, MINUS, MULTIPLY, DIVIDE, EOF = <span class="string">'INTEGER'</span>, <span class="string">'PLUS'</span>, <span class="string">'MINUS'</span>, <span class="string">'MULTIPLY'</span>, <span class="string">'DIVIDE'</span>, <span class="string">'EOF'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># get_next_token()</span></span><br><span class="line"><span class="keyword">if</span> self.current_char == <span class="string">'*'</span>:</span><br><span class="line">	self.advance()</span><br><span class="line">	<span class="keyword">return</span> Token(MULTIPLY, <span class="string">'*'</span>)</span><br><span class="line"><span class="keyword">if</span> self.current_char == <span class="string">'/'</span>:</span><br><span class="line">	self.advance()</span><br><span class="line">	<span class="keyword">return</span> Token(DIVIDE, <span class="string">'/'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># expr()</span></span><br><span class="line"><span class="comment"># ä¿®æ”¹è¯»å–è¿ç®—ç¬¦</span></span><br><span class="line">op = self.current_token</span><br><span class="line"><span class="keyword">if</span> op.type == PLUS:</span><br><span class="line">	self.eat(PLUS)</span><br><span class="line"><span class="keyword">elif</span> op.type == MINUS:</span><br><span class="line">	self.eat(MINUS)</span><br><span class="line"><span class="keyword">elif</span> op.type == MULTIPLY:</span><br><span class="line">	self.eat(MULTIPLY)</span><br><span class="line"><span class="keyword">elif</span> op.type == DIVIDE:</span><br><span class="line">	self.eat(DIVIDE)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	self.error()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹è®¡ç®—ç»“æœé‚£é‡Œ</span></span><br><span class="line"><span class="keyword">if</span> op.type == PLUS:</span><br><span class="line">	result = left.value + right.value</span><br><span class="line"><span class="keyword">elif</span> op.type == MINUS:</span><br><span class="line">	result = left.value - right.value</span><br><span class="line"><span class="keyword">elif</span> op.type == MULTIPLY:</span><br><span class="line">	result = left.value * right.value</span><br><span class="line"><span class="keyword">elif</span> op.type == DIVIDE:</span><br><span class="line">	result = left.value / right.value</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	self.error()</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¿®æ”¹ä»£ç ä»¥ä½¿å®ƒå¯ä»¥è§£é‡ŠåŒ…å«ä»»æ„ä¸ªæ•°å­—çš„åŠ å‡æ“ä½œï¼Œå¦‚â€œ9 - 5 + 3 + 11â€</p>
<p>è¿™ä¸ªä¹Ÿä¸éš¾ã€‚æ­¤æ—¶çš„è¯æ³•ç»“æ„æ˜¯<code>INTEGER -&gt; å¾ªç¯[OP -&gt;INTEGER]</code>ï¼Œåœ¨<code>expr()</code>é‡Œé¦–å…ˆè¯»å–å¹¶<code>eat()</code>ç¬¬ä¸€ä¸ªè¯æ³•å•å…ƒï¼Œ<code>result</code>å…ˆç­‰äºè¿™ä¸ªå•å…ƒçš„å€¼ï¼Œæ¥ä¸‹æ¥ç”¨<code>while</code>è¿›è¡Œä¸¤ä¸ªè¯æ³•å•å…ƒä¸ºä¸€ç»„çš„å¾ªç¯ï¼Œç›´åˆ°è¯»å–åˆ°<code>EOF</code>ï¼Œæ¯ä¸ªå¾ªç¯é‡Œï¼Œ<code>result</code>ä¸æ–°çš„<code>INTEGER</code>è¿›è¡ŒåŠ å‡è¿ç®—ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹expr()</span></span><br><span class="line">result = left.value</span><br><span class="line"><span class="keyword">while</span> self.current_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">	op = self.current_token</span><br><span class="line">	<span class="keyword">if</span> op.type == PLUS:</span><br><span class="line">		self.eat(PLUS)</span><br><span class="line">	<span class="keyword">elif</span> op.type == MINUS:</span><br><span class="line">		self.eat(MINUS)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		self.error()</span><br><span class="line">	right = self.current_token</span><br><span class="line">	self.eat(INTEGER)</span><br><span class="line">	<span class="keyword">if</span> op.type == PLUS:</span><br><span class="line">		result += right.value</span><br><span class="line">	<span class="keyword">elif</span> op.type == MINUS:</span><br><span class="line">		result -= right.value</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		self.error()</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="æ£€æŸ¥ç†è§£"><a href="#æ£€æŸ¥ç†è§£" class="headerlink" title="æ£€æŸ¥ç†è§£"></a>æ£€æŸ¥ç†è§£</h2><ol>
<li><p>ä»€ä¹ˆæ˜¯ lexemeï¼Ÿ<br>lexeme æ˜¯ç»„æˆ token çš„ä¸€ä¸ªå­—ç¬¦åºåˆ—ã€‚ï¼ˆè¿™ä¸ªè¯ç¿»è¯‘è¿‡æ¥æ˜¯<strong>è¯ä½</strong>æˆ–<strong>è¯ç´ </strong>ï¼‰<br><code>token</code>å’Œ<code>lexeme</code>çš„å…³ç³»ç±»ä¼¼äºç±»å’Œå®ä¾‹ï¼ˆæˆ–è€…å¯¹è±¡ï¼‰ä¹‹é—´çš„å…³ç³»ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå˜é‡<code>a</code>å’Œ<code>b</code>ï¼Œå®ƒä»¬å±äºåŒä¸€ç§<code>token</code>ï¼š<code>identifier</code>ï¼Œè€Œ<code>a</code>çš„<code>lexeme</code>æ˜¯<code>a</code>ï¼Œ<code>b</code>çš„<code>lexeme</code>æ˜¯<code>b</code>ã€‚æ¯ä¸ªå…³é”®å­—æ˜¯ä¸€ç§<code>token</code>ã€‚<code>token</code>å¯ä»¥é™„å¸¦ä¸€ä¸ªå€¼å±æ€§ï¼Œä¾‹å¦‚å˜é‡<code>a</code>ï¼Œè°ƒç”¨<code>gettoken()</code>æ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ª<code>identifier</code>ç±»å‹çš„<code>token</code>ï¼Œå…¶å€¼å±æ€§æ˜¯<code>a</code>ã€‚</p>
</li>
<li><p>åœ¨ token æµä¸­æ‰¾åˆ°ç»“æ„çš„è¿‡ç¨‹å«ä»€ä¹ˆï¼Ÿæˆ–è€…è¿™ä¹ˆé—®ï¼Œåœ¨ token æµä¸­è¯†åˆ«å‡ºç‰¹å®šç»„åˆçš„è¿‡ç¨‹å«ä»€ä¹ˆï¼Ÿ<br>parsingï¼ˆç¿»è¯‘æ˜¯è¯­æ³•åˆ†ææˆ–å¥æ³•åˆ†æï¼‰</p>
</li>
<li><p>è§£é‡Šå™¨ï¼ˆç¼–è¯‘å™¨ï¼‰åš parsing å·¥ä½œçš„éƒ¨åˆ†å«ä»€ä¹ˆï¼Ÿ<br>parserï¼ˆä¹Ÿå°±æ˜¯è¯­æ³•åˆ†æå™¨ï¼‰</p>
</li>
</ol>
]]></content>
      <categories>
        <category>Let&#39;s Build A Simple Interpreter</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>ç¼–è¯‘åŸç†</tag>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>Let&#39;s Build A Simple Interpreterç¬”è®°[1]</title>
    <url>/2020/01/30/Let-s-Build-A-Simple-Interpreter%E7%AC%94%E8%AE%B0-1/</url>
    <content><![CDATA[<h2 id="è¯¾ç¨‹æ–‡æ¡£"><a href="#è¯¾ç¨‹æ–‡æ¡£" class="headerlink" title="è¯¾ç¨‹æ–‡æ¡£"></a>è¯¾ç¨‹æ–‡æ¡£</h2><p><a href="https://ruslanspivak.com/lsbasi-part1/" target="_blank" rel="noopener">åŸæ–‡</a></p>
<p><a href="https://feng-qi.github.io/2018/01/23/lets-build-a-simple-interpreter-part-01/" target="_blank" rel="noopener">ç¿»è¯‘</a></p>
<a id="more"></a>

<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Token types</span></span><br><span class="line"><span class="comment"># EOF (end-of-file) token is used to indicate that</span></span><br><span class="line"><span class="comment"># there is no more input left for lexical analysis</span></span><br><span class="line">INTEGER, PLUS, EOF = <span class="string">'INTEGER'</span>, <span class="string">'PLUS'</span>, <span class="string">'EOF'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Token</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, type, value)</span>:</span></span><br><span class="line">        <span class="comment"># token type: INTEGER, PLUS, or EOF</span></span><br><span class="line">        self.type = type</span><br><span class="line">        <span class="comment"># token value: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, '+', or None</span></span><br><span class="line">        self.value = value</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""String representation of the class instance.</span></span><br><span class="line"><span class="string">        Examples:</span></span><br><span class="line"><span class="string">        Token(INTEGER, 3)</span></span><br><span class="line"><span class="string">        Token(PLUS, '+')</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'Token(&#123;type&#125;, &#123;value&#125;)'</span>.format(</span><br><span class="line">            type=self.type,</span><br><span class="line">            value=repr(self.value)</span><br><span class="line">        )    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.__str__()</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Interpreter</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, text)</span>:</span></span><br><span class="line">        <span class="comment"># client string input, e.g. "3+5"</span></span><br><span class="line">        self.text = text</span><br><span class="line">        <span class="comment"># self.pos is an index into self.text</span></span><br><span class="line">        self.pos = <span class="number">0</span></span><br><span class="line">        <span class="comment"># current token instance</span></span><br><span class="line">        self.current_token = <span class="literal">None</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">error</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">'Error parsing input'</span>)    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_next_token</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Lexical analyzer (also known as scanner or tokenizer)</span></span><br><span class="line"><span class="string">        This method is responsible for breaking a sentence</span></span><br><span class="line"><span class="string">        apart into tokens. One token at a time.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        text = self.text    </span><br><span class="line">        <span class="comment"># is self.pos index past the end of the self.text ?</span></span><br><span class="line">        <span class="comment"># if so, then return EOF token because there no more</span></span><br><span class="line">        <span class="comment"># input left to convert into tokens</span></span><br><span class="line">        <span class="keyword">if</span> self.pos &gt; len(text) - <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> Token(EOF, <span class="literal">None</span>)    </span><br><span class="line">        <span class="comment"># get a character at the position self.pos and decide</span></span><br><span class="line">        <span class="comment"># what token to create based on the single character</span></span><br><span class="line">        current_char = text[self.pos]    </span><br><span class="line">        <span class="comment"># if the character is a digit then convert it to</span></span><br><span class="line">        <span class="comment"># integer, create an INTEGER token, increment self.pos</span></span><br><span class="line">        <span class="comment"># index to point to the next character after the digit,</span></span><br><span class="line">        <span class="comment"># and return the INTEGER token</span></span><br><span class="line">        <span class="keyword">if</span> current_char.isdigit():</span><br><span class="line">            token = Token(INTEGER, int(current_char))</span><br><span class="line">            self.pos += <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> token    </span><br><span class="line">        <span class="keyword">if</span> current_char == <span class="string">'+'</span>:</span><br><span class="line">            token = Token(PLUS, current_char)</span><br><span class="line">            self.pos += <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> token    </span><br><span class="line">        self.error()    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">eat</span><span class="params">(self, token_type)</span>:</span></span><br><span class="line">        <span class="comment"># compare the current token type with the passed token</span></span><br><span class="line">        <span class="comment"># type and if they match then "eat" the current token</span></span><br><span class="line">        <span class="comment"># and assign the next token to the self.current_token,</span></span><br><span class="line">        <span class="comment"># otherwise raise an exception.</span></span><br><span class="line">        <span class="keyword">if</span> self.current_token.type == token_type:</span><br><span class="line">            self.current_token = self.get_next_token()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.error()    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">expr</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""expr -&gt; INTEGER PLUS INTEGER"""</span></span><br><span class="line">        <span class="comment"># set current token to the first token taken from the input</span></span><br><span class="line">        self.current_token = self.get_next_token()    </span><br><span class="line">        <span class="comment"># we expect the current token to be a single-digit integer</span></span><br><span class="line">        left = self.current_token</span><br><span class="line">        self.eat(INTEGER)    </span><br><span class="line">        <span class="comment"># we expect the current token to be a '+' token</span></span><br><span class="line">        op = self.current_token</span><br><span class="line">        self.eat(PLUS)    </span><br><span class="line">        <span class="comment"># we expect the current token to be a single-digit integer</span></span><br><span class="line">        right = self.current_token</span><br><span class="line">        self.eat(INTEGER)</span><br><span class="line">        <span class="comment"># after the above call the self.current_token is set to</span></span><br><span class="line">        <span class="comment"># EOF token    </span></span><br><span class="line">        <span class="comment"># at this point INTEGER PLUS INTEGER sequence of tokens</span></span><br><span class="line">        <span class="comment"># has been successfully found and the method can just</span></span><br><span class="line">        <span class="comment"># return the result of adding two integers, thus</span></span><br><span class="line">        <span class="comment"># effectively interpreting client input</span></span><br><span class="line">        result = left.value + right.value</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># To run under Python3 replace 'raw_input' call with 'input'</span></span><br><span class="line">            text = input(<span class="string">'calc&gt; '</span>)</span><br><span class="line">        <span class="keyword">except</span> EOFError:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> text:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        interpreter = Interpreter(text)</span><br><span class="line">        result = interpreter.expr()</span><br><span class="line">        print(result)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>




<h2 id="ç¬”è®°"><a href="#ç¬”è®°" class="headerlink" title="ç¬”è®°"></a>ç¬”è®°</h2><ol>
<li>è¯æ³•åˆ†æ(lexical analysis)ï¼šæŠŠè¾“å…¥å­—ç¬¦ä¸²æ‹†åˆ†æˆ token çš„è¿‡ç¨‹ã€‚è§£é‡Šå™¨ä¸­åšè¿™ä¸ªå·¥ä½œçš„éƒ¨åˆ†è¢«ç§°ä¸º <strong>è¯æ³•åˆ†æå™¨</strong>(lexical analyzer)ï¼Œç®€ç§° <strong>lexer</strong> ï¼Œä¹Ÿè¢«ç§°ä½œ  <strong>scanner</strong> æˆ– <strong>tokenizer</strong> ã€‚</li>
<li>åœ¨å®Œæˆè¯æ³•åˆ†æåï¼Œè§£é‡Šå™¨éœ€è¦éªŒè¯tokenåºåˆ—æ˜¯å¦ç¬¦åˆæœŸæœ›çš„åºåˆ—ï¼Œå¦‚æœç¬¦åˆï¼Œåˆ™è¿›è¡Œä¸€äº›è¿ç®—ï¼Œä¸ç¬¦åˆåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</li>
</ol>
<h4 id="ä»£ç åˆ†æ"><a href="#ä»£ç åˆ†æ" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h4><ol>
<li>ç›®çš„æ˜¯æ‰§è¡Œä¸€ä½æ•°çš„åŠ æ³•è¿ç®—ï¼Œæ•´ä½“é€»è¾‘æ˜¯ï¼Œå…ˆå–ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯æ•°å­—ï¼Œå¦‚æœæ˜¯ï¼Œå°±æŠŠè¿™ä¸ªæ•°å­—å­˜åœ¨<code>left</code>ä¸­ï¼Œç„¶åå–ç¬¬äºŒä¸ªå­—ç¬¦ï¼Œåˆ¤è¯»æ˜¯å¦ä¸ºåŠ å·ï¼Œå¦‚æœæ˜¯ï¼Œå†ç»§ç»­å–ç¬¬ä¸‰ä¸ªå­—ç¬¦ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºæ•°å­—å¹¶æŠŠæ•°å­—å­˜åœ¨<code>right</code>ä¸­ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥è®¡ç®—<code>left.value + right.value</code>äº†ã€‚æ•´ä¸ªè¿‡ç¨‹ä¸­å­—ç¬¦çš„ç§»åŠ¨ä¾é ä¸€ä¸ªåä¸º<code>pos</code>çš„å˜é‡ï¼Œå®ƒä½œä¸ºç´¢å¼•ï¼Œæ¯å½“å–å®Œä¸€ä¸ªå­—ç¬¦ï¼Œ<code>pos</code>çš„å€¼å°±ä¼š<code>+1</code>ï¼Œè¿™æ ·ç›´åˆ°æœ€åä¸€ä¸ªå­—ç¬¦ã€‚</li>
<li><code>Token</code>ç±»æ„é€ äº†ä¸€ä¸ªç»“æ„ä¸º<code>(ç±»å‹, å€¼)</code>çš„å˜é‡ï¼Œå½“æˆ‘ä»¬è®¿é—®æŸä¸ª<code>Token</code>ç±»å‹çš„å˜é‡<code>v</code>æ—¶ï¼Œå¯ä»¥é€šè¿‡<code>v.type</code>æ¥è·å–å®ƒçš„ç±»å‹ï¼Œé€šè¿‡<code>v.value</code>è·å–å®ƒçš„å€¼ã€‚</li>
<li><code>Interpreter</code>ç±»æ˜¯æˆ‘ä»¬çš„è§£é‡Šå™¨ç±»å‹ï¼Œå…¶ä¸­<code>get_next_token()</code>å‡½æ•°å¯ä»¥ä»å­—ç¬¦ä¸²ä¸­å–ä¸€ä¸ªå­—ç¬¦ï¼Œåˆ¤æ–­è¯¥å­—ç¬¦ç±»å‹æ˜¯æ•°å­—è¿˜æ˜¯<code>+</code>ï¼Œå¹¶è¿”å›æ­£ç¡®çš„<code>Token</code>ç»“æ„ï¼Œæ¯”å¦‚æ˜¯æ•°å­—ï¼Œå°±è¿”å›<code>Token(INTEGER, int(current_char))</code>ï¼Œç„¶åç´¢å¼•(<code>pos</code>)å¾€åæŒªä¸€ä½ï¼Œå¦‚æœæ—¢ä¸æ˜¯æ•°å­—ä¹Ÿä¸æ˜¯åŠ å·ï¼Œæ¯”å¦‚æ˜¯ç©ºæ ¼ï¼Œå°±ä¼šæŠ¥é”™ï¼Œå¦‚æœå·²ç»åˆ°æœ€åä¸€ä½äº†ï¼Œä¼šè¿”å›<code>EOF</code>ã€‚</li>
<li>æ¥ä¸‹æ¥çš„<code>eat()</code>å‡½æ•°ï¼Œå‚æ•°æ˜¯åˆ¤æ–­ç°åœ¨å–å‡ºæ¥çš„å­—ç¬¦<code>type</code>æ˜¯å¦ç¬¦åˆè®¾æƒ³çš„<code>type</code>ï¼Œå¦‚æœç¬¦åˆï¼Œå°±è°ƒç”¨<code>get_next_token()</code>å–ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼›åä¹‹ï¼Œå°±è¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚</li>
<li>ç„¶å<code>expr()</code>å‡½æ•°ç”¨æ¥æŒ‰é¡ºåºä»å¤´åˆ°å°¾é€ä¸ªè¯»å–å­—ç¬¦ï¼Œåœ¨<code>eat()</code>çš„å¸®åŠ©ä¸‹åˆ¤æ–­æ•´ä½“ç»“æ„æ˜¯å¦ç¬¦åˆè¯æ³•è¦æ±‚ï¼ˆæ¯”å¦‚è¿™é‡Œçš„è¦æ±‚æ˜¯<code>INTEGER -&gt; + INTEGER</code>ï¼‰å¹¶æ‰§è¡Œè¿ç®—ã€‚</li>
<li>æœ€åçš„<code>main()</code>ï¼Œå°†è¾“å…¥çš„å­—ç¬¦ä¸²å­˜åˆ°<code>text</code>ä¸­ï¼Œå¹¶ç”¨<code>text</code>åˆå§‹åŒ–ç±»å‹ä¸º<code>Interpreter</code>çš„å˜é‡<code>interpreter</code>ï¼Œæ¥ä¸‹æ¥è°ƒç”¨<code>interpreter.expr()</code>è¿›è¡Œè®¡ç®—ï¼Œç»“æœå­˜æ”¾åˆ°<code>result</code>ä¸­å¹¶è¾“å‡ºã€‚</li>
</ol>
<h4 id="pythonç›¸å…³"><a href="#pythonç›¸å…³" class="headerlink" title="pythonç›¸å…³"></a>pythonç›¸å…³</h4><ol>
<li><p>pythonå‘½åè§„åˆ™ï¼šä»¥ä¸‹åˆ’çº¿å¼€å¤´çš„æ ‡è¯†ç¬¦æ˜¯æœ‰ç‰¹æ®Šæ„ä¹‰çš„ã€‚ä»¥å•ä¸‹åˆ’çº¿å¼€å¤´ä¾‹å¦‚<code>_foo</code> ä»£è¡¨ä¸èƒ½ç›´æ¥è®¿é—®çš„ç±»å±æ€§ï¼Œéœ€é€šè¿‡ç±»æä¾›çš„æ¥å£è¿›è¡Œè®¿é—®ï¼Œä¸èƒ½ç”¨ <code>from xxx import</code> è€Œå¯¼å…¥ã€‚<br> ä»¥åŒä¸‹åˆ’çº¿å¼€å¤´çš„ <code>__foo</code> ä»£è¡¨ç±»çš„ç§æœ‰æˆå‘˜ï¼Œä»¥åŒä¸‹åˆ’çº¿å¼€å¤´å’Œç»“å°¾çš„ <code>__foo__</code> ä»£è¡¨ Python é‡Œç‰¹æ®Šæ–¹æ³•ä¸“ç”¨çš„æ ‡è¯†ï¼Œå¦‚ <code>__init__()</code> ä»£è¡¨ç±»çš„æ„é€ å‡½æ•°ã€‚</p>
</li>
<li><p>pythonä¸­çš„<code>main()</code>å‡½æ•°ï¼špythonç¨‹åºæŒ‰é¡ºåºæ‰§è¡Œï¼Œè€Œä¸æ˜¯åƒä¹‹å‰å­¦è¿‡çš„è¯­è¨€é‚£æ ·å…ˆæ‰¾<code>main()</code>ç„¶åä»<code>main()</code>å¼€å§‹ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°<code>def</code>ä»£ç å—ä¼šå…ˆè·³è¿‡ï¼Œæ¯ä¸ªä»£ç å—éœ€è¦ä¿æŒç›¸åŒçš„ç¼©è¿›ã€‚</p>
<p> ä¾‹å¦‚ï¼š</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># code1</span></span><br><span class="line">print(<span class="string">"test"</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">    str = <span class="string">"function"</span></span><br><span class="line">    print(str)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(<span class="string">"main"</span>)</span><br><span class="line">    foo()</span><br><span class="line"><span class="comment"># output</span></span><br><span class="line">test</span><br><span class="line">main</span><br><span class="line">function</span><br><span class="line"></span><br><span class="line"><span class="comment"># code2</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:  </span><br><span class="line">    print(<span class="string">"Hello python !!!"</span>)    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func_print</span><span class="params">()</span>:</span>  </span><br><span class="line">        print(<span class="string">"in func_print"</span>)   </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span>  </span><br><span class="line">        print(<span class="string">"In main"</span>)    </span><br><span class="line">    main()  </span><br><span class="line"><span class="comment"># output</span></span><br><span class="line">Hello python !!!</span><br><span class="line">In main</span><br><span class="line"></span><br><span class="line"><span class="comment"># code3</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(<span class="string">"Hello python !!!"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func_print</span><span class="params">()</span>:</span></span><br><span class="line">        print(<span class="string">"in func_print"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">        print(<span class="string">"In main"</span>)</span><br><span class="line"></span><br><span class="line">        func_print()</span><br><span class="line">main()</span><br><span class="line"><span class="comment"># output</span></span><br><span class="line">Hello python !!!</span><br><span class="line">In main</span><br><span class="line"><span class="keyword">in</span> func_print</span><br><span class="line"></span><br><span class="line"><span class="comment">#code4</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(<span class="string">"Hello python !!!"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func_print</span><span class="params">()</span>:</span></span><br><span class="line">        print(<span class="string">"in func_print"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">        print(<span class="string">"In main"</span>)</span><br><span class="line"></span><br><span class="line">	func_print()</span><br><span class="line">main()</span><br><span class="line"><span class="comment"># output </span></span><br><span class="line">Hello python !!!</span><br><span class="line"><span class="keyword">in</span> func_print</span><br><span class="line">In main</span><br></pre></td></tr></table></figure>
</li>
<li><p>pythonä¸­çš„<code>__name__</code>ï¼š<code>__name__</code>æ˜¯pythonçš„ä¸€ä¸ªå†…ç½®ç±»å±æ€§ï¼Œå®ƒå¤©ç”Ÿå°±å­˜åœ¨äºä¸€ä¸ª python ç¨‹åºä¸­ï¼Œä»£è¡¨å¯¹åº”ç¨‹åºåç§°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">def test()</span><br><span class="line">	print(__name__)</span><br><span class="line">test</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥è¿è¡Œtemp2.py æ—¶ï¼š<code>__name__=&quot;__main__&quot;</code>ï¼Œåœ¨å…¶å®ƒç¨‹åºä¸­å¯¼å…¥temp2.pyï¼Œåˆ™ï¼š<code>__name__=&quot;temp2.py&quot;</code>ï¼Œæ‰€ä»¥<code>__name__</code>çš„ä¸»è¦ä½œç”¨å°±æ˜¯ç”¨æ¥åŒºåˆ†ï¼Œæ¨¡å—æ˜¯ç›´æ¥è¢«è¿è¡Œè¿˜æ˜¯è¢«å¯¼å…¥ã€‚</p>
<p>å®é™…ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬ä¼šæŠŠæµ‹è¯•æ¨¡å—æ—¶è¦æ‰§è¡Œçš„è¯­å¥æ”¾åˆ°<code>if __name__ == &#39;__main__&#39;:</code>è¿™ä¸ªä»£ç å—é‡Œï¼Œè¿™æ ·æµ‹è¯•çš„æ—¶å€™èƒ½çœ‹åˆ°æµ‹è¯•ç»“æœï¼Œè€Œè°ƒç”¨çš„æ—¶å€™ï¼Œæµ‹è¯•è¯­å¥ä¸ä¼šè¢«æ‰§è¡Œï¼Œä¹Ÿå°±ä¸ç”¨åˆ é™¤æµ‹è¯•è¯­å¥ã€‚</p>
</li>
</ol>
<h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><ol>
<li><p>ä¿®æ”¹ä»£ç ä½¿å¾—å…è®¸è¾“å…¥å¤šä½æ•´æ•°ï¼Œä¾‹å¦‚<code>12+3</code></p>
<p>å¤šä½æ•°ä¸ä¸€å®šæ˜¯å‡ ä½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åœ¨å¾—åˆ°è¾“å…¥ä¹‹å‰æ— æ³•åˆ¤æ–­æ•´ä¸ªå­—ç¬¦ä¸²ç¬¬å‡ ä½æ˜¯ä»€ä¹ˆç±»å‹ï¼Œä½†æ˜¯æ•´ä½“ç»“æ„ä¸€å®šæ˜¯<code>è¿åœ¨ä¸€èµ·çš„æ•°å­— + è¿åœ¨ä¸€èµ·çš„æ•°å­—</code>ï¼Œå› æ­¤è€ƒè™‘ç”¨<code>while</code>å¾ªç¯è¯»å–æ•°å­—ï¼Œåœ¨å½“å‰å­—ç¬¦ä¸æ˜¯æ•°å­—çš„æƒ…å†µä¸‹è·³å‡ºå¾ªç¯å»è¯»å–<code>+</code>ï¼Œç„¶åç»§ç»­å¾ªç¯è¯»æ•°å­—ï¼Œç›´åˆ°è¯»å–å‡º<code>EOF</code>ï¼Œå­—ç¬¦ä¸²ç»“æŸã€‚å…·ä½“æ¥è¯´æ˜¯å£°æ˜<code>left</code>å’Œ<code>right</code>ä¸¤ä¸ªæ•°å­—å¹¶åˆå§‹åŒ–ä¸º0ï¼Œç„¶å<code>left</code>å­˜ç¬¬ä¸€ä½æ•°å­—ï¼Œæ¥ä¸‹æ¥ä¹˜10+ç¬¬äºŒä½æ•°å­—ï¼Œå†ä¹˜10+ç¬¬ä¸‰ä½æ•°å­—ï¼Œä¾æ¬¡å¾ªç¯ï¼›<code>right</code>ä¹Ÿæ˜¯è¿™æ ·ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹expr()</span></span><br><span class="line">left = right = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> self.current_token.type == <span class="string">'INTEGER'</span>:    </span><br><span class="line">	left = left * <span class="number">10</span> + self.current_token.value    </span><br><span class="line">	self.eat(INTEGER)</span><br><span class="line"><span class="comment"># ä¸­é—´å‡ è¡Œä»£ç çœç•¥</span></span><br><span class="line"><span class="keyword">while</span> self.current_token.type != <span class="string">'EOF'</span>:</span><br><span class="line">	right = right * <span class="number">10</span> + self.current_token.value</span><br><span class="line">	self.eat(INTEGER)</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¢åŠ ä¸€ä¸ªè·³è¿‡ç©ºç™½ç¬¦çš„æ–¹æ³•ï¼Œä½¿ä½ çš„è®¡ç®—å™¨å¯ä»¥å¤„ç†åŒ…å«ç©ºç™½ç¬¦çš„è¾“å…¥å¦‚<code>12 + 3</code></p>
<p>æˆ‘ä»¬è¦å¢åŠ ä¸€ä¸ª<code>Token</code>ç±»å‹ç”¨æ¥è¯†åˆ«ç©ºæ ¼ï¼Œç„¶ååœ¨<code>expr()</code>ä¸­è¯»å–åˆ°ç©ºæ ¼æ—¶å°±è°ƒç”¨<code>eat()</code>æ¥è·³è¿‡ï¼Œæˆ‘ä»¬å‡è®¾ç©ºæ ¼ä¸ä¼šå‡ºç°åœ¨ä¸€ä¸ªå¤šä½æ•°çš„ä¸­é—´ï¼ˆæ¯”å¦‚<code>1 2 3</code>å°±ä¼šæŠ¥é”™)ã€‚</p>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åœ¨ä»£ç å¼€å§‹çš„åœ°æ–¹åŠ </span></span><br><span class="line">SPACE = <span class="string">'SPACE'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨get_next_token()é‡ŒåŠ </span></span><br><span class="line"><span class="keyword">if</span> current_char == <span class="string">' '</span>:</span><br><span class="line">	token = Token(SPACE, current_char)</span><br><span class="line">	self.pos += <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> token</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨expr()çš„æ•°å­—å’Œæ“ä½œç¬¦çš„å‰ååŠ </span></span><br><span class="line"><span class="keyword">while</span> self.current_token.value == <span class="string">' '</span>:</span><br><span class="line">	self.eat(SPACE)</span><br></pre></td></tr></table></figure>

<p><strong>è¿™é‡Œå­˜åœ¨ä¸€äº›é—®é¢˜éœ€è¦æ”¹è¿›</strong>ï¼š</p>
<ol>
<li>åº”è¯¥å¯ä»¥æƒ³åŠæ³•è·³è¿‡å¤šä½æ•°ä¸­é—´çš„ç©ºæ ¼ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥å¿½ç•¥æ‰€æœ‰ç©ºæ ¼ï¼›</li>
<li>ä¸ªäººè®¤ä¸ºä¸åº”è¯¥åœ¨<code>expr()</code>è¿™ä¸ªå‡½æ•°ä¸­å‡ºç°å¯¹å­—ç¬¦ç±»å‹çš„åˆ¤æ–­ï¼Œåº”è¯¥æ˜¯åœ¨<code>expr()</code>ä¸­é€ä½åç§»ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­è°ƒç”¨å…¶ä»–å‡½æ•°æ¥å¤„ç†å¿½ç•¥ç©ºæ ¼ç­‰æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¯´ä¸Šä¸€ä¸ªçš„<code>while</code>å¾ªç¯ä¹Ÿä¸å¤ªåˆé€‚ï¼Œä½†æ˜¯æˆ‘æš‚æ—¶æ²¡æƒ³åˆ°æ€ä¹ˆæ”¹ï¼Œå°±å…ˆè¿™æ ·å§ï¼Œåæ­£åŠŸèƒ½ä¸Šæ²¡é—®é¢˜ã€‚ä¹‹åå­¦åˆ°æ­£åˆ™ç›¸å…³çš„åœ°æ–¹å¯èƒ½ä¼šæœ‰æ–°çš„æ€è·¯ã€‚</li>
</ol>
</li>
<li><p>ä¿®æ”¹ä»£ç ä½¿å¾—å®ƒå¯ä»¥å¤„ç†<code>-</code>è€Œé<code>+</code>çš„æƒ…å†µ</p>
<p>è¿™ä¸ªç±»ä¼¼äºç©ºæ ¼ï¼Œä¹Ÿæ˜¯è¦æ·»åŠ ä¸€ä¸‹ï¼Œæˆ‘çš„åšæ³•æ˜¯ç›´æ¥æŠŠ<code>+</code>å’Œ<code>-</code>ç»Ÿä¸€æˆç±»å‹ä¸º<code>OP</code>å€¼ä¸ºå¯¹åº”å­—ç¬¦çš„<code>TOKEN</code>ï¼Œç„¶ååœ¨<code>expr()</code>ä¸­æœ€åè¿ç®—çš„æ—¶å€™ï¼Œåˆ¤æ–­è¯¥å˜é‡çš„å€¼æ˜¯ä»€ä¹ˆï¼Œå†æ‰§è¡Œå¯¹åº”çš„è¿ç®—ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ–‡ä»¶å¼€å¤´çš„PLUS = 'PLUS'ä¿®æ”¹ä¸º</span></span><br><span class="line">OP = <span class="string">'OP'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹get_next_token()</span></span><br><span class="line"><span class="keyword">if</span> current_char == <span class="string">'+'</span> <span class="keyword">or</span> current_char == <span class="string">'-'</span>:</span><br><span class="line">	token = Token(OP, current_char)</span><br><span class="line">	self.pos += <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> token</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹expr()</span></span><br><span class="line"><span class="keyword">if</span> op.value == <span class="string">'+'</span>:</span><br><span class="line">	result = left + right</span><br><span class="line"><span class="keyword">if</span> op.value == <span class="string">'-'</span>:</span><br><span class="line">	result = left - right</span><br></pre></td></tr></table></figure>



</li>
</ol>
<p>   <strong>ä¸‹ä¸€è¯¾çš„å†…å®¹è¯´æ˜äº†æˆ‘çš„æƒ³æ³•å…¨æ˜¯é”™çš„â€¦æš´é£å“­æ³£</strong></p>
<h2 id="æ£€æŸ¥ç†è§£"><a href="#æ£€æŸ¥ç†è§£" class="headerlink" title="æ£€æŸ¥ç†è§£"></a>æ£€æŸ¥ç†è§£</h2><ol>
<li><p>ä»€ä¹ˆæ˜¯è§£é‡Šå™¨ï¼Ÿ</p>
<p>è§£é‡Šå™¨æŠŠé«˜çº§è¯­è¨€é€è¡Œè½¬è¯‘æ‰§è¡Œã€‚</p>
</li>
<li><p>ä»€ä¹ˆæ˜¯ç¼–è¯‘å™¨ï¼Ÿ</p>
<p>ç¼–è¯‘å™¨æŠŠé«˜çº§è¯­è¨€ç¿»è¯‘æˆä½çº§è¯­è¨€ï¼Œå†ä¸€èµ·æ‰§è¡Œã€‚</p>
</li>
<li><p>è§£é‡Šå™¨å’Œç¼–è¯‘å™¨çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>ä¸€ä¸ªæ˜¯ä¸€è¾¹ç¿»è¯‘ä¸€è¾¹æ‰§è¡Œï¼Œä¸€ä¸ªæ˜¯ç¿»è¯‘å®Œå†æ‰§è¡Œã€‚</p>
</li>
<li><p>ä»€ä¹ˆæ˜¯ tokenï¼Ÿ</p>
<p>æœ‰ç±»å‹çš„å€¼çš„å¯¹è±¡</p>
</li>
<li><p>å°†è¾“å…¥æ‹†åˆ†æˆ token çš„è¿‡ç¨‹å«ä»€ä¹ˆï¼Ÿ</p>
<p>è¯æ³•åˆ†æ</p>
</li>
<li><p>è§£é‡Šå™¨ä¸­åšè¯æ³•åˆ†æçš„éƒ¨åˆ†å«ä»€ä¹ˆï¼Ÿ</p>
<p>è¯æ³•åˆ†æå™¨(lexical analyzer)</p>
</li>
<li><p>è§£é‡Šå™¨æˆ–ç¼–è¯‘å™¨çš„è¿™ä¸ªéƒ¨åˆ†è¿˜æœ‰ä»€ä¹ˆå…¶ä»–å¸¸è§çš„åå­—ï¼Ÿ</p>
<p>scanner æˆ– tokenizer</p>
</li>
</ol>
]]></content>
      <categories>
        <category>Let&#39;s Build A Simple Interpreter</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>ç¼–è¯‘åŸç†</tag>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo + next + githubé…ç½®blog</title>
    <url>/2020/01/30/hexo-next-github%E9%85%8D%E7%BD%AEblog/</url>
    <content><![CDATA[<h2 id="å®‰è£…å„ç§ä¸œè¥¿"><a href="#å®‰è£…å„ç§ä¸œè¥¿" class="headerlink" title="å®‰è£…å„ç§ä¸œè¥¿"></a>å®‰è£…å„ç§ä¸œè¥¿</h2><ol>
<li>node.jsï¼š<a href="https://nodejs.org/zh-cn/" target="_blank" rel="noopener">Node.jså®˜ç½‘é“¾æ¥</a> ç‚¹å‡»ä¸‹è½½å®‰è£…å³å¯ã€‚</li>
<li>Gitï¼š <a href="https://www.git-scm.com/download/win" target="_blank" rel="noopener">Gitå®˜ç½‘é“¾æ¥</a> ç‚¹å‡»ä¸‹è½½å®‰è£…å³å¯ã€‚</li>
<li>deployer-gitï¼š å‘½ä»¤è¡Œé‡Œè¾“å…¥<code>npm install hexo-deployer-git --save</code>ã€‚</li>
<li>Hexoï¼š<ol>
<li>å‡†å¤‡å¥½ä¸€ä¸ªç”¨äºå­˜æ”¾åšå®¢æ–‡ä»¶çš„æ–‡ä»¶å¤¹ï¼ˆæ¯”å¦‚Githubï¼‰ï¼Œåœ¨è¯¥æ–‡ä»¶å¤¹çš„æ ¹ç›®å½•ä¸‹è¿è¡Œåˆšæ‰è£…å®Œgitä»¥åä¼šå‡ºç°çš„git-bash.exeï¼ˆè¿™é‡Œå…¶å®ç›´æ¥ç”¨cmdè¿›å…¥å‘½ä»¤è¡Œç„¶åè¿›å…¥åšå®¢æ–‡ä»¶å¤¹ä¹Ÿå¯ä»¥ï¼‰ï¼›</li>
<li>è¾“å…¥å‘½ä»¤<code>npm install -g hexo-cli</code></li>
</ol>
</li>
</ol>
<a id="more"></a>

<h2 id="åˆå§‹åŒ–Hexo"><a href="#åˆå§‹åŒ–Hexo" class="headerlink" title="åˆå§‹åŒ–Hexo"></a>åˆå§‹åŒ–Hexo</h2><ol>
<li>åˆ›å»ºHexoå·¥ç¨‹ï¼šæ¥ç€åˆšæ‰é‚£ä¸ªå‘½ä»¤è¾“å…¥<code>hexo init blog</code>ï¼Œè¿™é‡Œä¼šåœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªblogæ–‡ä»¶å¤¹ï¼Œå¦‚æœæŠŠblogæ¢æˆå…¶ä»–åå­—ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</li>
<li>æ–°å»ºPostï¼šå‘½ä»¤è¡Œé‡Œè¿›å…¥blogæ–‡ä»¶å¤¹ï¼ˆ<code>cd blog</code>ï¼‰ï¼Œè¾“å…¥<code>hexo new â€œHelloWorldâ€</code>ï¼Œè¿™é‡Œä¼šåœ¨ <strong>/blog/sources/_post/</strong> ç›®å½•ä¸‹ç”Ÿæˆ <strong>HelloWorld.md</strong> æ–‡ä»¶ï¼Œå¯ä»¥è¿›å»æ‰“å¼€ç¼–è¾‘å†…å®¹ï¼Œåœ¨ä¹‹åæƒ³å†™æ–°åšå®¢ä¹Ÿæ˜¯é€šè¿‡è¿™ä¸ªå‘½ä»¤ç”Ÿæˆæ–‡ä»¶ï¼Œæˆ–è€…ç›´æ¥æŠŠå†™å¥½çš„åšå®¢æ–‡ä»¶æ”¾åˆ°è¯¥ç›®å½•ä¸‹ã€‚</li>
<li>ç”Ÿæˆé™æ€æ–‡ä»¶ï¼šå‘½ä»¤è¡Œé‡Œè¾“å…¥<code>hexo generate</code>ï¼Œä¹Ÿå¯ä»¥ç®€å•åœ°å†™æˆ<code>hexo g</code>ã€‚è¿™æ ·å°±ä½¿ç”¨ <strong>Hexo</strong> å¼•æ“å°† <strong>Markdown</strong> æ ¼å¼çš„æ–‡ä»¶è§£ææˆå¯ä»¥ä½¿ç”¨æµè§ˆå™¨æŸ¥çœ‹çš„ <strong>HTML</strong> æ–‡ä»¶ï¼Œ<strong>HTML</strong> æ–‡ä»¶å­˜å‚¨åœ¨ <strong>blog/public</strong> ç›®å½•ä¸‹ã€‚</li>
<li>è¿è¡ŒHexoæœåŠ¡å™¨ï¼šå‘½ä»¤è¡Œé‡Œè¾“å…¥<code>hexo server</code>ï¼Œä¹Ÿå¯ä»¥ç®€å†™æˆ<code>hexo s</code>ã€‚è¿™æ—¶å‘½ä»¤è¡Œä¼šæœ‰ä¸€äº›æç¤ºï¼Œå…¶ä¸­æœ‰ä¸ªåœ°å€ï¼Œä¸€èˆ¬æ˜¯<a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a> ï¼Œåœ¨æµè§ˆå™¨é‡Œæ‰“å¼€è¿™ä¸ªåœ°å€ï¼Œå°±èƒ½çœ‹åˆ°åšå®¢ç½‘ç«™æ˜¯ä»€ä¹ˆæ ·çš„äº†ã€‚ä¸è¿‡è¿™ä¸ªæ—¶å€™è¿˜åªæ˜¯ä¸€ä¸ªæœ¬åœ°åšå®¢ã€‚</li>
</ol>
<h2 id="å®‰è£…ä¸»é¢˜"><a href="#å®‰è£…ä¸»é¢˜" class="headerlink" title="å®‰è£…ä¸»é¢˜"></a>å®‰è£…ä¸»é¢˜</h2><p><strong>Hexo</strong> æä¾›äº†é»˜è®¤ä¸»é¢˜ <strong>landscape</strong>ï¼Œä¸»é¢˜çš„ä½ç½®åœ¨ <strong>blog -&gt;themes</strong> æ–‡ä»¶å¤¹ä¸‹ã€‚ä¸»é¢˜æ ¹æ®è‡ªå·±å–œå¥½å¯ä»¥åœ¨ç½‘ä¸Šæ‰¾åˆ°ï¼Œé€šè¿‡ <strong>Git</strong> è¿›è¡Œç›¸åº”çš„ä¸‹è½½ã€‚æ¥ä¸‹æ¥ä»¥Nextä¸»é¢˜ä¸ºä¾‹ã€‚</p>
<ol>
<li>è¿˜æ˜¯åœ¨blogæ–‡ä»¶å¤¹ä¸‹ï¼Œå‘½ä»¤è¡Œé‡Œè¾“å…¥<code>git clone https://github.com/theme-next/hexo-theme-next themes/next</code>ï¼Œè¿™é‡Œæ˜¯ç”¨<code>git clone</code>æŠŠ<a href="https://github.com/theme-next/hexo-theme-next" target="_blank" rel="noopener">nextä¸»é¢˜</a>ä¸‹è½½å¹¶å­˜æ”¾åˆ°themes -&gt; next æ–‡ä»¶å¤¹é‡Œã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>git clone</code>è¿™ä¸ªå‘½ä»¤ä¸‹è½½èµ·æ¥ç‰¹åˆ«æ…¢ï¼Œä½†æµè§ˆå™¨ç›´æ¥å»githubä¸‹è½½çš„è¯é€Ÿåº¦è¿˜è¡Œï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç›´æ¥ä¸‹è½½è§£å‹æ”¹æ–‡ä»¶å¤¹çš„åå­—å¹¶æ”¾åˆ°å¯¹åº”çš„åœ°æ–¹ã€‚</li>
<li>ä¿®æ”¹ <strong>/blog/config.yml</strong> æ–‡ä»¶ï¼Œå°†å…¶ä¸­çš„ <strong>theme</strong> æ”¹æˆ <strong>next</strong>ã€‚å¦‚æœæ–‡ä»¶å¤¹çš„åå­—ä¸æ˜¯nextï¼Œæˆ–è€…ç”¨äº†å…¶ä»–ä¸»é¢˜ç­‰ï¼Œè¿™é‡Œçš„themeæ”¹æˆå¯¹åº”çš„æ–‡ä»¶å¤¹åå­—å°±è¡Œã€‚</li>
<li>æ¥ä¸‹æ¥å¯ä»¥è¾“å…¥<code>hexo g</code> å’Œ<code>hexo s</code>æ¥æŸ¥çœ‹æ–°çš„æœ¬åœ°åšå®¢ã€‚</li>
</ol>
<h2 id="å»ºç«‹Githubåšå®¢"><a href="#å»ºç«‹Githubåšå®¢" class="headerlink" title="å»ºç«‹Githubåšå®¢"></a>å»ºç«‹Githubåšå®¢</h2><ol>
<li><p>åœ¨<a href="https://github.com/" target="_blank" rel="noopener">Githubå®˜ç½‘</a>æ³¨å†Œè´¦å·å¹¶ç™»é™†ï¼Œç‚¹é¦–é¡µå³ä¸Šè§’çš„åŠ å·æ–°å»ºä¸€ä¸ªä»“åº“(Repository)ï¼Œä»“åº“çš„åå­—ä¸ºç”¨æˆ·å.github.ioï¼ˆæ¯”å¦‚æˆ‘çš„æ˜¯kun-bin.github.ioï¼‰ï¼Œè¿™é‡Œä¸€å®šè¦æ˜¯è¿™ä¸ªæ ¼å¼ï¼Œä¸ç„¶ä¹‹åæ²¡æ³•ç›´æ¥è®¿é—®åšå®¢ç½‘ç«™ã€‚ç„¶åå…¶ä»–çš„éƒ½æ˜¯é»˜è®¤å†…å®¹ï¼Œç‚¹create repositoryå°±å¯ä»¥äº†ã€‚å¦‚æœä»“åº“åå­—è¾“å…¥é”™äº†ï¼Œä¹‹åå¯ä»¥åœ¨githubä¸Šè¿™ä¸ªä»“åº“é¡µé¢çš„settingé€‰é¡¹ä¸­ä¿®æ”¹ã€‚</p>
</li>
<li><p>æ‰“å¼€ <strong>/blog/config.yml</strong>æ–‡ä»¶ä¿®æ”¹deploy å±æ€§(æ³¨æ„â€œï¼šâ€ä¹‹åæœ‰ç©ºæ ¼ ) å¦åˆ™é…ç½®å¤±è´¥ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: https:&#x2F;&#x2F;github.com&#x2F;kun-bin&#x2F;kun-bin.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„è¿™é‡Œrepositoryè¦æ›¿æ¢æˆè‡ªå·±çš„ä»“åº“åœ°å€ã€‚</p>
</li>
<li><p>åˆå§‹åŒ–æœ¬åœ°ä»“åº“ï¼šåœ¨blogæ–‡ä»¶å¤¹ä¸‹çš„å‘½ä»¤è¡Œè¾“å…¥<code>git init</code></p>
</li>
<li><p>è¿æ¥è¿œç¨‹ä»“åº“ï¼šå‘½ä»¤è¡Œæ¥ç€è¾“å…¥<code>git remote add origin https://github.com/kun-bin/kun-bin.github.io.git</code>ï¼Œè¿™é‡Œè®°å¾—æŠŠåœ°å€æ”¹æˆè‡ªå·±çš„ä»“åº“åœ°å€ï¼Œç¬¬ä¸€æ¬¡çš„æ—¶å€™ä¼šè¦æ±‚è¾“å…¥githubçš„è´¦å·å¯†ç ã€‚</p>
</li>
<li><p>å‘å¸ƒåšå®¢é¡µé¢ï¼šå‘½ä»¤è¡Œé‡Œè¾“å…¥<code>hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</code>ï¼Œè¿™ç­‰äºä¸€æ¬¡æ€§æ‰§è¡Œäº†æ¸…ç©ºã€åˆ·æ–°ã€éƒ¨ç½²ä¸‰ä¸ªå‘½ä»¤ï¼Œæ­¤æ—¶åœ¨æµè§ˆå™¨é‡Œå·²ç»å¯ä»¥é€šè¿‡<code>ç”¨æˆ·å.github.io</code>è®¿é—®åšå®¢äº†ï¼Œåœ¨githubçš„è¿™ä¸ªä»“åº“é‡Œä¹Ÿèƒ½çœ‹åˆ°<strong>/blog/public</strong>æ–‡ä»¶å¤¹é‡Œçš„å†…å®¹ã€‚</p>
</li>
<li><p>å¯é€‰ï¼š<code>hexo d</code>åªæ˜¯æŠŠpublicæ–‡ä»¶å¤¹ä¸­çš„å†…å®¹ï¼ˆä¹Ÿå°±æ˜¯é™æ€ç½‘é¡µï¼‰ä¼ åˆ°äº†githubçš„ä»“åº“é‡Œï¼Œåº”è¯¥è¿˜å¯ä»¥å»ºç«‹åˆ†æ”¯æŠŠåšå®¢é…ç½®æ–‡ä»¶æ•´ä¸ªä¼ åˆ°githubä¸Šï¼Œä¸è¿‡æˆ‘æ²¡åšè¿™ä¸€æ­¥ã€‚</p>
</li>
</ol>
<h2 id="å…³äºnextä¸»é¢˜çš„é…ç½®"><a href="#å…³äºnextä¸»é¢˜çš„é…ç½®" class="headerlink" title="å…³äºnextä¸»é¢˜çš„é…ç½®"></a>å…³äºnextä¸»é¢˜çš„é…ç½®</h2><p>ç›®å‰åœ¨blogæ–‡ä»¶å¤¹é‡Œæœ‰ä¸€ä¸ªconfig.ymlæ–‡ä»¶ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºç«™ç‚¹é…ç½®æ–‡ä»¶ï¼›è€Œåœ¨themes/nextæ–‡ä»¶å¤¹é‡Œä¹Ÿæœ‰ä¸€ä¸ªconfig.ymlæ–‡ä»¶ï¼Œç§°ä¹‹ä¸ºä¸»é¢˜é…ç½®æ–‡ä»¶ã€‚</p>
<ol>
<li><p>åŸºæœ¬ä¿¡æ¯ï¼šæ‰“å¼€ç«™ç‚¹é…ç½®æ–‡ä»¶ï¼Œæ‰¾åˆ°siteæ¨¡å—ï¼Œå¯ä»¥ä¿®æ”¹åšå®¢æ ‡é¢˜ã€ä½œè€…ã€æè¿°ã€è¯­è¨€ç­‰ç­‰ä¿¡æ¯ï¼Œ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">title: æ ‡é¢˜</span><br><span class="line">subtitle: å‰¯æ ‡é¢˜</span><br><span class="line">description: æè¿°</span><br><span class="line">author: ä½œè€…</span><br><span class="line">language: è¯­è¨€ï¼ˆç®€ä½“ä¸­æ–‡æ˜¯zh-Hansï¼‰</span><br><span class="line">timezone: ç½‘ç«™æ—¶åŒºï¼ˆHexo é»˜è®¤ä½¿ç”¨æ‚¨ç”µè„‘çš„æ—¶åŒºï¼Œä¸ç”¨å†™ï¼‰</span><br></pre></td></tr></table></figure>
</li>
<li><p>èœå•é…ç½®ï¼šåˆå§‹ç½‘é¡µåªæœ‰ä¸¤ä¸ªèœå•ï¼šhomeå’Œarchiveï¼Œå¯ä»¥æ‰“å¼€ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼Œæ‰¾åˆ°menuæ¨¡å—ï¼ŒæŠŠéœ€è¦çš„èœå•å‰é¢çš„#åˆ äº†ï¼Œå¹¶æ³¨æ„æŠŠ||<strong>å‰é¢</strong>çš„ç©ºæ ¼åˆ äº†ï¼Œä¸ç„¶å¯èƒ½ä¼šç‚¹äº†èœå•ä»¥åæŠ¥é”™ï¼ˆç±»ä¼¼Cannot GET /tags/%20/è¿™æ ·çš„é”™ï¼‰ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: /|| home                          <span class="comment">//é¦–é¡µ</span></span><br><span class="line">  archives: /archives/|| archive          <span class="comment">//å½’æ¡£</span></span><br><span class="line">  categories: /categories/|| th           <span class="comment">//åˆ†ç±»</span></span><br><span class="line">  tags: /tags/|| tags                     <span class="comment">//æ ‡ç­¾</span></span><br><span class="line">  about: /about/|| user                   <span class="comment">//å…³äº</span></span><br><span class="line">  <span class="meta">#schedule: /schedule/|| calendar        <span class="comment">//æ—¥ç¨‹è¡¨</span></span></span><br><span class="line">  <span class="meta">#sitemap: /sitemap.xml|| sitemap        <span class="comment">//ç«™ç‚¹åœ°å›¾</span></span></span><br><span class="line">  <span class="meta">#commonweal: /404/|| heartbeat          <span class="comment">//å…¬ç›Š404</span></span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œ||åé¢çš„å•è¯æ˜¯æŒ‡èœå•å¯¹åº”çš„å›¾æ ‡ï¼Œå¯ä»¥è‡ªå·±ä¿®æ”¹ã€‚æ­¤å¤–ï¼Œæ—¥ç¨‹è¡¨é‚£ä¸ªæ¨¡å—ï¼Œå› ä¸ºå®é™…ä¸Šè°ƒç”¨çš„æ˜¯è°·æ­Œæ—¥å†ï¼Œå›½å†…æ˜¾ç„¶æ²¡æ³•ç”¨ï¼Œæ‰€ä»¥ä¸å»ºè®®ä½¿ç”¨ã€‚</p>
</li>
<li><p>å»ºç«‹èœå•å¯¹åº”çš„é¡µé¢ï¼šè¿˜æ˜¯åœ¨blogæ–‡ä»¶å¤¹ä¸‹æ‰“å¼€å‘½ä»¤è¡Œï¼Œè¾“å…¥<code>hexo new page &quot;categories&quot;</code>ï¼Œç„¶ååœ¨~/blog/source æ–‡ä»¶å¤¹ä¸­å³å¯çœ‹åˆ°categoriesæ–‡ä»¶å¤¹ï¼Œæ‰“å¼€é‡Œé¢çš„index.mdæ–‡ä»¶ï¼Œè®¾ç½®å¦‚ä¸‹ï¼ˆæ³¨æ„ï¼šåé¢è¦åŠ ç©ºæ ¼ï¼‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">title: categories</span><br><span class="line">date: 2020-01-30 08:54:26</span><br><span class="line">type: &quot;categories&quot;</span><br></pre></td></tr></table></figure>

<p>tagsé¡µé¢ä¹Ÿæ˜¯ä¸€æ ·çš„æ–¹å¼æ¥å»ºç«‹ã€‚</p>
</li>
<li><p>ä¸»é¢˜é£æ ¼ï¼šä¸€å…±æœ‰å››ä¸ªé£æ ¼å¯ä»¥é€‰æ‹©ï¼Œæ‰“å¼€ä¸»é¢˜é…ç½®æ–‡ä»¶ æ‰¾åˆ°<code>Scheme Settings</code>ï¼ŒæŠŠæƒ³ç”¨çš„é£æ ¼å‰é¢çš„#å»æ‰ï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œç”¨äº†Mistã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Schemes</span></span><br><span class="line"><span class="comment"># scheme: Muse</span></span><br><span class="line">scheme: Mist</span><br><span class="line"><span class="comment"># scheme: Pisces</span></span><br><span class="line"><span class="comment"># scheme: Gemini</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¾§æ è®¾ç½®ï¼šä¾§æ è®¾ç½®åŒ…æ‹¬ï¼šä¾§æ ä½ç½®ã€ä¾§æ æ˜¾ç¤ºä¸å¦ã€æ–‡ç« é—´è·ã€è¿”å›é¡¶éƒ¨æŒ‰é’®ç­‰ç­‰ï¼Œæ‰“å¼€ä¸»é¢˜é…ç½®æ–‡ä»¶ æ‰¾åˆ°<code>sidebar</code>ï¼ŒæŒ‰è‡ªå·±çš„å–œå¥½é€‰æ‹©ï¼ŒæŠŠæƒ³è¦çš„é‚£ä¸€é¡¹çš„#å»æ‰æˆ–è€…falseæ”¹æˆtrueå³å¯ã€‚</p>
</li>
<li><p>å¤´åƒè®¾ç½®ï¼šä¸»é¢˜é…ç½®æ–‡ä»¶æ‰¾åˆ°<code>avatar</code>ï¼Œä¿®æ”¹avataråé¢çš„è·¯å¾„ä¸ºè‡ªå·±å¤´åƒçš„è·¯å¾„ï¼Œå¤´åƒæ–‡ä»¶è¦æ”¾åˆ°<code>themes/next/source/images</code>ä¸­ï¼Œæ¯”å¦‚å¤´åƒæ–‡ä»¶åä¸º<code>header.jpg</code>ï¼Œå°±æŠŠé‚£ä¸€è¡Œå†™æˆ<code>avatar: /images/header.jpg</code>ã€‚å¦‚æœå‰é¢æœ‰#å°±å»æ‰#ã€‚</p>
</li>
<li><p>æ·»åŠ æœç´¢ï¼š</p>
<ol>
<li><p>è¿˜æ˜¯blogæ–‡ä»¶å¤¹çš„å‘½ä»¤è¡Œé‡Œï¼Œè¾“å…¥<code>npm install hexo-generator-searchdb --save</code>ã€‚</p>
</li>
<li><p>æ‰“å¼€ç«™ç‚¹é…ç½®æ–‡ä»¶æ‰¾åˆ°<code>Extensions</code>åœ¨ä¸‹é¢æ·»åŠ </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æœç´¢</span></span><br><span class="line">search:</span><br><span class="line">  path: search.xml</span><br><span class="line">  field: post</span><br><span class="line">  format: html</span><br><span class="line">  <span class="built_in">limit</span>: 10000</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ‰“å¼€ä¸»é¢˜é…ç½®æ–‡ä»¶æ‰¾åˆ°<code>Local search</code>ï¼Œå°†<code>enable</code>è®¾ç½®ä¸º<code>true</code>ã€‚</p>
</li>
</ol>
</li>
<li><p>è¿˜æœ‰å¾ˆå¤šèƒ½é…ç½®çš„ï¼Œæ¯”å¦‚ä¾§è¾¹æ å¤´åƒä¸‹é¢æœ‰githubé“¾æ¥ï¼Œç‚¹å‡»é¡µé¢å‡ºç°çˆ±å¿ƒç¬¦å·ï¼Œåšå®¢èƒŒæ™¯åŠ¨æ€å˜åŒ–ç­‰ï¼Œå¯è‡ªè¡Œæœç´¢ã€‚</p>
</li>
</ol>
<h2 id="å¦‚ä½•å‘å¸ƒæ–°çš„åšå®¢"><a href="#å¦‚ä½•å‘å¸ƒæ–°çš„åšå®¢" class="headerlink" title="å¦‚ä½•å‘å¸ƒæ–°çš„åšå®¢"></a>å¦‚ä½•å‘å¸ƒæ–°çš„åšå®¢</h2><ol>
<li><p>åœ¨blogæ–‡ä»¶å¤¹çš„å‘½ä»¤è¡Œé‡Œè¾“å…¥<code>hexo new &quot;æ ‡é¢˜&quot;</code>ï¼Œç„¶åè¿›å…¥<strong>/blog/sources/_post/</strong>æ‰¾åˆ°å¯¹åº”çš„markdownæ–‡ä»¶å°±å¯ä»¥å¼€å§‹å†™äº†ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªmarkdownæ–‡ä»¶ï¼Œç„¶åæ·»åŠ å¯¹åº”çš„æ–‡ä»¶å¤´ã€‚å†™åšå®¢çš„æ—¶å€™æ ¹æ®éœ€æ±‚åœ¨æ–‡ä»¶å¤´é‡Œå¡«å†™tagså’Œcategoriesçš„ä¿¡æ¯ï¼Œç„¶åhexoä¼šè‡ªåŠ¨å»ºç«‹å¥½tagså’Œcategoriesçš„å†…å®¹å¹¶ç»™æ–‡ç« åˆ†ç±»ã€‚</p>
<p>æ–‡ä»¶å¤´ä¿¡æ¯å¦‚ä¸‹ç¼–å†™ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title:</span><br><span class="line">date:</span><br><span class="line">tags:</span><br><span class="line">categories:</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
</li>
<li><p>å†™å¥½ä»¥åä¿å­˜ï¼Œç„¶åè¿˜æ˜¯blogæ–‡ä»¶å¤¹çš„å‘½ä»¤è¡Œï¼Œè¾“å…¥<code>hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</code>ï¼Œå°±å‘å¸ƒæˆåŠŸäº†ã€‚</p>
</li>
<li><p>å¦‚æœä¸€ä¸ªæ–‡ç« æƒ³è®¾ç½®å¤šä¸ªæ ‡ç­¾ï¼Œé‚£ä¹ˆåœ¨ç¼–å†™æ–‡ä»¶å¤´ä¿¡æ¯çš„æ—¶å€™ï¼Œè¦æŒ‰ä¸‹é¢çš„æ–¹å¼å†™ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tagsï¼›</span><br><span class="line">	- tag1</span><br><span class="line">	- tag2</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œ<code>tags:</code> åé¢ä¸€å®šè¦æ¢è¡Œï¼Œä¸‹é¢çš„<code>-</code>åé¢æ³¨æ„æœ‰ç©ºæ ¼ã€‚</p>
</li>
</ol>
<h2 id="ä¸€äº›åç»­é—®é¢˜"><a href="#ä¸€äº›åç»­é—®é¢˜" class="headerlink" title="ä¸€äº›åç»­é—®é¢˜"></a>ä¸€äº›åç»­é—®é¢˜</h2><p>ä»Šå¤©ï¼ˆ2020.03.16ï¼‰çªç„¶å‘ç°å½“åšå®¢å†…å®¹å¤šèµ·æ¥ä»¥åï¼Œé¦–é¡µä¼šæœ‰ç¿»é¡µï¼Œè€Œç¿»é¡µå›¾æ ‡æ˜¾ç¤ºæ˜¯ä¹±çš„ï¼ŒæŸ¥äº†ä¸€ä¸‹å‘ç°è¦æ”¹<code>/Blog/themes/next/layout/_partials/pagination.swig</code>è¿™ä¸ªæ–‡ä»¶ï¼Œå†…å®¹æ•´ä½“æ›¿æ¢æˆä¸‹é¢çš„ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;%- if page.prev or page.next %&#125;</span><br><span class="line"> <span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"pagination"</span>&gt;</span></span><br><span class="line">   &#123;&#123;</span><br><span class="line">     paginator(&#123;</span><br><span class="line">       prev_text: '<span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-angle-left"</span> <span class="attr">aria-label</span>=<span class="string">"'+__('accessibility.prev_page')+'"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>',</span><br><span class="line">       next_text: '<span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-angle-right"</span> <span class="attr">aria-label</span>=<span class="string">"'+__('accessibility.next_page')+'"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>',</span><br><span class="line">       mid_size: 1,</span><br><span class="line">       escape: false</span><br><span class="line">     &#125;)</span><br><span class="line">   &#125;&#125;</span><br><span class="line"> <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line">&#123;%- endif %&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å‚è€ƒé“¾æ¥ï¼š"><a href="#å‚è€ƒé“¾æ¥ï¼š" class="headerlink" title="å‚è€ƒé“¾æ¥ï¼š"></a>å‚è€ƒé“¾æ¥ï¼š</h2><p><a href="https://segmentfault.com/a/1190000018761324" target="_blank" rel="noopener">https://segmentfault.com/a/1190000018761324</a></p>
<p><a href="https://www.jianshu.com/p/3a05351a37dc" target="_blank" rel="noopener">https://www.jianshu.com/p/3a05351a37dc</a></p>
<p><a href="https://blog.csdn.net/nightmare_dimple/article/details/86661502" target="_blank" rel="noopener">https://blog.csdn.net/nightmare_dimple/article/details/86661502</a></p>
<p><a href="https://blog.csdn.net/lihangll/article/details/103335246" target="_blank" rel="noopener">https://blog.csdn.net/lihangll/article/details/103335246</a></p>
]]></content>
      <categories>
        <category>åšå®¢é…ç½®</category>
      </categories>
      <tags>
        <tag>æ•™ç¨‹</tag>
      </tags>
  </entry>
</search>
